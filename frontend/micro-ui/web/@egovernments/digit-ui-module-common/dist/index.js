function e(e){return e&&"object"==typeof e&&"default"in e?e.default:e}var t=require("@egovernments/digit-ui-react-components"),n=require("react"),l=e(n),a=require("react-i18next"),o=require("react-router-dom"),i=require("react-hook-form"),r=e(require("jquery")),s=require("react-query"),u=require("@egovernments/digit-ui-libraries");function c(){return(c=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var l in n)Object.prototype.hasOwnProperty.call(n,l)&&(e[l]=n[l])}return e}).apply(this,arguments)}const d=function(e,t,n){if(void 0===e&&(e=""),void 0===t&&(t=""),void 0===n&&(n=""),""==t)return e;for(;e.includes(t);)e=e.replace(t,n);return e},m=e=>{var r,s,u,c,m,E,v,p;const _={code:"PAY_BY_OWNER",i18nKey:"PT_PAY_BY_OWNER",name:"I am making the payment as the owner/ consumer of the service"},f={code:"PAY_BEHALF_OWNER",i18nKey:"PT_PAY_BEHALF_OWNER",name:"I am making the payment on behalf of the owner/ consumer of the service"},y=null===(r=Digit.UserService.getUser())||void 0===r?void 0:r.info,S=null==y?void 0:y.name,b=null==y?void 0:y.mobileNumber,{t:N}=a.useTranslation(),g=o.useHistory(),{state:h,...C}=o.useLocation(),{consumerCode:A,businessService:P,paymentAmt:T}=o.useParams(),{workflow:D,tenantId:O,ConsumerName:M}=Digit.Hooks.useQueryParams(),[L,I]=n.useState(null==h?void 0:h.bill),w=(null==h?void 0:h.tenantId)||O||(null===(s=Digit.UserService.getUser().info)||void 0===s?void 0:s.tenantId),R=Digit.UserService.getUser(),{data:k,isLoading:B}=null!=h&&h.bill?{isLoading:!1}:Digit.Hooks.useFetchPayment({tenantId:w,businessService:P,consumerCode:A});let x=(null==k||null===(u=k.Bill)||void 0===u||null===(c=u[0])||void 0===c?void 0:c.userId)||"",F=["/user/_search",{},{data:{uuid:[x]}},{recordId:x,plainRequestFields:["mobileNumber"]},{enabled:!!x,cacheTime:100}];const{isLoading:U,data:Y}=Digit.Hooks.useCustomAPIHook(...F),H=(null==L||null===(m=L.billDetails)||void 0===m||null===(E=m.sort((e,t)=>t.fromPeriod-e.fromPeriod))||void 0===E?void 0:E[0])||[],[j,W]=(null==L||null===(v=L.billDetails)||void 0===v||null===(p=v.sort((e,t)=>t.fromPeriod-e.fromPeriod))||void 0===p||p.reduce((e,t,n)=>0===n?e:e+t.amount,0),n.useState(_)),[V,z]=n.useState(""),[G,q]=n.useState(""),{handleSubmit:K}=i.useForm(),[Q,X]=n.useState(!1),[Z,$]=n.useState(null),[J,ee]=n.useState(!1),[te,ne]=n.useState(!1),[le,ae]=n.useState(""),{isLoading:oe,data:ie}=Digit.Hooks.useCustomMDMS(Digit.ULBService.getStateId(),"common-masters",[{name:"CitizenConsentForm"}]);function re(e){ee(e.target.checked)}return n.useEffect(()=>{var e,t,n,l,a;null!=ie&&null!==(e=ie["common-masters"])&&void 0!==e&&null!==(t=e.CitizenConsentForm)&&void 0!==t&&null!==(n=t[0])&&void 0!==n&&n.isCitizenConsentFormEnabled&&ne(null==ie||null===(l=ie["common-masters"])||void 0===l||null===(a=l.CitizenConsentForm)||void 0===a?void 0:a[0])},[ie]),n.useEffect(()=>{if(!L&&k){var e;let t=null==k||null===(e=k.Bill)||void 0===e?void 0:e.filter(e=>e.consumerCode==A)[0];I(t)}},[B]),B||U||oe?l.createElement(t.Loader,null):l.createElement(l.Fragment,null,l.createElement(t.BackButton,null,N("CS_COMMON_BACK")),l.createElement("form",{onSubmit:K(()=>{var e,t,n,l,a,o;"WNS"===D?g.push("/digit-ui/citizen/payment/collect/"+P+"/"+A+"?workflow=WNS&consumerCode="+d(A,"+","/"),{paymentAmount:T,tenantId:H.tenantId,name:(null==j?void 0:j.code)!==(null==f?void 0:f.code)&&"undefined"!==M?M:y?S:V,mobileNumber:(null==j?void 0:j.code)!==(null==f?void 0:f.code)?null!=L&&null!==(e=L.mobileNumber)&&void 0!==e&&e.includes("*")?null==Y||null===(t=Y.user)||void 0===t||null===(n=t[0])||void 0===n?void 0:n.mobileNumber:null==L?void 0:L.mobileNumber:y?b:G}):g.push("/digit-ui/citizen/payment/collect/"+P+"/"+A,{paymentAmount:T,tenantId:H.tenantId,name:(null==j?void 0:j.code)!==(null==f?void 0:f.code)?null==L?void 0:L.payerName:y?S:V,mobileNumber:(null==j?void 0:j.code)!==(null==f?void 0:f.code)?null!=L&&null!==(l=L.mobileNumber)&&void 0!==l&&l.includes("*")?null==Y||null===(a=Y.user)||void 0===a||null===(o=a[0])||void 0===o?void 0:o.mobileNumber:null==L?void 0:L.mobileNumber:y?b:G})})},l.createElement(t.Header,null,N("PT_PAYERS_DETAILS_HEADER")),l.createElement(t.Card,null,l.createElement("span",{className:"card-label-error"},N(Z)),l.createElement(t.RadioButtons,{selectedOption:j,onSelect:W,options:[_,f],optionsKey:"name",inputStyle:{marginTop:"11px"},innerStyles:{display:"flex"}}),l.createElement("div",{style:{position:"relative"}},(null==j?void 0:j.code)===(null==_?void 0:_.code)||y?null:l.createElement("div",{style:{position:"relative"}},l.createElement("span",null,l.createElement("span",null,N("PT_PAYERS_MOBILE_NO")),l.createElement(t.MobileNumber,{onChange:e=>{$(null),e.match("^\\d{10}$")||($("CORE_COMMON_PHONENO_INVALIDMSG"),X(!1)),q(e),X(10==e.length&&""!=V)},value:G})),l.createElement("span",null,l.createElement("span",null,N("PT_PAYERS_NAME")),l.createElement(t.TextInput,{onChange:e=>{return z(t=e.target.value),void X(0!==t.length&&"CORE_COMMON_PHONENO_INVALIDMSG"!=Z&&""!=V&&""!=G);var t},value:V})))),(null==te?void 0:te.isCitizenConsentFormEnabled)&&!(null!=R&&R.access_token)&&l.createElement("div",null,l.createElement(t.CheckBox,{className:"form-field",label:l.createElement("span",null,null==te||null===(se=te.checkBoxLabels)||void 0===se?void 0:se.map((e,t)=>{var n;return l.createElement("span",null,(null==e?void 0:e.linkPrefix)&&l.createElement("span",null,N((null==e?void 0:e.linkPrefix)+"_")),(null==e?void 0:e.link)&&l.createElement("span",{id:null==e?void 0:e.linkId,onClick:e=>{(e=>{ae(e.target.id)})(e)},style:{color:"#a82227",cursor:"pointer"}},N((null==e?void 0:e.link)+"_")),(null==e?void 0:e.linkPostfix)&&l.createElement("span",null,N((null==e?void 0:e.linkPostfix)+"_")),t==(null==te||null===(n=te.checkBoxLabels)||void 0===n?void 0:n.length)-1&&N("LABEL"))})),value:J,checked:J,style:{marginTop:"5px",marginLeft:"55px"},styles:{marginBottom:"30px"},onChange:re}),l.createElement(t.CitizenConsentForm,{styles:{},t:N,isCheckBoxChecked:re,labels:null==te?void 0:te.checkBoxLabels,mdmsConfig:le,setMdmsConfig:ae})),l.createElement(t.SubmitBar,{label:N("CS_COMMON_NEXT"),disabled:(()=>{if(null==te||!te.isCitizenConsentFormEnabled||null!=R&&R.access_token)return(null==j?void 0:j.code)===(null==f?void 0:f.code)&&!y&&!Q;{let e=!1;return e=!(((null==j?void 0:j.code)!==(null==f?void 0:f.code)||y||Q)&&J),e}})(),submit:!0}))));var se},E=e=>{var n;let{bill:i,currentPath:r,businessService:s,getKeyNotesConfig:u}=e;const{t:c}=a.useTranslation(),d=o.useHistory();return l.createElement(l.Fragment,null,"function"==typeof u&&l.createElement(t.Card,null,u(s,c)["my-bill"].map((e,n)=>{const a=e.keyPath.reduce((e,t)=>"function"==typeof t?t(e):e[t],i);return l.createElement(t.KeyNote,{key:n+e.keyValue,keyValue:c(e.keyValue),note:a||e.fallback,noteStyle:e.noteStyle||{}})}),l.createElement(t.SubmitBar,{disabled:!(null!==(n=i.totalAmount)&&void 0!==n&&n.toFixed(2)),onSubmit:()=>{d.push(r+"/"+i.consumerCode,{tenantId:null==i?void 0:i.tenantId})},label:c("CS_MY_APPLICATION_VIEW_DETAILS")})))},v=e=>{let{billsList:i,currentPath:r,businessService:s}=e;const{t:u}=a.useTranslation(),c=(o.useHistory(),i.map(e=>e.consumerCode)),d=Digit.Hooks.useApplicationsForBusinessServiceSearch({filters:{consumerCodes:c.join()},businessService:s}),m=d.key,[v,p]=n.useState([]),[_,f]=n.useState(()=>{var e;return null===(e=Digit.ComponentRegistryService)||void 0===e?void 0:e.getComponent("getBillDetailsConfigWithBusinessService")}),y=n.useMemo(()=>({}),[]),S=n.useMemo(()=>({}),[]);return n.useEffect(()=>{d.data&&d.refetch()},[]),n.useEffect(()=>{if(d.data){const e=d.data.filter(e=>c.includes(e[m])),t=e.map(e=>e[m]);e.forEach(e=>{y[e[m]]=e}),i.forEach(e=>{S[e.consumerCode]=e});const n=t.map(e=>({...S[e],...y[e]}));p(n)}},[d.data,_]),d.isLoading?l.createElement(t.Loader,null):l.createElement(l.Fragment,null,l.createElement("div",{className:"static"},l.createElement(t.Header,null,u("CS_TITLE_MY_BILLS")+" ("+v.length+")"),(null==v?void 0:v.length)>0&&_&&v.map((e,t)=>l.createElement("div",{key:t},l.createElement(E,{bill:e,currentPath:r,businessService:s,getKeyNotesConfig:_}))),!(null!=v&&v.length)>0&&l.createElement("p",{style:{paddingLeft:"16px"}},u("CS_BILLS_TEXT_NO_BILLS_FOUND")),"PT"===s&&l.createElement("p",{style:{paddingLeft:"16px",paddingTop:"16px"}},u("PT_TEXT_NOT_ABLE_TO_FIND_THE_PROPERTY"),l.createElement("span",{className:"link"},l.createElement(o.Link,{to:"/digit-ui/citizen/pt/property/citizen-search"},u("PT_COMMON_CLICK_HERE"))))))},p={root:{width:"100%",marginTop:"2px",overflowX:"auto",boxShadow:"none"},table:{minWidth:700,backgroundColor:"rgba(250, 250, 250, var(--bg-opacity))"},cell:{maxWidth:"7em",minWidth:"1em",border:"1px solid #e8e7e6",padding:"4px 5px",fontSize:"0.8em",textAlign:"left",lineHeight:"1.5em"},cellHeader:{overflow:"hidden",textOverflow:"ellipsis"},cellLeft:{},cellRight:{}},_=e=>{let{className:t="table",headers:n=[],values:o=[],arrears:i=0}=e;const{t:r}=a.useTranslation();return l.createElement(l.Fragment,null,l.createElement("div",{style:p.root},l.createElement("table",{className:"table-fixed-column-common-pay",style:p.table},l.createElement("thead",null,l.createElement("tr",null,l.createElement("th",{style:{...p.cell,...p.cellLeft,...p.cellHeader}},r("CS_BILL_PERIOD")),n.map((e,t)=>l.createElement("th",{style:{...p.cell,...n.length==t+1?p.cellRight:{},...p.cellHeader},key:t},r(e))))),l.createElement("tbody",null,Object.values(o).map((e,t)=>l.createElement("tr",{key:t},l.createElement("td",{style:{...p.cell,...p.cellLeft},component:"th",scope:"row"},Object.keys(o)[t]),n.map((t,a)=>l.createElement("td",{style:{...p.cell,textAlign:"left",...n.length==a+1?p.cellRight:{},whiteSpace:"pre"},key:a,numeric:!0},a>1&&"â‚¹",e[t]&&e[t].value||"0")))),l.createElement("tr",null,l.createElement("td",{style:{...p.cell,...p.cellLeft}}),n.map((e,t)=>t==n.length-1?l.createElement("td",{style:{...p.cell,...p.cellRight,textAlign:"left",fontWeight:"700",whiteSpace:"pre"},key:t,numeric:!0},i):t==n.length-2?l.createElement("td",{style:{...p.cell,textAlign:"left"},key:t,numeric:!0},r("COMMON_ARREARS_TOTAL")):l.createElement("td",{style:p.cell,key:t,numeric:!0})))))))},f={buttonStyle:{display:"flex",justifyContent:"flex-end",color:"#a82227"},headerStyle:{marginTop:"10px",fontSize:"16px",fontWeight:"700",lineHeight:"24px",color:" rgba(11, 12, 12, var(--text-opacity))"}},y=e=>{var t,o,i;let{bill:r={}}=e;const{t:s}=a.useTranslation();let u={},c=(null==r||null===(t=r.billDetails)||void 0===t?void 0:t.sort((e,t)=>t.fromPeriod-e.fromPeriod))||[];c=[...c];const d=(null===(o=c)||void 0===o?void 0:o.reduce((e,t,n)=>0===n?e:e+t.amount,0))||0;let m="â‚¹ "+((null==d||null===(i=d.toFixed)||void 0===i?void 0:i.call(d,0))||Number(0).toFixed(0));c.shift(),c.map(e=>{let t=function(e){var t,n,l;void 0===e&&(e={});let a={};const{billAccountDetails:o=[]}=e;return o.map(e=>{a[e.taxHeadCode]={value:e.amount,order:e.order}}),a.CS_BILL_NO={value:(null===(t=e)||void 0===t?void 0:t.billNumber)||"NA",order:-2},a.CS_BILL_DUEDATE={value:(null===(n=e)||void 0===n?void 0:n.expiryDate)&&new Date(null===(l=e)||void 0===l?void 0:l.expiryDate).toLocaleDateString()||"NA",order:-1},a.TL_COMMON_TOTAL_AMT={value:e.amount,order:10},a}(e);u[((e,t)=>{const n=new Date(e),l=new Date(t);return l.getYear()-n.getYear()!=0?"FY"+(n.getYear()+1900)+"-"+(l.getYear()-100):n.toLocaleDateString()+"-"+l.toLocaleDateString()})(e.fromPeriod,e.toPeriod)]=t});let E={};!u||Object.keys(u).map((e,t)=>{Object.keys(u[e]).map(t=>{E[t]=u[e]&&u[e][t]&&u[e][t].order||0})});let v=[];v=Object.keys(E),v.sort((e,t)=>E[e]-E[t]);const[p,y]=n.useState(!1);return 0==d||d<0?l.createElement("span",null):l.createElement(l.Fragment,null,l.createElement("div",{style:f.headerStyle},s("CS_ARREARS_DETAILS")),p&&l.createElement(_,{headers:[...v],values:u,arrears:m}),!p&&l.createElement("div",{style:f.buttonStyle},l.createElement("button",{type:"button",onClick:()=>{y(!0)}},s("CS_SHOW_CARD"))),p&&l.createElement("div",{style:f.buttonStyle},l.createElement("button",{type:"button",onClick:()=>{y(!1)}},s("CS_HIDE_CARD"))))},S=e=>{var t;let{billAccountDetails:o,total:i,arrears:r}=e;const{t:s}=a.useTranslation(),{workflow:u}=Digit.Hooks.useQueryParams();return n.useEffect(()=>{"mcollect"===u&&o&&o.map(e=>{e.taxHeadCode.includes("CGST")?e.order=3:e.taxHeadCode.includes("SGST")&&(e.order=4)})},[o]),l.createElement(l.Fragment,null,l.createElement("div",{className:"bill-summary"},o.sort((e,t)=>e.order-t.order).map((e,t)=>{var n;return l.createElement("div",{key:t,className:"bill-account-details"},l.createElement("div",{className:"label"},s(e.taxHeadCode)),l.createElement("div",{className:"value"},"â‚¹ ",Math.abs(null==e||null===(n=e.amount)||void 0===n?void 0:n.toFixed(2))))}),l.createElement("div",{className:"bill-account-details"},l.createElement("div",{className:"label"},s("COMMON_ARREARS")),l.createElement("div",{className:"value"},"â‚¹ ",Math.abs((null==r||null===(t=r.toFixed)||void 0===t?void 0:t.call(r,2))||Number(0).toFixed(2)))),l.createElement("hr",{className:"underline"}),l.createElement("div",{className:"amount-details"},l.createElement("div",{className:"label"},s("CS_PAYMENT_TOTAL_AMOUNT")),l.createElement("div",{className:"value"},"â‚¹ ",Number(i).toFixed(2)))))},b=e=>{var i,r,s,u,c,m,E;let{paymentRules:v,businessService:p}=e;const{t:_}=a.useTranslation(),f=o.useHistory(),{state:b,...N}=o.useLocation();let{consumerCode:g}=o.useParams();const{workflow:h,tenantId:C,ConsumerName:A}=Digit.Hooks.useQueryParams(),[P,T]=n.useState(null==b?void 0:b.bill),D=(null==b?void 0:b.tenantId)||C||(null===(i=Digit.UserService.getUser().info)||void 0===i?void 0:i.tenantId),O=null==b?void 0:b.propertyId;"WNS"===h&&g.includes("?")&&(g=g.substring(0,g.indexOf("?")));const{data:M,isLoading:L}=null!=b&&b.bill?{isLoading:!1}:Digit.Hooks.useFetchPayment({tenantId:D,businessService:p,consumerCode:"WNS"===h?d(g,"+","/"):g});let I=(null==M||null===(r=M.Bill)||void 0===r||null===(s=r[0])||void 0===s?void 0:s.userId)||"",w=["/user/_search",{},{data:{uuid:[I]}},{recordId:I,plainRequestFields:["mobileNumber"]},{enabled:!!I,cacheTime:100}];const{data:R}=Digit.Hooks.useCustomAPIHook(...w);let{minAmountPayable:k,isAdvanceAllowed:B}=v;k="WNS"===h?100:k;const x=(null==P||null===(u=P.billDetails)||void 0===u||null===(c=u.sort((e,t)=>t.fromPeriod-e.fromPeriod))||void 0===c?void 0:c[0])||[],F=(null==P||null===(m=P.billDetails)||void 0===m||null===(E=m.sort((e,t)=>t.fromPeriod-e.fromPeriod))||void 0===E?void 0:E.reduce((e,t,n)=>0===n?e:e+t.amount,0))||0,{label:U}=Digit.Hooks.useApplicationsForBusinessServiceSearch({businessService:p},{enabled:!1}),Y=()=>(null==P?void 0:P.totalAmount)||0,[H,j]=n.useState(_("CS_PAYMENT_FULL_AMOUNT")),[W,V]=n.useState(Y()),[z,G]=n.useState(!0),[q,K]=n.useState("");return n.useEffect(()=>{window.scroll({top:0,behavior:"smooth"})},[]),n.useEffect(()=>{H==_("CS_PAYMENT_FULL_AMOUNT")&&V(Y())},[H,P]),n.useEffect(()=>{let e=B;B&&"WNS"===h&&(e=!1);const t=k&&W>=k&&!e&&W<=Y()&&!q;H!=_("CS_PAYMENT_FULL_AMOUNT")?G(t):G(!0)},[H,W]),n.useEffect(()=>{if(!P&&M){let e=M.Bill.filter(e=>e.consumerCode==("WNS"===h?d(g,"+","/"):g))[0];T(e)}},[L]),L?l.createElement(t.Loader,null):l.createElement(l.Fragment,null,l.createElement(t.Header,null,_("CS_PAYMENT_BILL_DETAILS")),l.createElement(t.Card,null,l.createElement("div",null,l.createElement(t.KeyNote,{keyValue:_("PT.MUTATION"==p?"PDF_STATIC_LABEL_MUATATION_NUMBER_LABEL":U),note:"WNS"===h?d(g,"+","/"):g}),"PT.MUTATION"!==p&&l.createElement(t.KeyNote,{keyValue:_("CS_PAYMENT_BILLING_PERIOD"),note:(()=>{const{fromPeriod:e,toPeriod:t}=x;if(e&&t){let o,i;var n,l,a;return"mcollect"===h||"WNS"===h?(o=new Date(e).getDate().toString()+" "+(null===(n=Digit.Utils.date.monthNames[new Date(e).getMonth()])||void 0===n?void 0:n.toString())+" "+new Date(e).getFullYear().toString(),i=new Date(t).getDate()+" "+Digit.Utils.date.monthNames[new Date(t).getMonth()]+" "+new Date(t).getFullYear(),o+" - "+i):(o=new Date(x.fromPeriod).getFullYear().toString(),i=new Date(x.toPeriod).getFullYear().toString(),o===i?window.location.href.includes("BPA")?new Date(null==M||null===(l=M.Bill)||void 0===l||null===(a=l[0])||void 0===a?void 0:a.billDate).getMonth()+1<4?"FY "+(parseInt(o)-1).toString()+"-"+i:"FY "+o+"-"+(parseInt(i)+1).toString():"FY "+o:"FY "+o+"-"+i)}return"N/A"})()}),(null==p?void 0:p.includes("PT"))||"WNS"===h&&(null==x?void 0:x.currentBillNo)&&l.createElement(t.KeyNote,{keyValue:_("CS_BILL_NO"),note:null==x?void 0:x.currentBillNo}),(null==p?void 0:p.includes("PT"))||"WNS"===h&&(null==x?void 0:x.currentExpiryDate)&&l.createElement(t.KeyNote,{keyValue:_("CS_BILL_DUEDATE"),note:new Date(null==x?void 0:x.currentExpiryDate).toLocaleDateString()}),l.createElement(S,{billAccountDetails:(null==x?void 0:x.billAccountDetails)||[],total:Y(),businessService:p,arrears:F}),l.createElement(y,{bill:P})),l.createElement("div",{className:"bill-payment-amount"},l.createElement("hr",{className:"underline"}),l.createElement(t.CardSubHeader,null,_("CS_COMMON_PAYMENT_AMOUNT")),l.createElement(t.RadioButtons,{selectedOption:H,onSelect:j,options:v.partPaymentAllowed?[_("CS_PAYMENT_FULL_AMOUNT"),_("CS_PAYMENT_CUSTOM_AMOUNT")]:[_("CS_PAYMENT_FULL_AMOUNT")]}),l.createElement("div",{style:{position:"relative"}},l.createElement("span",{className:"payment-amount-front",style:{border:"1px solid "+(H===_("CS_PAYMENT_FULL_AMOUNT")?"#9a9a9a":"black")}},"â‚¹"),H!==_("CS_PAYMENT_FULL_AMOUNT")?l.createElement(t.TextInput,{className:"text-indent-xl",onChange:e=>{return t=e.target.value,K(""),isNaN(t)||t.includes(".")?K("AMOUNT_INVALID"):!B&&t>Y()?K("CS_ADVANCED_PAYMENT_NOT_ALLOWED"):t<k&&K("CS_CANT_PAY_BELOW_MIN_AMOUNT"),void V(t);var t},value:W,disable:0===Y()}):l.createElement(t.TextInput,{className:"text-indent-xl",value:Y(),onChange:()=>{},disable:!0}),"CS_CANT_PAY_BELOW_MIN_AMOUNT"===q?l.createElement("span",{className:"card-label-error"},_(q),": ","â‚¹"+k):l.createElement("span",{className:"card-label-error"},_(q))),l.createElement(t.SubmitBar,{disabled:!z||0==Y(),onSubmit:()=>{let e=H===_("CS_PAYMENT_FULL_AMOUNT")?Y():W;if(window.location.href.includes("mcollect"))f.push("/digit-ui/citizen/payment/collect/"+p+"/"+g+"?workflow=mcollect",{paymentAmount:e,tenantId:x.tenantId});else if("WNS"===h){var t,n,l;f.push("/digit-ui/citizen/payment/billDetails/"+p+"/"+g+"/"+e+"?workflow=WNS&ConsumerName="+A,{paymentAmount:e,tenantId:x.tenantId,name:P.payerName,mobileNumber:P.mobileNumber&&null!==(t=P.mobileNumber)&&void 0!==t&&t.includes("*")?null==R||null===(n=R.user)||void 0===n||null===(l=n[0])||void 0===l?void 0:l.mobileNumber:P.mobileNumber})}else if("PT"===p){var a,o,i;f.push("/digit-ui/citizen/payment/billDetails/"+p+"/"+g+"/"+e,{paymentAmount:e,tenantId:x.tenantId,name:P.payerName,mobileNumber:P.mobileNumber&&null!==(a=P.mobileNumber)&&void 0!==a&&a.includes("*")?null==R||null===(o=R.user)||void 0===o||null===(i=o[0])||void 0===i?void 0:i.mobileNumber:P.mobileNumber})}else f.push("/digit-ui/citizen/payment/collect/"+p+"/"+g,{paymentAmount:e,tenantId:x.tenantId,propertyId:O})},label:_("CS_COMMON_PROCEED_TO_PAY")}))))},N=e=>{let{billsList:n,paymentRules:a,businessService:i}=e;const{url:r,...s}=o.useRouteMatch();return l.createElement(l.Fragment,null,l.createElement(t.BackButton,null),l.createElement(o.Switch,null,l.createElement(o.Route,{exact:!0,path:""+r,component:()=>l.createElement(v,{billsList:n,currentPath:r,paymentRules:a,businessService:i})}),l.createElement(o.Route,{path:r+"/:consumerCode",component:()=>l.createElement(b,{paymentRules:a,businessService:i})})))},g=e=>{var n,a,i;let{stateCode:r}=e;const{businessService:s}=o.useParams(),{tenantId:u,isDisoconnectFlow:c}=Digit.Hooks.useQueryParams(),d=(Digit.Services.useStore({stateCode:r,moduleCode:s,language:Digit.StoreData.getCurrentLanguage()}),o.useHistory()),{url:m}=o.useRouteMatch(),E=o.useLocation(),{tenantId:v}=(null===(n=Digit.UserService.getUser())||void 0===n?void 0:n.info)||(null==E?void 0:E.state)||{tenantId:u}||{};v||null!=E&&null!==(a=E.state)&&void 0!==a&&a.fromSearchResults||d.replace("/digit-ui/citizen/login",{from:m});const{data:p}=Digit.Hooks.useFetchCitizenBillsForBuissnessService({businessService:s},{refetchOnMount:!0,enabled:!(null!=E&&null!==(i=E.state)&&void 0!==i&&i.fromSearchResults)}),{isLoading:_,data:f}=Digit.Hooks.useGetPaymentRulesForBusinessServices(v),y=(null==p?void 0:p.Bill)||[];return _?l.createElement(t.Loader,null):l.createElement(l.Fragment,null,l.createElement(N,{billsList:y,paymentRules:(()=>{var e,t,n;const l=null==f||null===(e=f.MdmsRes)||void 0===e||null===(t=e.BillingService)||void 0===t?void 0:t.BusinessService;let a="WS"!==s&&"SW"!==s||"true"!==c?s:"DISCONNECT";return null!=l&&l.length?(null===(n=l.filter(e=>e.code==a))||void 0===n?void 0:n[0])||{isAdvanceAllowed:!1,isVoucherCreationEnabled:!0,minAmountPayable:100,partPaymentAllowed:!1}:{}})(),businessService:s}))};function h(e,t){try{var n=e()}catch(e){return t(e)}return n&&n.then?n.then(void 0,t):n}"undefined"!=typeof Symbol&&(Symbol.iterator||(Symbol.iterator=Symbol("Symbol.iterator"))),"undefined"!=typeof Symbol&&(Symbol.asyncIterator||(Symbol.asyncIterator=Symbol("Symbol.asyncIterator")));const C=e=>{const{state:s={}}=o.useLocation(),u=Digit.UserService.getUser(),[c,m]=n.useState(null),{tenantId:E,authorization:v,workflow:p,consumerCode:_}=Digit.Hooks.useQueryParams(),f=null==s?void 0:s.paymentAmount,{t:y}=a.useTranslation(),{pathname:S,search:b}=(o.useHistory(),o.useLocation());let{consumerCode:N,businessService:g}=o.useParams();const C=(null==s?void 0:s.tenantId)||E||Digit.ULBService.getCurrentTenantId(),A=null==s?void 0:s.propertyId,P=Digit.ULBService.getStateId(),{control:T,handleSubmit:D}=i.useForm(),{data:O,isLoading:M}=Digit.Hooks.useCommonMDMS(P,"DIGIT-UI","PaymentGateway"),{data:L,isLoading:I}=Digit.Hooks.useFetchPayment({tenantId:C,consumerCode:"WNS"===p?_:N,businessService:g},{});(window.location.href.includes("ISWSCON")||"WNS"===p)&&(N=decodeURIComponent(N)),"WNS"===p&&(N=d(N,"+","/")),n.useEffect(()=>{null!=L&&L.Bill&&0==L.Bill.length&&m({key:!0,label:"CS_BILL_NOT_FOUND"})},[L]),n.useEffect(()=>{localStorage.setItem("BillPaymentEnabled","true")},[]);const{name:w,mobileNumber:R}=s,k=null!=L&&L.Bill?null==L?void 0:L.Bill[0]:{};return"true"!==v||u.access_token||(localStorage.clear(),sessionStorage.clear(),window.location.href="/digit-ui/citizen/login?from="+encodeURIComponent(S+b)),M||I?l.createElement(t.Loader,null):l.createElement(l.Fragment,null,l.createElement(t.BackButton,null,y("CS_COMMON_BACK")),l.createElement("form",{onSubmit:D(function(e){try{var t,n;const l={Transaction:{tenantId:null==k?void 0:k.tenantId,txnAmount:f||k.totalAmount,module:g,billId:k.id,consumerCode:N,productInfo:"Common Payment",gateway:(null==e?void 0:e.paymentType)||"AXIS",taxAndPayments:[{billId:k.id,amountPaid:f||k.totalAmount}],user:{name:w||(null==u||null===(t=u.info)||void 0===t?void 0:t.name)||(null==k?void 0:k.payerName),mobileNumber:R||(null==u||null===(n=u.info)||void 0===n?void 0:n.mobileNumber)||(null==k?void 0:k.mobileNumber),tenantId:null==k?void 0:k.tenantId},callbackUrl:window.location.href.includes("mcollect")||"WNS"===p?window.location.protocol+"//"+window.location.host+"/digit-ui/citizen/payment/success/"+g+"/"+("WNS"===p?encodeURIComponent(N):N)+"/"+C+"?workflow="+("WNS"===p?p:"mcollect"):window.location.protocol+"//"+window.location.host+"/digit-ui/citizen/payment/success/"+g+"/"+("WNS"===p?encodeURIComponent(N):N)+"/"+C+"?propertyId="+A,additionalDetails:{isWhatsapp:!1}}},a=h(function(){return Promise.resolve(Digit.PaymentService.createCitizenReciept(null==k?void 0:k.tenantId,l)).then(function(t){var n;const l=null==t||null===(n=t.Transaction)||void 0===n?void 0:n.redirectUrl;if("AXIS"==(null==e?void 0:e.paymentType))window.location=l;else try{var a,o,i,s,u,c,d,m,E,v,p;const e=null==l||null===(a=l.split("?"))||void 0===a||null===(o=a.slice(1))||void 0===o||null===(i=o.join("?"))||void 0===i||null===(s=i.split("&"))||void 0===s?void 0:s.reduce((e,t)=>{var n=t.split("=");return e[n[0]]=n[1],e},{});var _=r("<form>",{action:e.txURL,method:"POST",target:"_top"});const t=["checksum","messageType","merchantId","serviceId","orderId","customerId","transactionAmount","currencyCode","requestDateTime","successUrl","failUrl","additionalField1","additionalField2","additionalField3","additionalField4","additionalField5"];for(var f of(e.requestDateTime=null===(u=e.requestDateTime)||void 0===u?void 0:u.split((new Date).getFullYear()).join((new Date).getFullYear()+" "),e.successUrl=(null==l||null===(c=l.split("successUrl="))||void 0===c||null===(d=c[1])||void 0===d||null===(m=d.split("eg_pg_txnid="))||void 0===m?void 0:m[0])+"eg_pg_txnid="+(null==e?void 0:e.orderId),e.failUrl=(null==l||null===(E=l.split("failUrl="))||void 0===E||null===(v=E[1])||void 0===v||null===(p=v.split("eg_pg_txnid="))||void 0===p?void 0:p[0])+"eg_pg_txnid="+(null==e?void 0:e.orderId),t))_.append(r("<input>",{name:f,value:e[f]}));r(document.body).append(_),_.submit()}catch(e){console.log("Error in payment redirect ",e)}window.location=l})},function(e){var t,n,l;let a="CS_PAYMENT_UNKNOWN_ERROR_ON_SERVER";if(null!==(t=e.response)&&void 0!==t&&null!==(n=t.data)&&void 0!==n&&null!==(l=n.Errors)&&void 0!==l&&l[0]){var o,i,r;const{code:t}=null===(o=e.response)||void 0===o||null===(i=o.data)||void 0===i||null===(r=i.Errors)||void 0===r?void 0:r[0];a=t}m({key:!0,label:y(a)})});return Promise.resolve(a&&a.then?a.then(function(){}):void 0)}catch(e){return Promise.reject(e)}})},l.createElement(t.Header,null,y("PAYMENT_CS_HEADER")),l.createElement(t.Card,null,l.createElement("div",{className:"payment-amount-info",style:{marginBottom:"26px"}},l.createElement(t.CardLabel,{className:"dark"},y("PAYMENT_CS_TOTAL_AMOUNT_DUE")),l.createElement(t.CardSectionHeader,null," â‚¹ ",void 0!==f?Number(f).toFixed(2):Number(null==k?void 0:k.totalAmount).toFixed(2))),l.createElement(t.CardLabel,null,y("PAYMENT_CS_SELECT_METHOD")),(null==O?void 0:O.length)&&l.createElement(i.Controller,{name:"paymentType",defaultValue:O[0],control:T,render:e=>l.createElement(t.RadioButtons,{selectedOption:e.value,options:O,onSelect:e.onChange})}),!c&&l.createElement(t.SubmitBar,{label:y("PAYMENT_CS_BUTTON_LABEL"),submit:!0}))),l.createElement(t.InfoBanner,{label:y("CS_COMMON_INFO"),text:y("CS_PAYMENT_REDIRECT_NOTICE")}),c&&l.createElement(t.Toast,{error:c.key,label:y(c.label),onClose:()=>{m(null)}}))},A=e=>"true"!==localStorage.getItem("BillPaymentEnabled")?(window.history.forward(),null):l.createElement(P,e),P=e=>{var i,r,u,c,d,m,E,v,p,_,f,y,S,b,N,g,h,C,A,P,T,D,O,M,L,I,w,R;const{t:k}=a.useTranslation(),B=s.useQueryClient(),{eg_pg_txnid:x,workflow:F}=Digit.Hooks.useQueryParams(),[U,Y]=n.useState(!1),[H,j]=n.useState(!1),{businessService:W,consumerCode:V,tenantId:z}=o.useParams(),{data:G={},isLoading:q}=Digit.Hooks.obps.useOBPSSearch("",{},z,{applicationNo:V},{},{enabled:window.location.href.includes("bpa")||window.location.href.includes("BPA")}),{isLoading:K,data:Q,isError:X}=Digit.Hooks.usePaymentUpdate({egId:x},W,{retry:!1,staleTime:Infinity,refetchOnWindowFocus:!1}),{label:Z}=Digit.Hooks.useApplicationsForBusinessServiceSearch({businessService:W},{enabled:!1}),{data:$,isLoading:J}=Digit.Hooks.useRecieptSearch({tenantId:z,businessService:W,receiptNumbers:null==Q||null===(i=Q.payments)||void 0===i||null===(r=i.Payments)||void 0===r||null===(u=r[0])||void 0===u?void 0:u.paymentDetails[0].receiptNumber},{retry:!1,staleTime:Infinity,refetchOnWindowFocus:!1,select:e=>e.Payments[0],enabled:H}),{data:ee}=Digit.Hooks.useCommonMDMS(z,"common-masters","ReceiptKey",{select:e=>{var t,n,l;return(null===(t=e["common-masters"])||void 0===t||null===(n=t.uiCommonPay)||void 0===n||null===(l=n.filter(e=>{let{code:t}=e;return null==W?void 0:W.includes(t)})[0])||void 0===l?void 0:l.receiptKey)||"consolidatedreceipt"},retry:!1,staleTime:Infinity,refetchOnWindowFocus:!1}),te=null==Q?void 0:Q.payments;if(n.useEffect(()=>()=>{localStorage.setItem("BillPaymentEnabled","false"),B.clear()},[]),n.useEffect(()=>{Q&&Q.txnStatus&&"FAILURE"!==Q.txnStatus&&j(!0)},[Q]),K||J)return l.createElement(t.Loader,null);const ne=null==Q?void 0:Q.applicationNo,le=window.Digit.Utils.browser.isMobile();if(X||!te||!te.Payments||0===te.Payments.length||"FAILURE"===Q.txnStatus)return l.createElement(t.Card,null,l.createElement(t.Banner,{message:k("CITIZEN_FAILURE_COMMON_PAYMENT_MESSAGE"),info:k("CS_PAYMENT_TRANSANCTION_ID"),applicationNumber:x,successful:!1}),l.createElement(t.CardText,null,k("CS_PAYMENT_FAILURE_MESSAGE")),null!=W&&W.includes("PT")?l.createElement(l.Fragment,null,l.createElement(o.Link,{to:ne&&"/digit-ui/citizen/payment/my-bills/"+W+"/"+ne||"/digit-ui/citizen"},l.createElement(t.SubmitBar,{label:k("CS_PAYMENT_TRY_AGAIN")})),l.createElement("div",{className:"link",style:le?{marginTop:"8px",width:"100%",textAlign:"center"}:{marginTop:"8px"}},l.createElement(o.Link,{to:"/digit-ui/citizen"},k("CORE_COMMON_GO_TO_HOME")))):l.createElement(o.Link,{to:"/digit-ui/citizen"},l.createElement(t.SubmitBar,{label:k("CORE_COMMON_GO_TO_HOME")})));const ae=null==Q||null===(c=Q.payments)||void 0===c?void 0:c.Payments[0],oe=null==ae?void 0:ae.transactionDate,ie=function(){try{var e;function t(){return Promise.resolve(Digit.PaymentService.printReciept(n,{fileStoreIds:l.filestoreIds[0]})).then(function(e){e&&e[l.filestoreIds[0]]&&window.open(e[l.filestoreIds[0]],"_blank"),Y(!1)})}if(U)return Promise.resolve();Y(!0);const n=Digit.ULBService.getStateId();let l={filestoreIds:[null===(e=te.Payments[0])||void 0===e?void 0:e.fileStoreId]};const a=function(){if(null==ae||!ae.fileStoreId)return Promise.resolve(Digit.PaymentService.generatePdf(n,{Payments:[te.Payments[0]]},ee)).then(function(e){l=e})}();return Promise.resolve(a&&a.then?a.then(t):t())}catch(e){return Promise.reject(e)}},re=function(e,t){void 0===t&&(t="download");try{var n,l;let a={applicationNo:null==G||null===(n=G[0])||void 0===n?void 0:n.applicationNo};return Promise.resolve(Digit.OBPSService.BPASearch(null==G||null===(l=G[0])||void 0===l?void 0:l.tenantId,a)).then(function(n){var l,a;return Promise.resolve(Digit.OBPSService.scrutinyDetails(null==G||null===(l=G[0])||void 0===l?void 0:l.tenantId,{edcrNumber:null==G||null===(a=G[0])||void 0===a?void 0:a.edcrNumber})).then(function(l){var a,o;let i=null==n||null===(a=n.BPA)||void 0===a?void 0:a[0],r=null==l||null===(o=l.edcrDetail)||void 0===o?void 0:o[0],s=new Date;i.additionalDetails.runDate=function(e,t){void 0===t&&(t="dayend");try{const n=e.match(/(\d{4})-(\d{1,2})-(\d{1,2})/),l=new Date(Date.UTC(n[1],n[2]-1,n[3]));return l.setMinutes(l.getMinutes()+l.getTimezoneOffset()),"dayend"===t&&(l.setHours(l.getHours()+24),l.setSeconds(l.getSeconds()-1)),l.getTime()}catch(t){return e}}(s.getFullYear()+"-"+(s.getMonth()+1)+"-"+s.getDate());let u={...i,edcrDetail:[{...r}]};return Promise.resolve(Digit.PaymentService.generatePdf(null==i?void 0:i.tenantId,{Bpa:[u]},e)).then(function(e){return Promise.resolve(Digit.PaymentService.printReciept(null==i?void 0:i.tenantId,{fileStoreIds:e.filestoreIds[0]})).then(function(n){var l;return window.open(n[null==e?void 0:e.filestoreIds[0]],"_blank"),u.applicationType=null==i||null===(l=i.additionalDetails)||void 0===l?void 0:l.applicationType,Promise.resolve(Digit.OBPSService.edcr_report_download({BPA:{...u}})).then(function(e){const n=parseInt(e.status,10);201!==n&&200!==n||("print"==t?(e=>{const t=URL.createObjectURL(e);var n=window.open(t);null!=n&&n.addEventListener("load",e=>{n.focus(),n.print()})})(new Blob([e.data],{type:"application/pdf"})):((e,t)=>{if(window.mSewaApp&&window.mSewaApp.isMsewaApp()&&window.mSewaApp.downloadBase64File){var n=new FileReader;n.readAsDataURL(e),n.onloadend=function(){mSewaApp.downloadBase64File(n.result,"edcrReport.pdf")}}else{const t=document.createElement("a");t.href=URL.createObjectURL(e),t.download="edcrReport.pdf",document.body.append(t),t.click(),t.remove(),setTimeout(()=>URL.revokeObjectURL(t.href),7e3)}})(new Blob([e.data],{type:"application/pdf"})))})})})})})}catch(e){return Promise.reject(e)}};let se;var ue,ce,de,me,Ee;if(F)se="CITIZEN_SUCCESS_UC_PAYMENT_MESSAGE";else if(null!=ae&&null!==(ue=ae.paymentDetails)&&void 0!==ue&&null!==(ce=ue[0])&&void 0!==ce&&ce.businessService&&null!=ae&&null!==(de=ae.paymentDetails)&&void 0!==de&&null!==(me=de[0])&&void 0!==me&&null!==(Ee=me.businessService)&&void 0!==Ee&&Ee.includes("BPA")){var ve;let e=sessionStorage.getItem("BPA_ARCHITECT_NAME"),t=e?JSON.parse(e):"ARCHITECT";se="CITIZEN_SUCCESS_"+(null==ae||null===(ve=ae.paymentDetails[0])||void 0===ve?void 0:ve.businessService.replace(/\./g,"_"))+"_"+t+"_PAYMENT_MESSAGE"}else if(null!=W&&W.includes("WS")||null!=W&&W.includes("SW"))se=k("CITIZEN_SUCCESS_"+(null==ae?void 0:ae.paymentDetails[0].businessService.replace(/\./g,"_"))+"_WS_PAYMENT_MESSAGE");else{var pe,_e;se=null!=ae&&null!==(pe=ae.paymentDetails[0])&&void 0!==pe&&pe.businessService?"CITIZEN_SUCCESS_"+(null==ae||null===(_e=ae.paymentDetails[0])||void 0===_e?void 0:_e.businessService.replace(/\./g,"_"))+"_PAYMENT_MESSAGE":k("CITIZEN_SUCCESS_UC_PAYMENT_MESSAGE")}const fe={padding:"4px 0px",justifyContent:"space-between"},ye=["PT"].includes(W);return(window.location.href.includes("bpa")||window.location.href.includes("BPA"))&&q?l.createElement(t.Loader,null):l.createElement(t.Card,null,l.createElement(t.Banner,{svg:l.createElement("svg",{className:"payment-svg",xmlns:"http://www.w3.org/2000/svg",width:"40",height:"40",viewBox:"0 0 40 40",fill:"none"},l.createElement("path",{d:"M20 0C8.96 0 0 8.96 0 20C0 31.04 8.96 40 20 40C31.04 40 40 31.04 40 20C40 8.96 31.04 0 20 0ZM16 30L6 20L8.82 17.18L16 24.34L31.18 9.16L34 12L16 30Z",fill:"white"})),message:k("CS_COMMON_PAYMENT_COMPLETE"),info:k("CS_COMMON_RECIEPT_NO"),applicationNumber:null==ae?void 0:ae.paymentDetails[0].receiptNumber,successful:!0}),l.createElement(t.CardText,null,k(se+"_DETAIL")),l.createElement(t.StatusTable,null,l.createElement(t.Row,{rowContainerStyle:fe,last:!0,label:k(Z),text:ne}),("PT"===W||F)&&l.createElement(t.Row,{rowContainerStyle:fe,last:!0,label:k("CS_PAYMENT_BILLING_PERIOD"),text:(e=>{const{taxPeriodFrom:t,taxPeriodTo:n,fromPeriod:l,toPeriod:a}=e||{};return t&&n?"FY "+new Date(t).getFullYear().toString()+"-"+new Date(n).getFullYear().toString():l&&a?"mcollect"===F?new Date(l).getDate().toString()+" "+Digit.Utils.date.monthNames[new Date(l).getMonth()].toString()+" "+new Date(l).getFullYear().toString()+" - "+new Date(a).getDate()+" "+Digit.Utils.date.monthNames[new Date(a).getMonth()]+" "+new Date(a).getFullYear():"WNS"===F?new Date(l).getDate().toString()+"/"+(new Date(l).getMonth()+1).toString()+"/"+new Date(l).getFullYear().toString()+" - "+new Date(a).getDate()+"/"+(new Date(a).getMonth()+1)+"/"+new Date(a).getFullYear():"FY "+new Date(l).getFullYear().toString()+"-"+new Date(a).getFullYear().toString():"N/A"})(null==$||null===(d=$.paymentDetails[0])||void 0===d||null===(m=d.bill)||void 0===m?void 0:m.billDetails[0])}),("PT"===W||F)&&l.createElement(t.Row,{rowContainerStyle:fe,last:!0,label:k("CS_PAYMENT_AMOUNT_PENDING"),text:null!=$&&null!==(E=$.paymentDetails)&&void 0!==E&&null!==(v=E[0])&&void 0!==v&&v.totalDue&&null!=$&&null!==(p=$.paymentDetails)&&void 0!==p&&null!==(_=p[0])&&void 0!==_&&_.totalAmountPaid?"â‚¹ "+((null==$||null===(f=$.paymentDetails)||void 0===f||null===(y=f[0])||void 0===y?void 0:y.totalDue)-(null==$||null===(S=$.paymentDetails)||void 0===S||null===(b=S[0])||void 0===b?void 0:b.totalAmountPaid)):"â‚¹ 0"}),l.createElement(t.Row,{rowContainerStyle:fe,last:!0,label:k("CS_PAYMENT_TRANSANCTION_ID"),text:x}),l.createElement(t.Row,{rowContainerStyle:fe,last:!0,label:k(ye?"CS_PAYMENT_AMOUNT_PAID_WITHOUT_SYMBOL":"CS_PAYMENT_AMOUNT_PAID"),text:null!=$&&null!==(N=$.paymentDetails)&&void 0!==N&&null!==(g=N[0])&&void 0!==g&&g.totalAmountPaid?"â‚¹ "+(null==$||null===(h=$.paymentDetails)||void 0===h||null===(C=h[0])||void 0===C?void 0:C.totalAmountPaid):"â‚¹ 0"}),("PT"!==W||F)&&l.createElement(t.Row,{rowContainerStyle:fe,last:!0,label:k("CS_PAYMENT_TRANSANCTION_DATE"),text:oe&&new Date(oe).toLocaleDateString("in")})),l.createElement("div",{style:{display:"flex"}},"TL"==W?l.createElement("div",{className:"primary-label-btn d-grid",style:{marginLeft:"unset",marginRight:"20px",marginTop:"15px",marginBottom:"15px"},onClick:ie},l.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",height:"24px",viewBox:"0 0 24 24",width:"24px",fill:"#a82227"},l.createElement("path",{d:"M0 0h24v24H0V0z",fill:"none"}),l.createElement("path",{d:"M19 9h-4V3H9v6H5l7 7 7-7zm-8 2V5h2v6h1.17L12 13.17 9.83 11H11zm-6 7h14v2H5z"})),k("TL_RECEIPT")):null,"TL"==W?l.createElement("div",{className:"primary-label-btn d-grid",style:{marginLeft:"unset",marginTop:"15px"},onClick:function(){try{const e=z;return Promise.resolve(Digit.TLService.search({applicationNumber:V,tenantId:z})).then(function(t){const n=function(){if(t)return Promise.resolve(Digit.PaymentService.generatePdf(e,{Licenses:null==t?void 0:t.Licenses},"tlcertificate")).then(function(t){return Promise.resolve(Digit.PaymentService.printReciept(e,{fileStoreIds:t.filestoreIds[0]})).then(function(e){window.open(e[t.filestoreIds[0]],"_blank")})})}();if(n&&n.then)return n.then(function(){})})}catch(e){return Promise.reject(e)}}},l.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",height:"24px",viewBox:"0 0 24 24",width:"24px",fill:"#a82227"},l.createElement("path",{d:"M0 0h24v24H0V0z",fill:"none"}),l.createElement("path",{d:"M19 9h-4V3H9v6H5l7 7 7-7zm-8 2V5h2v6h1.17L12 13.17 9.83 11H11zm-6 7h14v2H5z"})),k("TL_CERTIFICATE")):null,"BPA_OC"!==(null==G||null===(A=G[0])||void 0===A?void 0:A.businessService)||"APPROVED"!==(null==G||null===(P=G[0])||void 0===P?void 0:P.status)&&"PENDING_SANC_FEE_PAYMENT"!==(null==G||null===(T=G[0])||void 0===T?void 0:T.status)?null:l.createElement("div",{className:"primary-label-btn d-grid",style:{marginLeft:"unset"},onClick:e=>re("occupancy-certificate")},l.createElement(t.DownloadPrefixIcon,null),k("BPA_OC_CERTIFICATE")),"BPA_LOW"===(null==G||null===(D=G[0])||void 0===D?void 0:D.businessService)?l.createElement("div",{className:"primary-label-btn d-grid",style:{marginLeft:"unset"},onClick:e=>re("buildingpermit-low")},l.createElement(t.DownloadPrefixIcon,null),k("BPA_PERMIT_ORDER")):null,"BPA"!==(null==G||null===(O=G[0])||void 0===O?void 0:O.businessService)||"BPA_LOW"===(null==G||null===(M=G[0])||void 0===M?void 0:M.businessService)||"BPA_OC"===(null==G||null===(L=G[0])||void 0===L?void 0:L.businessService)||"PENDING_SANC_FEE_PAYMENT"!==(null==G||null===(I=G[0])||void 0===I?void 0:I.status)&&"APPROVED"!==(null==G||null===(w=G[0])||void 0===w?void 0:w.status)?null:l.createElement("div",{className:"primary-label-btn d-grid",style:{marginLeft:"unset"},onClick:e=>re("buildingpermit")},l.createElement(t.DownloadPrefixIcon,null),k("BPA_PERMIT_ORDER"))),(null==W?void 0:W.includes("PT"))&&l.createElement("div",{style:{marginTop:"10px"}},l.createElement(o.Link,{to:"/digit-ui/citizen/feedback?redirectedFrom=digit-ui/citizen/payment/success&propertyId="+(V||"")+"&acknowldgementNumber="+(x||"")+"&tenantId="+z+"&creationReason="+(null==W||null===(R=W.split("."))||void 0===R?void 0:R[1])},l.createElement(t.SubmitBar,{label:k("CS_REVIEW_AND_FEEDBACK")}))),null!=W&&W.includes("PT")?l.createElement("div",{className:"link",style:le?{marginTop:"8px",width:"100%",textAlign:"center"}:{marginTop:"8px"},onClick:ie},k("CS_DOWNLOAD_RECEIPT")):null,!("TL"==W)||!(null!=W&&W.includes("PT"))&&l.createElement(t.SubmitBar,{onSubmit:ie,label:k("COMMON_DOWNLOAD_RECEIPT")}),!("TL"==W)||!(null!=W&&W.includes("PT"))&&l.createElement("div",{className:"link",style:le?{marginTop:"8px",width:"100%",textAlign:"center"}:{marginTop:"8px"}},l.createElement(o.Link,{to:"/digit-ui/citizen"},k("CORE_COMMON_GO_TO_HOME"))),"TL"==W&&l.createElement(o.Link,{to:"/digit-ui/citizen"},l.createElement(t.SubmitBar,{label:k("CORE_COMMON_GO_TO_HOME")})))},T=e=>{const{t:n}=a.useTranslation(),{consumerCode:i}=o.useParams();return l.createElement(t.Card,null,l.createElement(t.Banner,{message:"Failure !",complaintNumber:i,successful:!1}),l.createElement(t.CardText,null,n("ES_COMMON_TRACK_COMPLAINT_TEXT")))},D=e=>{let{stateCode:t,cityCode:n,moduleCode:a}=e;const{path:i}=o.useRouteMatch(),r={stateCode:t,cityCode:n,moduleCode:a};return l.createElement(l.Fragment,null,l.createElement("div",{className:"bills-citizen-wrapper"},l.createElement(o.Switch,null,l.createElement(o.Route,{path:i+"/my-bills/:businessService"},l.createElement(g,{stateCode:t})),l.createElement(o.Route,{path:i+"/billDetails/:businessService/:consumerCode/:paymentAmt"},l.createElement(m,c({},r,{stateCode:t,basePath:i}))),l.createElement(o.Route,{path:i+"/collect/:businessService/:consumerCode"},l.createElement(C,c({},r,{stateCode:t,basePath:i}))),l.createElement(o.Route,{path:i+"/success/:businessService/:consumerCode/:tenantId"},l.createElement(A,r)),l.createElement(o.Route,{path:i+"/failure"},l.createElement(T,r)))))},O=e=>{var o,i;let{...r}=e;const{t:s}=a.useTranslation(),[u,c]=n.useState(null==r||null===(o=r.value)||void 0===o?void 0:o.manualReceiptDate),[d,m]=n.useState(null==r||null===(i=r.value)||void 0===i?void 0:i.manualReceiptNumber);return n.useEffect(()=>{if(r.onChange){let e={};u||(e.manualReceiptDate="ES_COMMON_MANUAL_RECEIPT_DATE"),d||(e.manualReceiptNumber="ES_COMMON_MANUAL_RECEIPT_NO"),r.onChange({manualReceiptNumber:d,manualReceiptDate:u,errorObj:e})}},[u,d]),l.createElement(l.Fragment,null,l.createElement("div",{className:"label-field-pair"},l.createElement("h2",{className:"card-label"},s("NOC_PAYMENT_RCPT_NO_LABEL")),l.createElement("div",{className:"field"},l.createElement("div",{className:"field-container"},l.createElement("input",{className:"employee-card-input",value:d,type:"text",name:"instrumentNumber",onChange:e=>m(e.target.value)})))),l.createElement("div",{className:"label-field-pair"},l.createElement("h2",{className:"card-label"},s("NOC_PAYMENT_RECEIPT_ISSUE_DATE_LABEL")," "),l.createElement("div",{className:"field"},l.createElement("div",{className:"field-container"},l.createElement(t.DatePicker,{date:u,onChange:e=>{c(e)}})))))},M=e=>{var t,o,i;let{...r}=e;const{t:s}=a.useTranslation(),[u,c]=n.useState(null==r||null===(t=r.value)||void 0===t?void 0:t.last4Digits),[d,m]=n.useState(null==r||null===(o=r.value)||void 0===o?void 0:o.transactionNumber),[E,v]=n.useState(null==r||null===(i=r.value)||void 0===i?void 0:i.reTransanctionNumber);return n.useEffect(()=>{if(r.onChange){let e={};u||(e.last4Digits="ES_COMMON_LAST_4_DIGITS"),d||(e.transactionNumber="ES_COMMON_TRANSANCTION_NO"),E||(e.reTransanctionNumber="ES_COMMON_RE_TRANSANCTION_NO"),r.onChange({transactionNumber:d,reTransanctionNumber:E,instrumentNumber:u,errorObj:e})}},[u,d,E]),l.createElement(l.Fragment,null,l.createElement("div",{className:"label-field-pair"},l.createElement("h2",{className:"card-label"},s("NOC_PAYMENT_CARD_LAST_DIGITS_LABEL")+" *"),l.createElement("div",{className:"field"},l.createElement("div",{className:"field-container"},l.createElement("input",{className:"employee-card-input",value:u,type:"text",name:"instrumentNumber",maxLength:"4",minLength:"4",required:!0,onChange:e=>c(e.target.value)})))),l.createElement("div",{className:"label-field-pair"},l.createElement("h2",{className:"card-label"},s("NOC_PAYMENT_TRANS_NO_LABEL")+" *"),l.createElement("div",{className:"field"},l.createElement("div",{className:"field-container"},l.createElement("input",{className:"employee-card-input",value:d,type:"text",name:"instrumentNumber",required:!0,onChange:e=>m(e.target.value)})))),l.createElement("div",{className:"label-field-pair"},l.createElement("h2",{className:"card-label"},s("NOC_PAYMENT_RENTR_TRANS_LABEL")+" *"),l.createElement("div",{className:"field"},l.createElement("div",{className:"field-container"},l.createElement("input",{className:"employee-card-input",value:E,type:"text",name:"instrumentNumber",required:!0,onChange:e=>v(e.target.value)})))))},L=e=>{var o;const{t:i}=a.useTranslation(),[r,s]=n.useState(e.chequeDetails.instrumentDate),[u,c]=n.useState(e.chequeDetails.instrumentNumber),[d,m]=n.useState(e.chequeDetails.ifscCode),[E,v]=n.useState(""),[p,_]=n.useState(e.chequeDetails.bankName),[f,y]=n.useState(null===(o=e.chequeDetails.bankBranch)||void 0===o?void 0:o.replace("â”¬Ã¡"," "));return n.useEffect(()=>{if(e.onChange){let t={};r||(t.instrumentDate="ES_COMMON_INSTRUMENT_DATE"),u||(t.instrumentNumber="ES_COMMON_INSTR_NUMBER"),d||(t.ifscCode="ES_COMMON_IFSC"),e.onChange({instrumentDate:r,instrumentNumber:u,ifscCode:d,bankName:p,bankBranch:f,errorObj:t,transactionNumber:u})}},[p,f,r,u]),l.createElement(l.Fragment,null,l.createElement("div",{className:"label-field-pair"},l.createElement("h2",{className:"card-label"},i("PAYMENT_CHQ_NO_LABEL")," *"),l.createElement("div",{className:"field"},l.createElement("div",{className:"field-container"},l.createElement("input",{className:"employee-card-input",value:u,type:"text",name:"instrumentNumber",onChange:e=>c(e.target.value),required:!0})))),l.createElement("div",{className:"label-field-pair"},l.createElement("h2",{className:"card-label"},i("PAYMENT_CHEQUE_DATE_LABEL")," *"),l.createElement("div",{className:"field"},l.createElement("div",{className:"field-container"},l.createElement(t.DatePicker,{isRequired:!0,date:r,onChange:e=>{s(e)}})))),l.createElement(l.Fragment,null,l.createElement("div",{className:"label-field-pair"},l.createElement("h2",{className:"card-label"},i("PAYMENT_IFSC_CODE_LABEL")," *"),l.createElement("div",{className:"field"},l.createElement("div",null,l.createElement("div",{className:"cheque-date"},l.createElement("input",{value:d,type:"text",onChange:e=>{m(e.target.value),v("")},minlength:"11",maxlength:"11",required:!0}),l.createElement("button",{type:"button",onClick:function(){try{const e=h(function(){return Promise.resolve(window.fetch("https://ifsc.razorpay.com/"+d)).then(function(e){const t=function(){if(e.ok)return Promise.resolve(e.json()).then(function(e){let{BANK:t,BRANCH:n}=e;_(t),y(null==n?void 0:n.replace("â”¬Ã¡"," "))});v(i("CS_PAYMENT_INCORRECT_IFSC_CODE_ERROR"))}();if(t&&t.then)return t.then(function(){})})},function(){v(i("CS_PAYMENT_INCORRECT_IFSC_CODE_ERROR"))});return Promise.resolve(e&&e.then?e.then(function(){}):void 0)}catch(e){return Promise.reject(e)}}},l.createElement(t.SearchIconSvg,null)))))),E&&l.createElement(t.CardLabelError,{style:{width:"70%",marginLeft:"30%",fontSize:"12px",marginTop:"-21px"}},E),l.createElement("div",{className:"label-field-pair"},l.createElement("h2",{className:"card-label"},i("PAYMENT_BANK_NAME_LABEL")),l.createElement("div",{className:"field"},l.createElement("div",{className:"field-container"},l.createElement("input",{className:"employee-card-input",value:p,type:"text",className:"employee-card-input",readOnly:!0,disabled:!0})))),l.createElement("div",{className:"label-field-pair"},l.createElement("h2",{className:"card-label"},i("PAYMENT_BANK_BRANCH_LABEL")),l.createElement("div",{className:"field"},l.createElement("div",{className:"field-container"},l.createElement("input",{className:"employee-card-input",value:f,type:"text",className:"employee-card-input",readOnly:!0,disabled:!0}))))))};var I=function(e,t){return e===t||e!=e&&t!=t},w=function(e,t){for(var n=e.length;n--;)if(I(e[n][0],t))return n;return-1},R=Array.prototype.splice;function k(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var l=e[t];this.set(l[0],l[1])}}k.prototype.clear=function(){this.__data__=[],this.size=0},k.prototype.delete=function(e){var t=this.__data__,n=w(t,e);return!(n<0||(n==t.length-1?t.pop():R.call(t,n,1),--this.size,0))},k.prototype.get=function(e){var t=this.__data__,n=w(t,e);return n<0?void 0:t[n][1]},k.prototype.has=function(e){return w(this.__data__,e)>-1},k.prototype.set=function(e,t){var n=this.__data__,l=w(n,e);return l<0?(++this.size,n.push([e,t])):n[l][1]=t,this};var B=k,x="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function F(e,t){return e(t={exports:{}},t.exports),t.exports}var U,Y="object"==typeof x&&x&&x.Object===Object&&x,H="object"==typeof self&&self&&self.Object===Object&&self,j=Y||H||Function("return this")(),W=j.Symbol,V=Object.prototype,z=V.hasOwnProperty,G=V.toString,q=W?W.toStringTag:void 0,K=Object.prototype.toString,Q=W?W.toStringTag:void 0,X=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":Q&&Q in Object(e)?function(e){var t=z.call(e,q),n=e[q];try{e[q]=void 0;var l=!0}catch(e){}var a=G.call(e);return l&&(t?e[q]=n:delete e[q]),a}(e):function(e){return K.call(e)}(e)},Z=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)},$=function(e){if(!Z(e))return!1;var t=X(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t},J=j["__core-js_shared__"],ee=(U=/[^.]+$/.exec(J&&J.keys&&J.keys.IE_PROTO||""))?"Symbol(src)_1."+U:"",te=Function.prototype.toString,ne=function(e){if(null!=e){try{return te.call(e)}catch(e){}try{return e+""}catch(e){}}return""},le=/^\[object .+?Constructor\]$/,ae=RegExp("^"+Function.prototype.toString.call(Object.prototype.hasOwnProperty).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),oe=function(e,t){var n=function(e,t){return null==e?void 0:e[t]}(e,t);return function(e){return!(!Z(e)||(t=e,ee&&ee in t))&&($(e)?ae:le).test(ne(e));var t}(n)?n:void 0},ie=oe(j,"Map"),re=oe(Object,"create"),se=Object.prototype.hasOwnProperty,ue=Object.prototype.hasOwnProperty;function ce(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var l=e[t];this.set(l[0],l[1])}}ce.prototype.clear=function(){this.__data__=re?re(null):{},this.size=0},ce.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},ce.prototype.get=function(e){var t=this.__data__;if(re){var n=t[e];return"__lodash_hash_undefined__"===n?void 0:n}return se.call(t,e)?t[e]:void 0},ce.prototype.has=function(e){var t=this.__data__;return re?void 0!==t[e]:ue.call(t,e)},ce.prototype.set=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=re&&void 0===t?"__lodash_hash_undefined__":t,this};var de=ce,me=function(e,t){var n,l,a=e.__data__;return("string"==(l=typeof(n=t))||"number"==l||"symbol"==l||"boolean"==l?"__proto__"!==n:null===n)?a["string"==typeof t?"string":"hash"]:a.map};function Ee(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var l=e[t];this.set(l[0],l[1])}}Ee.prototype.clear=function(){this.size=0,this.__data__={hash:new de,map:new(ie||B),string:new de}},Ee.prototype.delete=function(e){var t=me(this,e).delete(e);return this.size-=t?1:0,t},Ee.prototype.get=function(e){return me(this,e).get(e)},Ee.prototype.has=function(e){return me(this,e).has(e)},Ee.prototype.set=function(e,t){var n=me(this,e),l=n.size;return n.set(e,t),this.size+=n.size==l?0:1,this};var ve=Ee;function pe(e){var t=this.__data__=new B(e);this.size=t.size}pe.prototype.clear=function(){this.__data__=new B,this.size=0},pe.prototype.delete=function(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n},pe.prototype.get=function(e){return this.__data__.get(e)},pe.prototype.has=function(e){return this.__data__.has(e)},pe.prototype.set=function(e,t){var n=this.__data__;if(n instanceof B){var l=n.__data__;if(!ie||l.length<199)return l.push([e,t]),this.size=++n.size,this;n=this.__data__=new ve(l)}return n.set(e,t),this.size=n.size,this};var _e=pe;function fe(e){var t=-1,n=null==e?0:e.length;for(this.__data__=new ve;++t<n;)this.add(e[t])}fe.prototype.add=fe.prototype.push=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this},fe.prototype.has=function(e){return this.__data__.has(e)};var ye=fe,Se=function(e,t){for(var n=-1,l=null==e?0:e.length;++n<l;)if(t(e[n],n,e))return!0;return!1},be=function(e,t,n,l,a,o){var i=1&n,r=e.length,s=t.length;if(r!=s&&!(i&&s>r))return!1;var u=o.get(e),c=o.get(t);if(u&&c)return u==t&&c==e;var d=-1,m=!0,E=2&n?new ye:void 0;for(o.set(e,t),o.set(t,e);++d<r;){var v=e[d],p=t[d];if(l)var _=i?l(p,v,d,t,e,o):l(v,p,d,e,t,o);if(void 0!==_){if(_)continue;m=!1;break}if(E){if(!Se(t,function(e,t){if(!E.has(t)&&(v===e||a(v,e,n,l,o)))return E.push(t)})){m=!1;break}}else if(v!==p&&!a(v,p,n,l,o)){m=!1;break}}return o.delete(e),o.delete(t),m},Ne=j.Uint8Array,ge=function(e){var t=-1,n=Array(e.size);return e.forEach(function(e,l){n[++t]=[l,e]}),n},he=function(e){var t=-1,n=Array(e.size);return e.forEach(function(e){n[++t]=e}),n},Ce=W?W.prototype:void 0,Ae=Ce?Ce.valueOf:void 0,Pe=Array.isArray,Te=Object.prototype.propertyIsEnumerable,De=Object.getOwnPropertySymbols,Oe=De?function(e){return null==e?[]:(e=Object(e),function(t,n){for(var l=-1,a=null==t?0:t.length,o=0,i=[];++l<a;){var r=t[l];Te.call(e,r)&&(i[o++]=r)}return i}(De(e)))}:function(){return[]},Me=function(e){return null!=e&&"object"==typeof e},Le=function(e){return Me(e)&&"[object Arguments]"==X(e)},Ie=Object.prototype,we=Ie.hasOwnProperty,Re=Ie.propertyIsEnumerable,ke=Le(function(){return arguments}())?Le:function(e){return Me(e)&&we.call(e,"callee")&&!Re.call(e,"callee")},Be=function(){return!1},xe=F(function(e,t){var n=t&&!t.nodeType&&t,l=n&&e&&!e.nodeType&&e,a=l&&l.exports===n?j.Buffer:void 0;e.exports=(a?a.isBuffer:void 0)||Be}),Fe=/^(?:0|[1-9]\d*)$/,Ue=function(e,t){var n=typeof e;return!!(t=null==t?9007199254740991:t)&&("number"==n||"symbol"!=n&&Fe.test(e))&&e>-1&&e%1==0&&e<t},Ye=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991},He={};He["[object Float32Array]"]=He["[object Float64Array]"]=He["[object Int8Array]"]=He["[object Int16Array]"]=He["[object Int32Array]"]=He["[object Uint8Array]"]=He["[object Uint8ClampedArray]"]=He["[object Uint16Array]"]=He["[object Uint32Array]"]=!0,He["[object Arguments]"]=He["[object Array]"]=He["[object ArrayBuffer]"]=He["[object Boolean]"]=He["[object DataView]"]=He["[object Date]"]=He["[object Error]"]=He["[object Function]"]=He["[object Map]"]=He["[object Number]"]=He["[object Object]"]=He["[object RegExp]"]=He["[object Set]"]=He["[object String]"]=He["[object WeakMap]"]=!1;var je,We=F(function(e,t){var n=t&&!t.nodeType&&t,l=n&&e&&!e.nodeType&&e,a=l&&l.exports===n&&Y.process,o=function(){try{return l&&l.require&&l.require("util").types||a&&a.binding&&a.binding("util")}catch(e){}}();e.exports=o}),Ve=We&&We.isTypedArray,ze=Ve?(je=Ve,function(e){return je(e)}):function(e){return Me(e)&&Ye(e.length)&&!!He[X(e)]},Ge=Object.prototype.hasOwnProperty,qe=Object.prototype,Ke=function(e,t){return function(n){return e(t(n))}}(Object.keys,Object),Qe=Object.prototype.hasOwnProperty,Xe=function(e){return function(e,t,n){var l=function(e){return null!=(t=e)&&Ye(t.length)&&!$(t)?function(e,t){var n=Pe(e),l=!n&&ke(e),a=!n&&!l&&xe(e),o=!n&&!l&&!a&&ze(e),i=n||l||a||o,r=i?function(e,t){for(var n=-1,l=Array(e);++n<e;)l[n]=t(n);return l}(e.length,String):[],s=r.length;for(var u in e)!Ge.call(e,u)||i&&("length"==u||a&&("offset"==u||"parent"==u)||o&&("buffer"==u||"byteLength"==u||"byteOffset"==u)||Ue(u,s))||r.push(u);return r}(e):function(e){if((t=e)!==("function"==typeof(n=t&&t.constructor)&&n.prototype||qe))return Ke(e);var t,n,l=[];for(var a in Object(e))Qe.call(e,a)&&"constructor"!=a&&l.push(a);return l}(e);var t}(e);return Pe(e)?l:function(e,t){for(var n=-1,l=t.length,a=e.length;++n<l;)e[a+n]=t[n];return e}(l,n(e))}(e,0,Oe)},Ze=Object.prototype.hasOwnProperty,$e=oe(j,"DataView"),Je=oe(j,"Promise"),et=oe(j,"Set"),tt=oe(j,"WeakMap"),nt=ne($e),lt=ne(ie),at=ne(Je),ot=ne(et),it=ne(tt),rt=X;($e&&"[object DataView]"!=rt(new $e(new ArrayBuffer(1)))||ie&&"[object Map]"!=rt(new ie)||Je&&"[object Promise]"!=rt(Je.resolve())||et&&"[object Set]"!=rt(new et)||tt&&"[object WeakMap]"!=rt(new tt))&&(rt=function(e){var t=X(e),n="[object Object]"==t?e.constructor:void 0,l=n?ne(n):"";if(l)switch(l){case nt:return"[object DataView]";case lt:return"[object Map]";case at:return"[object Promise]";case ot:return"[object Set]";case it:return"[object WeakMap]"}return t});var st=rt,ut=Object.prototype.hasOwnProperty;const ct=(e,t)=>({PT:[{head:t("ES_BILL_DETAILS_PT_DETAILS_HEADING"),body:[{withoutLabel:!0,type:"custom",populators:{name:"amount",customProps:{businessService:"PT",consumerCode:e.consumerCode},component:(e,t)=>l.createElement(dt,c({onChange:e.onChange,amount:e.value},t))}}]}],mcollect:[{head:t("COMMON_PAY_SCREEN_HEADER"),body:[{withoutLabel:!0,type:"custom",populators:{name:"amount",customProps:{businessService:e.businessService,consumerCode:e.consumerCode},component:(e,t)=>l.createElement(dt,c({onChange:e.onChange,amount:e.value},t))}}]}],"PT.MUTATION":[{head:t("COMMON_PAY_SCREEN_HEADER"),body:[{withoutLabel:!0,type:"custom",populators:{name:"amount",customProps:{businessService:e.businessService,consumerCode:e.consumerCode},component:(e,t)=>l.createElement(dt,c({onChange:e.onChange,amount:e.value},t))}}]}],TL:[{body:[{withoutLabel:!0,type:"custom",populators:{name:"amount",customProps:{businessService:"TL",consumerCode:e.consumerCode},component:(e,t)=>l.createElement(dt,c({onChange:e.onChange,amount:e.value},t))}}]}],WS:[{head:t("COMMON_PAY_SCREEN_HEADER"),body:[{withoutLabel:!0,type:"custom",populators:{name:"amount",customProps:{businessService:"WS",consumerCode:e.consumerCode},component:(e,t)=>l.createElement(dt,c({onChange:e.onChange,amount:e.value},t))}}]}],"WS.ONE_TIME_FEE":[{head:t("COMMON_PAY_SCREEN_HEADER"),body:[{withoutLabel:!0,type:"custom",populators:{name:"amount",customProps:{businessService:"WS.ONE_TIME_FEE",consumerCode:e.consumerCode},component:(e,t)=>l.createElement(dt,c({onChange:e.onChange,amount:e.value},t))}}]}],"SW.ONE_TIME_FEE":[{head:t("COMMON_PAY_SCREEN_HEADER"),body:[{withoutLabel:!0,type:"custom",populators:{name:"amount",customProps:{businessService:"SW.ONE_TIME_FEE",consumerCode:e.consumerCode},component:(e,t)=>l.createElement(dt,c({onChange:e.onChange,amount:e.value},t))}}]}],SW:[{head:t("COMMON_PAY_SCREEN_HEADER"),body:[{withoutLabel:!0,type:"custom",populators:{name:"amount",customProps:{businessService:"SW",consumerCode:e.consumerCode},component:(e,t)=>l.createElement(dt,c({onChange:e.onChange,amount:e.value},t))}}]}],FSM:[{head:t("ES_TITLE_PAYMENT_DETAILS"),body:[{withoutLabel:!0,type:"custom",populators:{name:"amount",customProps:{businessService:e.businessService,consumerCode:e.consumerCode},component:(e,t)=>l.createElement(dt,c({onChange:e.onChange,amount:e.value},t))}}]}]}),dt=e=>{var o,i,r,s,u,c,d;let{businessService:m,consumerCode:E,onChange:v}=e;const{t:p}=a.useTranslation(),{workflow:_,IsDisconnectionFlow:f}=Digit.Hooks.useQueryParams(),y=Digit.ULBService.getCurrentTenantId(),{data:S,isLoading:b}=Digit.Hooks.useFetchPayment({tenantId:y,businessService:m,consumerCode:E}),N=window.location.href.includes("FSM"),{data:g}=Digit.Hooks.fsm.useSearch(y,{applicationNos:E},{staleTime:Infinity,enabled:!(null==m||null===(o=m.toUpperCase())||void 0===o||!o.includes("FSM"))}),[h,C]=n.useState(),[A,P]=n.useState(!0),{data:T}=Digit.Hooks.fsm.useApplicationDetail(p,y,E,{enabled:!!N},"EMPLOYEE"),D=null==h||null===(i=h.billDetails)||void 0===i?void 0:i.sort((e,t)=>t.fromPeriod-e.fromPeriod),O=(null==D?void 0:D[0])||[],M=()=>null!=h&&h.totalAmount?null==h?void 0:h.totalAmount:0,L=()=>null!=g&&g.advanceAmount?null==g?void 0:g.advanceAmount:0,I=(null==h||null===(r=h.billDetails)||void 0===r||null===(s=r.sort((e,t)=>t.fromPeriod-e.fromPeriod))||void 0===s?void 0:s.reduce((e,t,n)=>0===n?e:e+t.amount,0))||0,{isLoading:w,data:R}=Digit.Hooks.useGetPaymentRulesForBusinessServices(y),[k,B]=n.useState();n.useEffect(()=>{var e,t;const n=null==R||null===(e=R.MdmsRes)||void 0===e||null===(t=e.BillingService)||void 0===t?void 0:t.BusinessService;B(null!=n&&n.length?f?{...n.filter(e=>e.code==m)[0],partPaymentAllowed:!1}:n.filter(e=>e.code==m)[0]:{})},[R]);const{minAmountPayable:x,isAdvanceAllowed:F}=k||{},[U,Y]=n.useState(p("CS_PAYMENT_FULL_AMOUNT")),[H,j]=n.useState(M()),[W,V]=n.useState(!0),[z,G]=n.useState(""),q=e=>{j(e)};n.useEffect(()=>{"mcollect"===_&&(null==O?void 0:O.billAccountDetails)&&(null==O||O.billAccountDetails.map(e=>{e.taxHeadCode.includes("CGST")?e.order=3:e.taxHeadCode.includes("SGST")&&(e.order=4)}))},[null==O?void 0:O.billAccountDetails]),n.useEffect(()=>{let e=x&&H>=x&&H<=M()&&!z;("WS"===m||"SW"===m)&&H>M()&&F&&(e=x&&H>=x&&!z),U!=p("CS_PAYMENT_FULL_AMOUNT")?V(e):V(!0)},[U,H]),n.useEffect(()=>{if(!h&&S){let e=S.Bill.filter(e=>e.consumerCode==E)[0];C(e)}},[S]),n.useEffect(()=>{U!==p("CS_PAYMENT_FULL_AMOUNT")?K(H.toString()):(G(""),q(M()))},[U,h]),n.useEffect(()=>{U!==p("CS_PAYMENT_FULL_AMOUNT")?v({amount:H,paymentAllowed:W,error:z,minAmountPayable:x}):v({amount:M(),paymentAllowed:!0,error:z,minAmountPayable:x})},[W,z,H,U]);const K=e=>{G(""),isNaN(e)||e.includes(".")?G("AMOUNT_INVALID"):!F&&e>M()?G("CS_ADVANCED_PAYMENT_NOT_ALLOWED"):e<x&&G("CS_CANT_PAY_BELOW_MIN_AMOUNT"),q(e)};if(b||w)return l.createElement(t.Loader,null);const Q={textAlign:"left",borderBottom:"#D6D5D4 1px solid",padding:"16px 12px",whiteSpace:"break-spaces"},X={textAlign:"left",borderBottom:"#D6D5D4 1px solid",padding:"8px 10px",breakWord:"no-break"},Z="DSO_INPROGRESS"===(null==g?void 0:g.applicationStatus);return l.createElement(l.Fragment,null,l.createElement(t.StatusTable,null,!N&&h&&{PT:{heading:"ES_BILL_DETAILS_PT_DETAILS_HEADING",details:[{keyValue:"PT_PROPERTY_ID",keyPath:["consumerCode"],fallback:""},{keyValue:"CS_PAYMENT_BILLING_PERIOD",keyPath:["billDetails",e=>{const{fromPeriod:t,toPeriod:n}=e[0];return t&&n?"FY "+new Date(t).getFullYear().toString()+"-"+new Date(n).getFullYear().toString():"N/A"}],fallback:"N/A"},{keyValue:"CS_BILL_NO",keyPath:["billDetails",e=>{const{currentBillNo:t}=e[0];return t||"N/A"}],fallback:"N/A"},{keyValue:"CS_BILL_DUEDATE",keyPath:["billDetails",e=>{const{currentExpiryDate:t}=e[0];return t?new Date(t).toLocaleDateString():"N/A"}],fallback:"N/A"}]},mcollect:{heading:"COMMON_PAY_SCREEN_HEADER",details:[{keyValue:"UC_CHALLAN_NO",keyPath:["consumerCode"],fallback:""}]},"PT.MUTATION":{heading:"COMMON_PAY_SCREEN_HEADER",details:[{keyValue:"PDF_STATIC_LABEL_MUATATION_NUMBER_LABEL",keyPath:["consumerCode"],fallback:""},{keyValue:"CS_BILL_NO",keyPath:["billDetails",e=>{const{currentBillNo:t}=e[0];return t||"N/A"}],fallback:"N/A"},{keyValue:"CS_BILL_DUEDATE",keyPath:["billDetails",e=>{const{currentExpiryDate:t}=e[0];return t?new Date(t).toLocaleDateString():"N/A"}],fallback:"N/A"}]},TL:{heading:"COMMON_PAY_SCREEN_HEADER",details:[{keyValue:"TL_TRADE_LICENSE_LABEL",keyPath:["consumerCode"],fallback:""}]},"WS.ONE_TIME_FEE":{heading:"COMMON_PAY_SCREEN_HEADER",details:[{keyValue:"WS_COMMON_TABLE_APP_NO_LABEL",keyPath:["consumerCode"],fallback:""}]},"SW.ONE_TIME_FEE":{heading:"COMMON_PAY_SCREEN_HEADER",details:[{keyValue:"WS_COMMON_TABLE_APP_NO_LABEL",keyPath:["consumerCode"],fallback:""}]},WS:{heading:"COMMON_PAY_SCREEN_HEADER",details:[{keyValue:"WS_COMMON_TABLE_COL_CONSUMER_NO_LABEL",keyPath:["consumerCode"],fallback:""},{keyValue:"CS_PAYMENT_BILLING_PERIOD",keyPath:["billDetails",e=>{const{fromPeriod:t,toPeriod:n}=e[0];return t&&n?new Date(t).toLocaleDateString()+" - "+new Date(n).toLocaleDateString():"N/A"}],fallback:"N/A"},{keyValue:"CS_BILL_NO",keyPath:["billNumber"],fallback:"N/A"},{keyValue:"CS_BILL_DUEDATE",keyPath:["billDetails",e=>{const{currentExpiryDate:t}=e[0];return t?new Date(t).toLocaleDateString():"N/A"}],fallback:"N/A"}]},SW:{heading:"COMMON_PAY_SCREEN_HEADER",details:[{keyValue:"WS_COMMON_TABLE_COL_CONSUMER_NO_LABEL",keyPath:["consumerCode"],fallback:""},{keyValue:"CS_PAYMENT_BILLING_PERIOD",keyPath:["billDetails",e=>{const{fromPeriod:t,toPeriod:n}=e[0];return t&&n?new Date(t).toLocaleDateString()+" - "+new Date(n).toLocaleDateString():"N/A"}],fallback:"N/A"},{keyValue:"CS_BILL_NO",keyPath:["billNumber"],fallback:"N/A"},{keyValue:"CS_BILL_DUEDATE",keyPath:["billDetails",e=>{const{expiryDate:t}=e[0];return t?new Date(t).toLocaleDateString():"N/A"}],fallback:"N/A"}]},FSM:{heading:"COMMON_PAY_SCREEN_HEADER",details:[{keyValue:"ADV_TOTAL_AMOUNT",keyPath:["totalAmount"],fallback:""},{keyValue:"ADV_COLLECTION",keyPath:["totalAmountPaid"],fallback:"N/A"}]}}[_||m].details.map((e,n)=>{const a=e.keyPath.reduce((e,t)=>"function"==typeof t?t(e):e[t],h);return l.createElement(t.Row,{key:n+"bill",label:p(e.keyValue),text:a})})),N?l.createElement(t.StatusTable,null,l.createElement(t.Row,{label:p("ES_PAYMENT_DETAILS_AMOUNT_PER_TRIP"),textStyle:{textAlign:"left"},text:"â‚¹ "+Number(null!=T&&null!==(le=T.additionalDetails)&&void 0!==le&&le.tripAmount?null==T||null===(ae=T.additionalDetails)||void 0===ae?void 0:ae.tripAmount:0).toFixed(2)}),l.createElement(t.Row,{label:p("ES_PAYMENT_DETAILS_TOTAL_AMOUNT"),textStyle:{textAlign:"left"},text:null!=g&&g.paymentPreference?"â‚¹ "+Number(null==h?void 0:h.totalAmount).toFixed(2):"â‚¹ "+Number(null!=T&&T.totalAmount?null==T?void 0:T.totalAmount:0).toFixed(2)}),!(null!=g&&g.paymentPreference)&&l.createElement(t.Row,Z?{label:p("ES_PAYMENT_DETAILS_ADV_AMOUNT_PAID"),textStyle:{fontWeight:"bold",textAlign:"left"},text:"â‚¹ "+Number(L()).toFixed(2)}:{label:p("ES_PAYMENT_DETAILS_ADV_AMOUNT_DUE"),textStyle:{fontWeight:"bold",textAlign:"left"},text:"â‚¹ "+Number(L()).toFixed(2)}),"PENDING_APPL_FEE_PAYMENT"!==(null==g?void 0:g.applicationStatus)?l.createElement(t.Row,{label:p("FSM_DUE_AMOUNT_TO_BE_PAID"),textStyle:{fontWeight:"bold",textAlign:"left"},text:"â‚¹ "+Number(null!=h&&h.totalAmount?null==h?void 0:h.totalAmount:0).toFixed(2)}):null):l.createElement(t.StatusTable,{style:{paddingTop:"46px"}},l.createElement(t.Row,{label:p("ES_PAYMENT_TAXHEADS"),textStyle:{fontWeight:"bold"},text:p("ES_PAYMENT_AMOUNT")}),l.createElement("hr",{style:{width:"40%"},className:"underline"}),null==O||null===(u=O.billAccountDetails)||void 0===u?void 0:u.sort((e,t)=>e.order-t.order).map((e,n)=>{var a;return l.createElement(t.Row,{key:n+"taxheads",labelStyle:{fontWeight:"normal"},textStyle:{textAlign:"right",maxWidth:"100px"},label:p(e.taxHeadCode),text:"â‚¹ "+(null===(a=e.amount)||void 0===a?void 0:a.toFixed(2))})}),null!=I&&null!==(c=I.toFixed)&&void 0!==c&&c.call(I,2)?l.createElement(t.Row,{labelStyle:{fontWeight:"normal"},textStyle:{textAlign:"right",maxWidth:"100px"},label:p("COMMON_ARREARS"),text:"â‚¹ "+(null==I||null===(d=I.toFixed)||void 0===d?void 0:d.call(I,2))||Number(0).toFixed(2)}):null,l.createElement("hr",{style:{width:"40%"},className:"underline"}),l.createElement(t.Row,{label:p("CS_PAYMENT_TOTAL_AMOUNT"),textStyle:{fontWeight:"bold",textAlign:"right",maxWidth:"100px"},text:"â‚¹ "+Number(M()).toFixed(2)}),!A&&!_&&"TL"!==m&&(null==D?void 0:D.length)>1&&l.createElement(n.Fragment,null,l.createElement("div",{className:"row last"},l.createElement("div",{style:{maxWidth:"100px"},onClick:()=>P(!0),className:"filter-button value"},p("ES_COMMON_VIEW_DETAILS"))))),A&&(null==D?void 0:D.length)>1&&!_&&"TL"!==m&&l.createElement(l.Fragment,null,l.createElement("div",{style:{maxWidth:"95%",display:"inline-block",textAlign:"right"}},l.createElement("div",{style:{display:"flex",padding:"10px",paddingLeft:"unset",maxWidth:"95%"}},l.createElement("div",{style:{backgroundColor:"#EEEEEE",overflowX:"auto"}},l.createElement("table",{className:"table-fixed-column-common-pay"},l.createElement("thead",null,l.createElement("tr",null,l.createElement("th",{style:Q},p("CS_BILL_NO")),l.createElement("th",{style:{...Q}},p("CS_PAYMENT_BILLING_PERIOD")),l.createElement("th",{style:{...Q}},p("CS_BILL_DUEDATE")),null==D||null===($=D.filter((e,t)=>t>0))||void 0===$||null===(J=$[0])||void 0===J||null===(ee=J.billAccountDetails)||void 0===ee||null===(te=ee.sort((e,t)=>e.order-t.order))||void 0===te?void 0:te.map((e,t)=>l.createElement("th",{style:{...Q},key:t},p(e.taxHeadCode))),l.createElement("th",{style:Q},p("TOTAL_TAX")))),l.createElement("tbody",null,null==D||null===(ne=D.filter((e,t)=>t>0))||void 0===ne?void 0:ne.map((e,t)=>{var n;const a=null==e||null===(n=e.billAccountDetails)||void 0===n?void 0:n.sort((e,t)=>e.order-t.order);return l.createElement("tr",{key:t},l.createElement("td",{style:X},null==e?void 0:e.billNumber),l.createElement("td",{style:X},(e=>{const{fromPeriod:t,toPeriod:n}=e;return new Date(t).toLocaleDateString()+"-"+new Date(n).toLocaleDateString()})(e)),l.createElement("td",{style:X},(null==e?void 0:e.expiryDate)&&new Date(null==e?void 0:e.expiryDate).toLocaleDateString()),a.map((e,t)=>l.createElement("td",{style:X,key:t},e.amount)),l.createElement("td",{style:X},e.amount))}))))),l.createElement("div",{style:{float:"left"},onClick:()=>P(!1),className:"filter-button"},p("ES_COMMON_HIDE_DETAILS")))),!N&&(null==k?void 0:k.partPaymentAllowed)&&l.createElement("div",{style:{marginTop:"50px"},className:"bill-payment-amount"},l.createElement(t.CardSectionHeader,null,p("CS_COMMON_PAYMENT_AMOUNT")),l.createElement(t.RadioButtons,{style:{display:"flex"},innerStyles:{padding:"5px"},selectedOption:U,onSelect:Y,options:k.partPaymentAllowed?[p("CS_PAYMENT_FULL_AMOUNT"),p("CS_PAYMENT_CUSTOM_AMOUNT")]:[p("CS_PAYMENT_FULL_AMOUNT")]}),l.createElement("div",{style:{position:"relative"}},l.createElement("span",{className:"payment-amount-front",style:{border:"1px solid "+(U===p("CS_PAYMENT_FULL_AMOUNT")?"#9a9a9a":"black")}},"â‚¹"),U!==p("CS_PAYMENT_FULL_AMOUNT")?l.createElement(t.TextInput,{style:{width:"30%"},className:"text-indent-xl",onChange:e=>K(e.target.value),value:H,disable:0===M()}):l.createElement(t.TextInput,{style:{width:"30%"},className:"text-indent-xl",value:M(),disable:!0}),"CS_CANT_PAY_BELOW_MIN_AMOUNT"===z?l.createElement("span",{className:"card-label-error"},p(z),": ","â‚¹"+x):l.createElement("span",{className:"card-label-error"},p(z)))));var $,J,ee,te,ne,le,ae},mt=e=>{var i;const{workflow:r,IsDisconnectionFlow:u}=Digit.Hooks.useQueryParams(),{t:d}=a.useTranslation(),m=o.useHistory(),E=s.useQueryClient();o.useRouteMatch();let{consumerCode:v,businessService:p}=o.useParams();const _=Digit.ULBService.getCurrentTenantId(),f=o.useLocation().search;window.location.href.includes("ISWSAPP")&&(v=new URLSearchParams(f).get("applicationNumber")),(window.location.href.includes("ISWSCON")||"WS"===r)&&(v=decodeURIComponent(v));const{data:y,isLoading:S}=Digit.Hooks.useFetchPayment({tenantId:_,consumerCode:v,businessService:p}),b=null!=y&&y.Bill?null==y?void 0:y.Bill[0]:{},{data:N}=Digit.Hooks.fsm.useSearch(_,{applicationNos:v},{staleTime:Infinity,enabled:!(null==p||null===(i=p.toUpperCase())||void 0===i||!i.includes("FSM"))}),g=null==N?void 0:N.advanceAmount,{cardConfig:C}=((e,t)=>({cardConfig:[{head:t("PAYMENT_CARD_HEAD"),headId:"paymentInfo",body:[{withoutLabel:!0,type:"custom",populators:{name:"paymentModeDetails",customProps:{},defaultValue:{},component:(e,t)=>l.createElement(M,c({onChange:e.onChange,value:e.value},t))}}]}]}))(0,d),{chequeConfig:A}=((e,t)=>({chequeConfig:[{head:t("PAYMENT_CHEQUE_HEAD"),headId:"paymentInfo",body:[{withoutLabel:!0,type:"custom",populators:{name:"paymentModeDetails",customProps:{},defaultValue:{instrumentNumber:"",instrumentDate:"",ifscCode:"",bankName:"",bankBranch:""},component:(e,t)=>l.createElement(L,c({onChange:e.onChange,chequeDetails:e.value},t))}}]}]}))(0,d),{cashConfig:P}=((e,t)=>({cashConfig:[{head:t("NOC_PAYMENT_RCPT_DETAILS"),headId:"paymentInfo",body:[{withoutLabel:!0,type:"custom",populators:{name:"ManualRecieptDetails",customProps:{},defaultValue:{manualReceiptNumber:"",manualReceiptDate:""},component:(e,t)=>l.createElement(O,c({},t,{onChange:e.onChange,value:e.value}))}}]}]}))(0,d),[T,D]=n.useState({}),[w,R]=n.useState(null);n.useEffect(()=>{null!=y&&y.Bill&&0===y.Bill.length&&R({key:"error",action:"CS_BILL_NOT_FOUND"})},[y]);const k=[{code:"CASH",label:d("COMMON_MASTERS_PAYMENTMODE_CASH")},{code:"CHEQUE",label:d("COMMON_MASTERS_PAYMENTMODE_CHEQUE")},{code:"CARD",label:d("COMMON_MASTERS_PAYMENTMODE_CREDIT/DEBIT CARD")}],B={CHEQUE:A,CARD:C};n.useEffect(()=>{e.setLink(d("PAYMENT_COLLECT_LABEL"))},[]);const x=()=>k,F=[{code:"OWNER",name:d("COMMON_OWNER")},{code:"OTHER",name:d("COMMON_OTHER")}],[U,Y]=n.useState((null==T?void 0:T.selectedPaymentMode)||x()[0]),[H,j]=n.useState((null==T?void 0:T.paidBy)||{code:"OWNER",name:d("COMMON_OWNER")});n.useEffect(()=>{var e,t,n,l;null===(e=document)||void 0===e||null===(t=e.getElementById("paymentInfo"))||void 0===t||t.scrollIntoView({behavior:"smooth"}),null===(n=document)||void 0===n||null===(l=n.querySelector("#paymentInfo + .label-field-pair input"))||void 0===l||l.focus()},[U]);let W=[{head:r||"TL"===p?"":d("COMMON_PAYMENT_HEAD"),body:[{label:d("PAY_TOTAL_AMOUNT"),populators:l.createElement(t.CardSectionHeader,{style:{marginBottom:0,textAlign:"right"}}," ","â‚¹ "+(null==b?void 0:b.totalAmount)," ")}]},{head:d("PAYMENT_PAID_BY_HEAD"),body:[{label:d("PAYMENT_PAID_BY_LABEL"),isMandatory:!0,type:"custom",populators:{name:"paidBy",customProps:{t:d,isMendatory:!0,option:F,optionKey:"name"},component:(e,n)=>l.createElement(t.Dropdown,c({},n,{selected:e.value,select:t=>{t.name==F[0].name?e.setValue("payerName",null==b?void 0:b.payerName):(e.setValue("payerName",""),e.setValue("payerMobile","")),e.onChange(t),j(t)}})),defaultValue:(null==T?void 0:T.paidBy)||F[0]}},{label:d("PAYMENT_PAYER_NAME_LABEL"),isMandatory:!0,disable:!("OWNER"!==(null==H?void 0:H.code)||!(null!=b&&b.payerName||null!=T&&T.payerName)),type:"text",populators:{name:"payerName",validation:{required:!0,pattern:/^[A-Za-z]/},error:d("PAYMENT_INVALID_NAME"),defaultValue:(null==b?void 0:b.payerName)||(null==T?void 0:T.payerName)||"",className:"payment-form-text-input-correction"}},{label:d("PAYMENT_PAYER_MOB_LABEL"),isMandatory:!0,type:"text",populators:{name:"payerMobile",validation:{required:!0,pattern:/^[6-9]\d{9}$/},error:d("CORE_COMMON_APPLICANT_MOBILE_NUMBER_INVALID"),className:"payment-form-text-input-correction"}}]},{head:d("PAYMENT_MODE_HEAD"),body:[{label:d("PAYMENT_MODE_LABEL"),type:"custom",populators:{name:"paymentMode",customProps:{options:x(),optionsKey:"label",style:{display:"flex",flexWrap:"wrap"},innerStyles:{minWidth:"33%"}},defaultValue:(null==T?void 0:T.paymentMode)||x()[0],component:(e,n)=>l.createElement(t.RadioButtons,c({selectedOption:e.value,onSelect:t=>{e.onChange(t)}},n))}}]}];const V=window.location.href.includes("FSM");return S?l.createElement(t.Loader,null):l.createElement(l.Fragment,null,l.createElement(t.Header,{styles:{marginLeft:"15px"}},d(V?"PAYMENT_COLLECT_LABEL":"PAYMENT_COLLECT")),l.createElement(t.FormComposer,{cardStyle:{paddingBottom:"100px"},label:d("PAYMENT_COLLECT_LABEL"),config:(()=>{var e,t;(ct({consumerCode:v,businessService:p},d)[r?"SW"===p&&"WS"===r?p:r:p]||r||"TL"===p||p.includes("ONE_TIME_FEE"))&&W.splice(0,1);let n=W.concat(B[null==T||null===(e=T.paymentMode)||void 0===e?void 0:e.code]||[]);return n=null===(t=n)||void 0===t?void 0:t.concat(P),ct({consumerCode:v,businessService:p},d)[r?"SW"===p&&"WS"===r?p:r:p]?ct({consumerCode:v,businessService:p},d)[r?"SW"===p&&"WS"===r?p:r:p].concat(n):n})(),onSubmit:function(t){try{var n,l,a,o,i,s,c,f,y,S;if(b.totalAmount=Math.round(b.totalAmount),t.paidBy=t.paidBy.code,ct({consumerCode:v,businessService:p},d)[r?"SW"===p&&"WS"===r?p:r:p]&&(null==t||null===(n=t.amount)||void 0===n||!n.paymentAllowed)){var C,A,P,T;let e="CS_CANT_PAY_BELOW_MIN_AMOUNT"===(null==t||null===(C=t.amount)||void 0===C?void 0:C.error)?d(null==t||null===(A=t.amount)||void 0===A?void 0:A.error)+"- "+(null==t||null===(P=t.amount)||void 0===P?void 0:P.minAmountPayable):d(null==t||null===(T=t.amount)||void 0===T?void 0:T.error);return R({key:"error",action:e}),Promise.resolve()}const{ManualRecieptDetails:O,paymentModeDetails:M,...L}=t,{...I}=M||{};let w={Payment:{mobileNumber:t.payerMobile,paymentDetails:[{businessService:p,billId:b.id,totalDue:b.totalAmount,totalAmountPaid:(null==t||null===(l=t.amount)||void 0===l?void 0:l.amount)||b.totalAmount}],tenantId:b.tenantId,totalDue:b.totalAmount,totalAmountPaid:(null==t||null===(a=t.amount)||void 0===a?void 0:a.amount)||b.totalAmount,paymentMode:t.paymentMode.code,payerName:t.payerName,paidBy:t.paidBy}};if(null===g||"PENDING_APPL_FEE_PAYMENT"!==(null==N?void 0:N.applicationStatus)||N.paymentPreference||(w.Payment.paymentDetails[0].totalAmountPaid=g,w.Payment.totalAmountPaid=g,w.Payment.totalDue=b.totalAmount),t.ManualRecieptDetails.manualReceiptDate&&(w.Payment.paymentDetails[0].manualReceiptDate=new Date(O.manualReceiptDate).getTime()),t.ManualRecieptDetails.manualReceiptNumber&&(w.Payment.paymentDetails[0].manualReceiptNumber=O.manualReceiptNumber),w.Payment.paymentMode=null==t||null===(o=t.paymentMode)||void 0===o?void 0:o.code,t.paymentModeDetails){var D;if(w.Payment={...w.Payment,...I},delete w.Payment.paymentModeDetails,t.paymentModeDetails.errorObj){const e=t.paymentModeDetails.errorObj,n=Object.keys(e).map(t=>d(e[t])).join();if(n)return R({key:"error",action:n+" "+d("ES_ERROR_REQUIRED")}),setTimeout(()=>R(null),5e3),Promise.resolve()}t.errorMsg&&R({key:"error",action:d(errorMsg)}),w.Payment.instrumentDate=new Date(null==w||null===(D=w.Payment)||void 0===D?void 0:D.instrumentDate).getTime(),w.Payment.transactionNumber=t.paymentModeDetails.transactionNumber}if(null!=t&&null!==(i=t.paymentModeDetails)&&void 0!==i&&i.transactionNumber){if(t.paymentModeDetails.transactionNumber!==t.paymentModeDetails.reTransanctionNumber&&["CARD"].includes(t.paymentMode.code))return R({key:"error",action:d("ERR_TRASACTION_NUMBERS_DONT_MATCH")}),setTimeout(()=>R(null),5e3),Promise.resolve();delete w.Payment.last4Digits,delete w.Payment.reTransanctionNumber}if(null!==(s=w.Payment)&&void 0!==s&&null!==(c=s.instrumentNumber)&&void 0!==c&&c.length&&(null===(f=w.Payment)||void 0===f||null===(y=f.instrumentNumber)||void 0===y?void 0:y.length)<6&&"CHEQUE"===(null==w||null===(S=w.Payment)||void 0===S?void 0:S.paymentMode))return R({key:"error",action:d("ERR_CHEQUE_NUMBER_LESS_THAN_6")}),setTimeout(()=>R(null),5e3),Promise.resolve();const k=h(function(){return Promise.resolve(Digit.PaymentService.createReciept(_,w)).then(function(t){var n,l,a,o,i,r,s,c,d,v;E.invalidateQueries(),m.push(u?e.basePath+"/success/"+p+"/"+(null==t||null===(n=t.Payments[0])||void 0===n||null===(l=n.paymentDetails[0])||void 0===l?void 0:l.receiptNumber.replace(/\//g,"%2F"))+"/"+(null==t||null===(a=t.Payments[0])||void 0===a||null===(o=a.paymentDetails[0])||void 0===o||null===(i=o.bill)||void 0===i?void 0:i.consumerCode)+"?IsDisconnectionFlow="+u:e.basePath+"/success/"+p+"/"+(null==t||null===(r=t.Payments[0])||void 0===r||null===(s=r.paymentDetails[0])||void 0===s?void 0:s.receiptNumber.replace(/\//g,"%2F"))+"/"+(null==t||null===(c=t.Payments[0])||void 0===c||null===(d=c.paymentDetails[0])||void 0===d||null===(v=d.bill)||void 0===v?void 0:v.consumerCode)+"?IsDisconnectionFlow="+u)})},function(e){var t,n,l,a;null===(t=R({key:"error",action:null==e||null===(n=e.response)||void 0===n||null===(l=n.data)||void 0===l||null===(a=l.Errors)||void 0===a?void 0:a.map(e=>d(e.code))}))||void 0===t||t.join(" , "),setTimeout(()=>R(null),5e3)});return Promise.resolve(k&&k.then?k.then(function(){}):void 0)}catch(e){return Promise.reject(e)}},formState:T,defaultValues:{payerName:(null==b?void 0:b.payerName)||(null==T?void 0:T.payerName)||""},isDisabled:!u&&(null==b||!b.totalAmount||!b.totalAmount>0),onFormValueChange:(e,t)=>{(function e(t,n,l,a,o){return t===n||(null==t||null==n||!Me(t)&&!Me(n)?t!=t&&n!=n:function(e,t,n,l,a,o){var i=Pe(e),r=Pe(t),s=i?"[object Array]":st(e),u=r?"[object Array]":st(t),c="[object Object]"==(s="[object Arguments]"==s?"[object Object]":s),d="[object Object]"==(u="[object Arguments]"==u?"[object Object]":u),m=s==u;if(m&&xe(e)){if(!xe(t))return!1;i=!0,c=!1}if(m&&!c)return o||(o=new _e),i||ze(e)?be(e,t,n,l,a,o):function(e,t,n,l,a,o,i){switch(n){case"[object DataView]":if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case"[object ArrayBuffer]":return!(e.byteLength!=t.byteLength||!o(new Ne(e),new Ne(t)));case"[object Boolean]":case"[object Date]":case"[object Number]":return I(+e,+t);case"[object Error]":return e.name==t.name&&e.message==t.message;case"[object RegExp]":case"[object String]":return e==t+"";case"[object Map]":var r=ge;case"[object Set]":if(r||(r=he),e.size!=t.size&&!(1&l))return!1;var s=i.get(e);if(s)return s==t;l|=2,i.set(e,t);var u=be(r(e),r(t),l,a,o,i);return i.delete(e),u;case"[object Symbol]":if(Ae)return Ae.call(e)==Ae.call(t)}return!1}(e,t,s,n,l,a,o);if(!(1&n)){var E=c&&ut.call(e,"__wrapped__"),v=d&&ut.call(t,"__wrapped__");if(E||v){var p=E?e.value():e,_=v?t.value():t;return o||(o=new _e),a(p,_,n,l,o)}}return!!m&&(o||(o=new _e),function(e,t,n,l,a,o){var i=1&n,r=Xe(e),s=r.length;if(s!=Xe(t).length&&!i)return!1;for(var u=s;u--;){var c=r[u];if(!(i?c in t:Ze.call(t,c)))return!1}var d=o.get(e),m=o.get(t);if(d&&m)return d==t&&m==e;var E=!0;o.set(e,t),o.set(t,e);for(var v=i;++u<s;){var p=e[c=r[u]],_=t[c];if(l)var f=i?l(_,p,c,t,e,o):l(p,_,c,e,t,o);if(!(void 0===f?p===_||a(p,_,n,l,o):f)){E=!1;break}v||(v="constructor"==c)}if(E&&!v){var y=e.constructor,S=t.constructor;y==S||!("constructor"in e)||!("constructor"in t)||"function"==typeof y&&y instanceof y&&"function"==typeof S&&S instanceof S||(E=!1)}return o.delete(e),o.delete(t),E}(e,t,n,l,a,o))}(t,n,l,a,e,o))})(t.paymentMode,U)||(D(t),Y(T.paymentMode))}}),w&&l.createElement(t.Toast,{error:"error"===w.key,label:d("success"===w.key?"ES_"+p.split(".")[0].toLowerCase()+"_"+w.action+"_UPDATE_SUCCESS":w.action),onClose:()=>R(null),style:{maxWidth:"670px"}}))},Et=e=>{var i,r,u,c,d,m,E,v,p,_,f;const y=o.useHistory(),{t:S}=a.useTranslation(),b=s.useQueryClient(),{IsDisconnectionFlow:N}=Digit.Hooks.useQueryParams(),[g,h]=n.useState(!1),[C,A]=n.useState(null),P=(null===(i=location)||void 0===i||null===(r=i.pathname)||void 0===r?void 0:r.includes("payment/success/FSM.TRIP_CHARGES"))?S("PAYMENT_COLLECT_LABEL")+" / "+S("PAYMENT_COLLECT"):S("PAYMENT_LOCALIZATION_RESPONSE");e.setLink(P);let{consumerCode:T,receiptNumber:D,businessService:O}=o.useParams();const M=Digit.ULBService.getCurrentTenantId();D=D.replace(/%2F/g,"/");const{data:L={},isLoading:I}=Digit.Hooks.obps.useOBPSSearch("",{},M,{applicationNo:T},{},{enabled:!(null==O||!O.includes("BPA"))}),w=Digit.UserService.hasAccess("FSM_EDITOR_EMP")||!1;n.useEffect(()=>()=>{!function(){try{const e=Digit.ULBService.getCurrentTenantId(),t=Digit.ULBService.getStateId();Promise.resolve(Digit.PaymentService.getReciept(e,O,{receiptNumbers:D})).then(function(e){var n;let l={filestoreIds:[null===(n=e.Payments[0])||void 0===n?void 0:n.fileStoreId]};const a=function(n){if(null===(n=e.Payments[0])||void 0===n||!n.fileStoreId)return Promise.resolve(Digit.PaymentService.generatePdf(t,{Payments:e.Payments},B)).then(function(e){l=e})}();if(a&&a.then)return a.then(function(){})})}catch(e){return Promise.reject(e)}}(),b.clear()},[]),n.useEffect(()=>{switch(C){case"GO_TO_HOME":return y.push("/digit-ui/employee");case"ASSIGN_TO_DSO":return y.push("/digit-ui/employee/fsm/application-details/"+T);default:return null}},[C]);let R=["GO_TO_HOME"];w&&(R=[...R,"ASSIGN_TO_DSO"]);const k=null==O?void 0:O.includes("FSM"),{data:B}=Digit.Hooks.useCommonMDMS(M,"common-masters","ReceiptKey",{select:e=>{var t,n,l;return(null===(t=e["common-masters"])||void 0===t||null===(n=t.uiCommonPay)||void 0===n||null===(l=n.filter(e=>{let{code:t}=e;return null==O?void 0:O.includes(t)})[0])||void 0===l?void 0:l.receiptKey)||"consolidatedreceipt"}}),x=function(e,t){void 0===t&&(t="download");try{var n,l;let a={applicationNo:null==L||null===(n=L[0])||void 0===n?void 0:n.applicationNo};return Promise.resolve(Digit.OBPSService.BPASearch(null==L||null===(l=L[0])||void 0===l?void 0:l.tenantId,a)).then(function(n){var l,a;return Promise.resolve(Digit.OBPSService.scrutinyDetails(null==L||null===(l=L[0])||void 0===l?void 0:l.tenantId,{edcrNumber:null==L||null===(a=L[0])||void 0===a?void 0:a.edcrNumber})).then(function(l){var a,o;let i=null==n||null===(a=n.BPA)||void 0===a?void 0:a[0],r=null==l||null===(o=l.edcrDetail)||void 0===o?void 0:o[0],s=new Date;i.additionalDetails.runDate=function(e,t){void 0===t&&(t="dayend");try{const n=e.match(/(\d{4})-(\d{1,2})-(\d{1,2})/),l=new Date(Date.UTC(n[1],n[2]-1,n[3]));return l.setMinutes(l.getMinutes()+l.getTimezoneOffset()),"dayend"===t&&(l.setHours(l.getHours()+24),l.setSeconds(l.getSeconds()-1)),l.getTime()}catch(t){return e}}(s.getFullYear()+"-"+(s.getMonth()+1)+"-"+s.getDate());let u={...i,edcrDetail:[{...r}]};return Promise.resolve(Digit.PaymentService.generatePdf(null==i?void 0:i.tenantId,{Bpa:[u]},e)).then(function(e){return Promise.resolve(Digit.PaymentService.printReciept(null==i?void 0:i.tenantId,{fileStoreIds:e.filestoreIds[0]})).then(function(n){var l,a;return window.open(n[null==e?void 0:e.filestoreIds[0]],"_blank"),u.applicationType=null==L||null===(l=L[0])||void 0===l||null===(a=l.additionalDetails)||void 0===a?void 0:a.applicationType,Promise.resolve(Digit.OBPSService.edcr_report_download({BPA:{...u}})).then(function(e){const n=parseInt(e.status,10);201!==n&&200!==n||("print"==t?(e=>{const t=URL.createObjectURL(e);var n=window.open(t);null!=n&&n.addEventListener("load",e=>{n.focus(),n.print()})})(new Blob([e.data],{type:"application/pdf"})):((e,t)=>{if(window.mSewaApp&&window.mSewaApp.isMsewaApp()&&window.mSewaApp.downloadBase64File){var n=new FileReader;n.readAsDataURL(e),n.onloadend=function(){mSewaApp.downloadBase64File(n.result,"edcrReport.pdf")}}else{const t=document.createElement("a");t.href=URL.createObjectURL(e),t.download="edcrReport.pdf",document.body.append(t),t.click(),t.remove(),setTimeout(()=>URL.revokeObjectURL(t.href),7e3)}})(new Blob([e.data],{type:"application/pdf"})))})})})})})}catch(e){return Promise.reject(e)}};return null!=O&&O.includes("BPA")&&I?l.createElement(t.Loader,null):l.createElement(l.Fragment,null,l.createElement(t.Card,null,l.createElement(t.Banner,{message:S("ES_PAYMENT_COLLECTED"),info:S("PAYMENT_LOCALIZATION_RECIEPT_NO"),applicationNumber:D,successful:!0}),l.createElement(t.CardText,null,(()=>{if(null!=O&&O.includes("BPA")){let e=sessionStorage.getItem("BPA_ARCHITECT_NAME"),t=e?JSON.parse(e):"ARCHITECT";return S("ES_PAYMENT_"+O+"_"+t+"_SUCCESSFUL_DESCRIPTION")}return null!=O&&O.includes("WS")||null!=O&&O.includes("SW")?S("ES_PAYMENT_WS_"+(null==O?void 0:O.replace(/\./g,"_"))+"_SUCCESSFUL_DESCRIPTION"):S("ES_PAYMENT_SUCCESSFUL_DESCRIPTION")})()),B?l.createElement("div",{style:{display:"flex"}},l.createElement("div",{className:"primary-label-btn d-grid",style:{marginLeft:"unset",marginRight:"20px"},onClick:"true"===N?function(){try{let e=M||Digit.ULBService.getCurrentTenantId(),t=window.location.href.substring(window.location.href.lastIndexOf(T),window.location.href.lastIndexOf("?"));return Promise.resolve(Digit.Utils.downloadReceipt(t,O,"consolidatedreceipt",e)).then(function(){})}catch(e){return Promise.reject(e)}}:function(){try{const e=Digit.ULBService.getCurrentTenantId(),t=Digit.ULBService.getStateId();return Promise.resolve(Digit.PaymentService.getReciept(e,O,{receiptNumbers:D})).then(function(e){var n;function l(){return Promise.resolve(Digit.PaymentService.printReciept(t,{fileStoreIds:a.filestoreIds[0]})).then(function(e){window.open(e[a.filestoreIds[0]],"_blank")})}let a={filestoreIds:[null===(n=e.Payments[0])||void 0===n?void 0:n.fileStoreId]};const o=function(n){if(null===(n=e.Payments[0])||void 0===n||!n.fileStoreId)return Promise.resolve(Digit.PaymentService.generatePdf(t,{Payments:e.Payments},B)).then(function(e){a=e})}();return o&&o.then?o.then(l):l()})}catch(e){return Promise.reject(e)}}},l.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",height:"24",viewBox:"0 0 24 24",width:"24"},l.createElement("path",{d:"M0 0h24v24H0z",fill:"none"}),l.createElement("path",{d:"M19 8H5c-1.66 0-3 1.34-3 3v6h4v4h12v-4h4v-6c0-1.66-1.34-3-3-3zm-3 11H8v-5h8v5zm3-7c-.55 0-1-.45-1-1s.45-1 1-1 1 .45 1 1-.45 1-1 1zm-1-9H6v4h12V3z"})),S("CS_COMMON_PRINT_RECEIPT")),"TL"==O?l.createElement("div",{className:"primary-label-btn d-grid",style:{marginLeft:"unset"},onClick:function(){try{const e=Digit.ULBService.getCurrentTenantId(),t=Digit.ULBService.getStateId();return Promise.resolve(Digit.TLService.search({applicationNumber:T,tenantId:e})).then(function(e){const n=function(){if(e)return Promise.resolve(Digit.PaymentService.generatePdf(t,{Licenses:null==e?void 0:e.Licenses},"tlcertificate")).then(function(e){return Promise.resolve(Digit.PaymentService.printReciept(t,{fileStoreIds:e.filestoreIds[0]})).then(function(t){window.open(t[e.filestoreIds[0]],"_blank")})})}();if(n&&n.then)return n.then(function(){})})}catch(e){return Promise.reject(e)}}},l.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",height:"24",viewBox:"0 0 24 24",width:"24"},l.createElement("path",{d:"M0 0h24v24H0z",fill:"none"}),l.createElement("path",{d:"M19 8H5c-1.66 0-3 1.34-3 3v6h4v4h12v-4h4v-6c0-1.66-1.34-3-3-3zm-3 11H8v-5h8v5zm3-7c-.55 0-1-.45-1-1s.45-1 1-1 1 .45 1 1-.45 1-1 1zm-1-9H6v4h12V3z"})),S("CS_COMMON_PRINT_CERTIFICATE")):null,"BPA_OC"!==(null==L||null===(u=L[0])||void 0===u?void 0:u.businessService)||"APPROVED"!==(null==L||null===(c=L[0])||void 0===c?void 0:c.status)&&"PENDING_SANC_FEE_PAYMENT"!==(null==L||null===(d=L[0])||void 0===d?void 0:d.status)?null:l.createElement("div",{className:"primary-label-btn d-grid",style:{marginLeft:"unset"},onClick:e=>x("occupancy-certificate")},l.createElement(t.DownloadPrefixIcon,null),S("BPA_OC_CERTIFICATE")),"BPA_LOW"===(null==L||null===(m=L[0])||void 0===m?void 0:m.businessService)?l.createElement("div",{className:"primary-label-btn d-grid",style:{marginLeft:"unset"},onClick:e=>x("buildingpermit-low")},l.createElement(t.DownloadPrefixIcon,null),S("BPA_PERMIT_ORDER")):null,"BPA"!==(null==L||null===(E=L[0])||void 0===E?void 0:E.businessService)||"BPA_LOW"===(null==L||null===(v=L[0])||void 0===v?void 0:v.businessService)||"BPA_OC"===(null==L||null===(p=L[0])||void 0===p?void 0:p.businessService)||"PENDING_SANC_FEE_PAYMENT"!==(null==L||null===(_=L[0])||void 0===_?void 0:_.status)&&"APPROVED"!==(null==L||null===(f=L[0])||void 0===f?void 0:f.status)?null:l.createElement("div",{className:"primary-label-btn d-grid",style:{marginLeft:"unset"},onClick:e=>x("buildingpermit")},l.createElement(t.DownloadPrefixIcon,null),S("BPA_PERMIT_ORDER"))):null),k?l.createElement(t.ActionBar,{style:{display:"flex",justifyContent:"flex-end",alignItems:"baseline"}},g?l.createElement(t.Menu,{localeKeyPrefix:"ES_COMMON",options:R,t:S,onSelect:function(e){A(e),h(!1)}}):null,l.createElement(t.SubmitBar,{label:S("ES_COMMON_TAKE_ACTION"),onSubmit:()=>h(!g)})):l.createElement(t.ActionBar,{style:{display:"flex",justifyContent:"flex-end",alignItems:"baseline"}},l.createElement(o.Link,{to:"/digit-ui/employee"},l.createElement(t.SubmitBar,{label:S("CORE_COMMON_GO_TO_HOME")}))))},vt=e=>{e.setLink("Response");const{t:n}=a.useTranslation(),{consumerCode:i}=o.useParams();return l.createElement(l.Fragment,null,l.createElement(t.Card,null,l.createElement(t.Banner,{message:n("ES_PAYMENT_COLLECTED_ERROR"),complaintNumber:i,successful:!1}),l.createElement(t.CardText,null,n("ES_PAYMENT_FAILED_DETAILS"))),l.createElement(t.ActionBar,{style:{display:"flex",justifyContent:"flex-end",alignItems:"baseline"}},l.createElement(o.Link,{to:"/digit-ui/employee"},l.createElement(t.SubmitBar,{label:n("CORE_COMMON_GO_TO_HOME")}))))},pt={a:["1","2","3"],b:["4","5","6"],c:["7","8","9"],j:["10","11","12"],k:["22","45"],l:["456"]},_t=e=>{const{stateCode:i}=e,{moduleName:r,pageName:s}=o.useParams(),{t:u}=a.useTranslation(),[c,d]=n.useState(""),[m,E]=n.useState(""),{data:v,isLoading:p}=Digit.Hooks.dss.useMDMS(i,"common-masters",["uiCommonConstants"],{select:e=>{var t,n;return(null==e||null===(t=e["common-masters"])||void 0===t||null===(n=t.uiCommonConstants)||void 0===n?void 0:n[0])||{}},enabled:!0});return n.useEffect(()=>{var e,t;const n=(null==v||null===(e=v[r])||void 0===e||null===(t=e["iframe-routes"])||void 0===t?void 0:t[s])||{},l=(null==n?void 0:n.isOrigin)?"development"===process.env.NODE_ENV?"https://qa.digit.org":document.location.origin:null==n?void 0:n.domain,a=(null==n?void 0:n.title)||"";d(""+l+((null==n?void 0:n.routePath)||"")),E(a)},[v,r,s]),p?l.createElement(t.Loader,null):c?l.createElement(l.Fragment,null,l.createElement(t.Header,null,u(m)),l.createElement("div",{className:"app-iframe-wrapper"},l.createElement("iframe",{src:c,title:m,className:"app-iframe"}))):l.createElement("div",null,"No Iframe To Load")};u.subFormRegistry.addSubForm("testForm",{addedFields:[],middlewares:[{middleWare_1:function(e,t,n){try{return e.a="a",Promise.resolve(n(e))}catch(e){return Promise.reject(e)}}},{middleWare_2:function(e,t,n){try{return e.b="b",Promise.resolve(n(e))}catch(e){return Promise.reject(e)}}},{middleWare_3:function(e,t,n){try{function l(){return Promise.resolve(n(e))}e.c="c";const t=function(){if("b"===e.b){const t=h(function(){return Promise.resolve(window.fetch("https://ifsc.razorpay.com/hdfc0000090")).then(function(t){const n=function(){if(t.ok)return Promise.resolve(t.json()).then(function(t){let{BANK:n}=t;e.BANKFROMMiddleWare=n});alert("Wrong IFSC Code")}();if(n&&n.then)return n.then(function(){})})},function(){alert("Something Went Wrong !")});if(t&&t.then)return t.then(function(){})}}();return Promise.resolve(t&&t.then?t.then(l):l())}catch(e){return Promise.reject(e)}}}],state:{firstDDoptions:["a","b","c"],secondDDoptions:pt.a,thirdDDoptions:["d","e","f"]},fields:[{label:"first",name:"pehla",defaultValue:"b",customProps:e=>({isMendatory:!0,option:e.firstDDoptions}),component:(e,n)=>l.createElement(t.Dropdown,c({select:t=>{e.setState({secondDDoptions:pt[t]}),e.setValue("doosra",""),e.onChange(t)},selected:e.value},n)),validations:{}},{label:"second",name:"doosra",customProps:e=>({isMendatory:!0,option:e.secondDDoptions}),defaultValue:e=>e.secondDDoptions[1],component:(e,n)=>l.createElement(t.Dropdown,c({select:t=>{e.onChange(t)},selected:e.value},n))},{label:"third",name:"teesra",customProps:e=>({isMendatory:!0,option:e.thirdDDoptions}),defaultValue:"d",component:(e,n)=>l.createElement(t.Dropdown,c({select:t=>{e.onChange(t)},selected:e.value},n))},{label:"IFSC",name:"ifsc",customProps:{isMendatory:!0,setBankDetailsFromIFSC:function(e){try{const t=h(function(){return Promise.resolve(window.fetch("https://ifsc.razorpay.com/"+e.getValues("ifsc"))).then(function(t){const n=function(){if(t.ok)return Promise.resolve(t.json()).then(function(t){let{BANK:n,BRANCH:l}=t;e.setValue("bank",n),e.setValue("branch",l)});alert("Wrong IFSC Code")}();if(n&&n.then)return n.then(function(){})})},function(){alert("Something Went Wrong !")});return Promise.resolve(t&&t.then?t.then(function(){}):void 0)}catch(e){return Promise.reject(e)}}},defaultValue:"",component:(e,n)=>l.createElement("div",{className:"ifsc-field"},l.createElement("input",{value:e.value,type:"text",onChange:t=>{e.setState({ifsc:t.target.value}),e.onChange(t.target.value)}}),l.createElement("button",{type:"button",onClick:()=>{n.setBankDetailsFromIFSC(e)}},l.createElement(t.SearchIconSvg,null)))},{label:"Bank",name:"bank",defaultValue:"d",component:(e,t)=>l.createElement("input",{readOnly:!0,value:e.value})},{label:"Branch",name:"branch",defaultValue:"d",component:(e,t)=>l.createElement("input",{readOnly:!0,value:e.value})}]});const ft=e=>{var t,i,r,s;let{stateCode:u,cityCode:d,moduleCode:m}=e;const{path:E}=o.useRouteMatch(),{t:v}=a.useTranslation(),[p,_]=n.useState(null),f={stateCode:u,cityCode:d,moduleCode:m,setLink:_},y=(null===(t=location)||void 0===t||null===(i=t.pathname)||void 0===i?void 0:i.includes("fsm"))||(null===(r=location)||void 0===r||null===(s=r.pathname)||void 0===s?void 0:s.includes("FSM"));return l.createElement(l.Fragment,null,l.createElement("p",{className:"breadcrumb",style:{marginLeft:"15px"}},l.createElement(o.Link,{to:"/digit-ui/employee"},v("ES_COMMON_HOME")),y?l.createElement(o.Link,{to:"/digit-ui/employee/fsm/home"},"/ ",v("ES_TITLE_FSM")," "):null,y?l.createElement(o.Link,{to:"/digit-ui/employee/fsm/inbox"},"/ ",v("ES_TITLE_INBOX")):null,"/ ",p),l.createElement(o.Switch,null,l.createElement(o.Route,{path:E+"/collect/:businessService/:consumerCode"},l.createElement(mt,c({},f,{basePath:E}))),l.createElement(o.Route,{path:E+"/success/:businessService/:receiptNumber/:consumerCode"},l.createElement(Et,f)),l.createElement(o.Route,{path:E+"/integration/:moduleName/:pageName"},l.createElement(_t,f)),l.createElement(o.Route,{path:E+"/failure"},l.createElement(vt,f))))},yt={getBillDetailsConfigWithBusinessService:(e,t)=>{switch(null==e?void 0:e.toLowerCase().split(".")[0]){case"pt":return{"my-bill":[{keyValue:"CS_COMMON_AMOUNT_DUE",keyPath:[e=>{var n;const a=(new Date).getTime()-new Date(null===(n=e.billDetails[0])||void 0===n?void 0:n.toPeriod).getTime(),o=Math.floor(a/864e5);return l.createElement(l.Fragment,null,"â‚¹"+e.totalAmount,o>=0?l.createElement("span",{className:"card-label-error",style:{fontSize:"16px",fontWeight:"normal"}}," ( "+t("CS_PAYMENT_OVERDUE")+" "+o+" "+t(1===o?"CS_COMMON_DAY":"CS_COMMON_DAYS")+")"):null)}],fallback:"N/A",noteStyle:{fontWeight:"bold",fontSize:"24px",paddingTop:"5px"}},{keyValue:"PT_PROPERTY_ID",keyPath:["propertyId"],fallback:""},{keyValue:"CS_OWNER_NAME",keyPath:["owners",0,"name"],fallback:"ES_TITLE_FSM"},{keyValue:"PT_PROPERTY_ADDRESS",keyPath:["address","locality","name"],fallback:"CS_APPLICATION_TYPE_DESLUDGING"},{keyValue:"CS_PAYMENT_BILLING_PERIOD",keyPath:["billDetails",e=>{const{fromPeriod:t,toPeriod:n}=e[0];return t&&n?"FY "+new Date(t).getFullYear().toString()+"-"+new Date(n).getFullYear().toString():"N/A"}],fallback:"N/A"},{keyValue:"PT_DUE_DATE",keyPath:["billDetails",e=>{var t,n;if(null===(t=e[0])||void 0===t||!t.toPeriod)return"N/A";const l=new Date(null===(n=e[0])||void 0===n?void 0:n.toPeriod),a=Digit.Utils.date.monthNames[l.getMonth()];return l.getDate()+" "+a+" "+l.getFullYear()}],fallback:"N/A"}],response:[]};case"fsm":return{"my-bill":[{keyValue:"CS_COMMON_AMOUNT_DUE",keyPath:["totalAmount",e=>e.toFixed(2),e=>"â‚¹"+e],fallback:"N/A",noteStyle:{fontWeight:"bold",fontSize:"24px",paddingTop:"5px"}}],response:[]}}}};exports.PaymentLinks=e=>(a.useTranslation(),null),exports.PaymentModule=e=>{let{deltaConfig:n={},stateCode:a,cityCode:i,moduleCode:r="Payment",userType:s}=e;const{path:u,url:c}=o.useRouteMatch();return 0===Object.keys({data:{}}).length?l.createElement(t.Loader,null):l.createElement(l.Fragment,null,"citizen"===s?l.createElement(D,{stateCode:a,moduleCode:r,cityCode:i,path:u,url:c}):l.createElement(ft,{stateCode:a,cityCode:i,moduleCode:r}))},exports.paymentConfigs=yt;
