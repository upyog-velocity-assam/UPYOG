function e(e){return e&&"object"==typeof e&&"default"in e?e.default:e}var n=require("react"),l=e(n),a=require("react-router-dom"),o=require("react-i18next"),r=require("@egovernments/digit-ui-react-components"),i=require("redux"),s=require("react-redux"),c=e(require("lodash.merge")),u=require("react-hook-form"),m=require("react-query");function d(e,t){switch(void 0===e&&(e={}),t.type){case"CREATE_COMPLAINT":return{...e,response:t.payload};case"FETCH_COMPLAINTS":return{...e,list:t.payload.complaints};case"UPDATE_COMPLAINT":return{...e,response:t.payload};case"APPLY_INBOX_FILTER":return{...e,response:t.payload.response.instances};default:return e}}const p=(e,t)=>""+e.path+t,E=e=>{const t=a.useHistory(),{t:i}=o.useTranslation(),{id:s}=a.useParams(),[c,u]=n.useState(null),[m,d]=n.useState(!0);return l.createElement(r.Card,null,l.createElement(r.CardHeader,null,i("CS_REOPEN_COMPLAINT")),l.createElement(r.CardText,null),m?null:l.createElement(r.CardLabelError,null,i("CS_ADDCOMPLAINT_ERROR_REOPEN_REASON")),l.createElement(r.RadioButtons,{onSelect:e=>{let t=Digit.SessionStorage.get("reopen."+s);Digit.SessionStorage.set("reopen."+s,{...t,reason:e}),u(e)},selectedOption:c,options:[i("CS_REOPEN_OPTION_ONE"),i("CS_REOPEN_OPTION_TWO"),i("CS_REOPEN_OPTION_THREE"),i("CS_REOPEN_OPTION_FOUR")]}),l.createElement(r.SubmitBar,{label:i("CS_COMMON_NEXT"),onSubmit:function(){null===c?d(!1):t.push(e.match.path+"/upload-photo/"+s)}}))},C=e=>{var t,i;const{t:s}=o.useTranslation(),c=a.useHistory();let{id:u}=a.useParams();const[m,d]=n.useState(null),[p,E]=n.useState(!0);return n.useEffect(()=>{let e=Digit.SessionStorage.get("reopen."+u);Digit.SessionStorage.set("reopen."+u,{...e,verificationDocuments:m})},[m,u]),l.createElement(l.Fragment,null,l.createElement(r.Card,null,l.createElement(r.ImageUploadHandler,{header:s("CS_ADDCOMPLAINT_UPLOAD_PHOTO"),tenantId:null==e||null===(t=e.complaintDetails)||void 0===t||null===(i=t.service)||void 0===i?void 0:i.tenantId,cardText:"",onPhotoChange:e=>{(e=>{if(null!=e&&e.length){const t=e.map(e=>({documentType:"PHOTO",fileStoreId:e,documentUid:"",additionalDetails:{}}));d(t)}})(e)},uploadedImages:null}),p?null:l.createElement(r.CardLabelError,null,s("CS_ADDCOMPLAINT_UPLOAD_ERROR_MESSAGE")),l.createElement(r.SubmitBar,{label:s("PT_COMMONS_NEXT"),onSubmit:function(){null===m?E(!1):c.push(e.match.path+"/addional-details/"+u)}}),e.skip?l.createElement(r.LinkButton,{label:s("CORE_COMMON_SKIP_CONTINUE"),onClick:function(){c.push(e.match.path+"/addional-details/"+u)}}):null))},S=e=>{let{cityCode:t,complaintType:n,description:l,landmark:a,city:o,district:r,region:i,state:s,pincode:c,localityCode:u,localityName:m,uploadedImages:d,mobileNumber:p,name:E}=e;return function(e,C){try{return Promise.resolve(Digit.Complaint.create({cityCode:t,complaintType:n,description:l,landmark:a,city:o,district:r,region:i,state:s,pincode:c,localityCode:u,localityName:m,uploadedImages:d,mobileNumber:p,name:E})).then(function(t){e({type:"CREATE_COMPLAINT",payload:t})})}catch(e){return Promise.reject(e)}}},_=e=>function(t){try{return Promise.resolve(Digit.PGRService.update(e)).then(function(e){t({type:"UPDATE_COMPLAINT",payload:e})})}catch(e){return Promise.reject(e)}},O=e=>{const t=a.useHistory();let{id:i}=a.useParams();const c=s.useDispatch(),u=s.useSelector(e=>e).common;let{t:m}=o.useTranslation();const{complaintDetails:d}=e;n.useEffect(()=>{if(u.complaints){const{response:n}=u.complaints;n&&"successful"===n.responseInfo.status&&t.push(e.match.path+"/response/:"+i)}},[u.complaints,e.history]);const p=n.useCallback(function(n){try{return Promise.resolve(c(_(n))).then(function(){t.push(e.match.path+"/response/"+i)})}catch(e){return Promise.reject(e)}},[c]);return l.createElement(l.Fragment,null,l.createElement(r.Card,null,l.createElement(r.CardHeader,null,m("CS_ADDCOMPLAINT_PROVIDE_ADDITIONAL_DETAILS")),l.createElement(r.CardText,null,m("CS_ADDCOMPLAINT_ADDITIONAL_DETAILS_TEXT")),l.createElement(r.TextArea,{name:"AdditionalDetails",onChange:function(e){let t=Digit.SessionStorage.get("reopen."+i);Digit.SessionStorage.set("reopen."+i,{...t,addtionalDetail:e.target.value})}}),l.createElement("div",{onClick:function(){let t=Digit.SessionStorage.get("reopen."+i);return d&&(d.workflow=((e,t)=>({action:"REOPEN",comments:e.addtionalDetail,assignes:[],verificationDocuments:e.verificationDocuments}))(t),d.service.additionalDetail={REOPEN_REASON:t.reason},p({service:d.service,workflow:d.workflow})),l.createElement(a.Redirect,{to:{pathname:e.parentRoute+"/response",state:{complaintDetails:d}}})}},l.createElement(r.SubmitBar,{label:m("CS_HEADER_REOPEN_COMPLAINT")}))))},f=e=>{let{action:t}=e;const{t:n}=o.useTranslation();switch(t){case"REOPEN":return n("CS_COMMON_COMPLAINT_REOPENED");case"RATE":return n("CS_COMMON_THANK_YOU");default:return n("CS_COMMON_COMPLAINT_SUBMITTED")}},T=e=>{let{response:t}=e;const{complaints:n}=t,{t:a}=o.useTranslation();return l.createElement(r.Banner,n&&n.response&&n.response.responseInfo?{message:f(n.response.ServiceWrappers[0].workflow),complaintNumber:n.response.ServiceWrappers[0].service.serviceRequestId,successful:!0}:{message:a("CS_COMMON_COMPLAINT_NOT_SUBMITTED"),successful:!1})},v=e=>{let{response:t}=e;const{complaints:n}=t,{t:a}=o.useTranslation();if(n&&n.response&&n.response.responseInfo){const{action:e}=n.response.ServiceWrappers[0].workflow;return l.createElement(r.CardText,null,a("RATE"===e?"CS_COMMON_RATING_SUBMIT_TEXT":"CS_COMMON_TRACK_COMPLAINT_TEXT"))}},g=e=>{const{t:t}=o.useTranslation(),n=s.useSelector(e=>e).pgr;return l.createElement(r.Card,null,n.complaints.response&&l.createElement(T,{response:n}),n.complaints.response&&l.createElement(v,{response:n}),l.createElement(a.Link,{to:"/digit-ui/citizen"},l.createElement(r.SubmitBar,{label:t("CORE_COMMON_GO_TO_HOME")})))},N=e=>{var t;let{match:n,parentRoute:o}=e;const r=window.location.pathname.split("/"),i=r[r.length-1],s=(null===(t=Digit.SessionStorage.get("CITIZEN.COMMON.HOME.CITY"))||void 0===t?void 0:t.code)||Digit.ULBService.getCurrentTenantId(),c=Digit.Hooks.pgr.useComplaintDetails({tenantId:s,id:i}).complaintDetails;return l.createElement(a.Switch,null,l.createElement(a.Route,{exact:!0,path:p(n,"/:id"),component:()=>l.createElement(E,{match:n,complaintDetails:c})}),l.createElement(a.Route,{path:p(n,"/upload-photo/:id"),component:()=>l.createElement(C,{match:n,skip:!0,complaintDetails:c})}),l.createElement(a.Route,{path:p(n,"/addional-details/:id"),component:()=>l.createElement(O,{match:n,parentRoute:o,complaintDetails:c})}),l.createElement(a.Route,{path:p(n,"/response"),component:()=>l.createElement(g,{match:n})}))},y=e=>{let{action:t}=e;const{t:n}=o.useTranslation();switch(t){case"REOPEN":return n("CS_COMMON_COMPLAINT_REOPENED");case"RATE":return n("CS_COMMON_THANK_YOU");default:return n("CS_COMMON_COMPLAINT_SUBMITTED")}},h=e=>{let{response:n}=e;const{complaints:a}=n;return l.createElement(r.Banner,a&&a.response&&a.response.responseInfo?{message:y(a.response.ServiceWrappers[0].workflow),complaintNumber:a.response.ServiceWrappers[0].service.serviceRequestId,successful:!0}:{message:t("CS_COMMON_COMPLAINT_NOT_SUBMITTED"),successful:!1})},M=e=>{const{t:t}=o.useTranslation(),n=s.useSelector(e=>e).pgr;return l.createElement(r.Card,null,n.complaints.response&&l.createElement(h,{response:n}),l.createElement(r.CardText,null,t("CS_COMMON_TRACK_COMPLAINT_TEXT")),l.createElement(a.Link,{to:"/digit-ui/citizen"},l.createElement(r.SubmitBar,{label:t("CORE_COMMON_GO_TO_HOME")})))};function I(){return(I=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var l in n)Object.prototype.hasOwnProperty.call(n,l)&&(e[l]=n[l])}return e}).apply(this,arguments)}const A={routes:{"complaint-type":{component:e=>{let{t:t,config:a,onSelect:o,value:i}=e;const[s,c]=n.useState(()=>{const{complaintType:e}=i;return e||{}}),u=a.texts,m=Digit.Hooks.pgr.useComplaintTypes({stateCode:Digit.ULBService.getCurrentTenantId()});return l.createElement(r.TypeSelectCard,I({},u,{menu:m,optionsKey:"name",selected:function(e){c(e)},selectedOption:s,onSave:()=>{o({complaintType:s})},t:t,disabled:0===Object.keys(s).length||null===s}))},texts:{headerCaption:"",header:"CS_ADDCOMPLAINT_COMPLAINT_TYPE_PLACEHOLDER",cardText:"CS_COMPLAINT_TYPE_TEXT",submitBarLabel:"CS_COMMON_NEXT"},nextStep:"sub-type"},"sub-type":{component:e=>{let{t:t,config:a,onSelect:o,value:i}=e;const[s,c]=n.useState(()=>{const{subType:e}=i;return e||{}}),{complaintType:u}=i,m=Digit.Hooks.pgr.useComplaintSubType(u,t),d={...a.texts,headerCaption:t("SERVICEDEFS."+u.key.toUpperCase()),menu:m,optionsKey:"name",selected:function(e){c(e)},selectedOption:s,onSave:()=>{o({subType:s})}};return l.createElement(r.TypeSelectCard,I({},d,{disabled:0===Object.keys(s).length||null===s,t:t}))},texts:{header:"CS_ADDCOMPLAINT_COMPLAINT_SUBTYPE_PLACEHOLDER",cardText:"CS_COMPLAINT_SUBTYPE_TEXT",submitBarLabel:"CS_COMMON_NEXT"},nextStep:"map"},map:{component:e=>{let{onSelect:t,t:n}=e,a="";return l.createElement(r.LocationSearchCard,{header:n("CS_ADDCOMPLAINT_SELECT_GEOLOCATION_HEADER"),cardText:n("CS_ADDCOMPLAINT_SELECT_GEOLOCATION_TEXT"),nextText:n("CS_COMMON_NEXT"),skipAndContinueText:n("CS_COMMON_SKIP"),skip:()=>t(),onSave:()=>t({pincode:a}),onChange:e=>a=e})},nextStep:"pincode"},pincode:{component:e=>{let{t:t,config:a,onSelect:o,value:i}=e;const s=Digit.Hooks.pgr.useTenants(),[c,u]=n.useState(()=>{const{pincode:e}=i;return e});let m=!c;const[d,p]=n.useState(null);return l.createElement(r.FormStep,{t:t,config:a,onSelect:function(e){try{var t=s.find(t=>{var n;return null===(n=t.pincode)||void 0===n?void 0:n.find(t=>t==(null==e?void 0:e.pincode))});const n=function(){if(t)return Digit.SessionStorage.set("city_complaint",t),Promise.resolve(Digit.LocationService.getLocalities(t.code)).then(function(n){Digit.LocalityService.get(n.TenantBoundary[0]).filter(t=>{var n;return null===(n=t.pincode)||void 0===n?void 0:n.find(t=>t==e.pincode)}),o({...e,city_complaint:t})});Digit.SessionStorage.set("city_complaint",void 0),Digit.SessionStorage.set("selected_localities",void 0),p("CS_COMMON_PINCODE_NOT_SERVICABLE")}();return Promise.resolve(n&&n.then?n.then(function(){}):void 0)}catch(e){return Promise.reject(e)}},value:c,onChange:function(e){u(e.target.value),m=!e.target.value,p(null)},onSkip:()=>o(),forcedError:t(d),isDisabled:m})},texts:{headerCaption:"CS_ADDCOMPLAINT_COMPLAINT_LOCATION",header:"CS_FILE_APPLICATION_PINCODE_LABEL",cardText:"CS_ADDCOMPLAINT_CHANGE_PINCODE_TEXT",submitBarLabel:"CS_COMMON_NEXT",skipText:"CORE_COMMON_SKIP_CONTINUE"},inputs:[{label:"CORE_COMMON_PINCODE",type:"text",name:"pincode",validation:{minLength:6,maxLength:7},error:"CORE_COMMON_PINCODE_INVALID"}],nextStep:"address"},address:{component:e=>{let{t:t,config:a,onSelect:o,value:i}=e;const s=Digit.Hooks.pgr.useTenants(),c=null!=i&&i.pincode?s.filter(e=>{var t;return null==e||null===(t=e.pincode)||void 0===t?void 0:t.some(e=>e==i.pincode)}):s,[u,m]=n.useState(()=>{const{city_complaint:e}=i;return e||null}),{data:d}=Digit.Hooks.useBoundaryLocalities(null==u?void 0:u.code,"admin",{enabled:!!u},t),[p,E]=n.useState(null),[C,S]=n.useState(()=>{const{locality_complaint:e}=i;return e||null});function _(e){S(null),E(null),m(e)}function O(e){S(e)}return n.useEffect(()=>{if(u&&d){const{pincode:e}=i;let t=e?d.filter(t=>t.pincode==e):d;E(t)}},[u,d]),l.createElement(r.FormStep,{config:a,onSelect:function(){o({city_complaint:u,locality_complaint:C})},t:t,isDisabled:!C},l.createElement("div",null,l.createElement(r.CardLabel,null,t("MYCITY_CODE_LABEL")),(null==c?void 0:c.length)<5?l.createElement(r.RadioButtons,{selectedOption:u,options:c,optionsKey:"i18nKey",onSelect:_}):l.createElement(r.Dropdown,{isMandatory:!0,selected:u,option:c,select:_,optionKey:"i18nKey",t:t}),u&&p&&l.createElement(r.CardLabel,null,t("CS_CREATECOMPLAINT_MOHALLA")),u&&p&&l.createElement(l.Fragment,null,(null==p?void 0:p.length)<5?l.createElement(r.RadioButtons,{selectedOption:C,options:p,optionsKey:"i18nkey",onSelect:O}):l.createElement(r.Dropdown,{isMandatory:!0,selected:C,optionKey:"i18nkey",option:p,select:O,t:t}))))},texts:{headerCaption:"CS_ADDCOMPLAINT_COMPLAINT_LOCATION",header:"CS_ADDCOMPLAINT_PROVIDE_COMPLAINT_ADDRESS",cardText:"CS_ADDCOMPLAINT_CITY_MOHALLA_TEXT",submitBarLabel:"CS_COMMON_NEXT"},nextStep:"landmark"},landmark:{component:e=>{let{t:t,config:a,onSelect:o,value:i}=e;const[s,c]=n.useState(()=>{const{landmark:e}=i;return e||""});return l.createElement(r.FormStep,{config:a,value:s,onChange:function(e){c(e.target.value)},onSelect:e=>o(e),onSkip:()=>o(),t:t})},texts:{headerCaption:"CS_ADDCOMPLAINT_COMPLAINT_LOCATION",header:"CS_FILE_APPLICATION_PROPERTY_LOCATION_PROVIDE_LANDMARK_TITLE",cardText:"CS_FILE_APPLICATION_PROPERTY_LOCATION_PROVIDE_LANDMARK_TITLE_TEXT",submitBarLabel:"CS_COMMON_NEXT",skipText:"CORE_COMMON_SKIP_CONTINUE"},inputs:[{label:"CS_ADDCOMPLAINT_LANDMARK",type:"textarea",name:"landmark"}],nextStep:"upload-photos"},"upload-photos":{component:e=>{var t;let{t:a,config:o,onSelect:i,onSkip:s,value:c}=e;const[u,m]=n.useState(()=>{const{uploadedImages:e}=c;return e||null});return l.createElement(r.FormStep,{config:o,onSelect:()=>{if(!u||0===u.length)return s();i({uploadedImages:u})},onSkip:s,t:a},l.createElement(r.ImageUploadHandler,{tenantId:null===(t=c.city_complaint)||void 0===t?void 0:t.code,uploadedImages:u,onPhotoChange:e=>{m(e)}}))},texts:{header:"CS_ADDCOMPLAINT_UPLOAD_PHOTO",cardText:"CS_ADDCOMPLAINT_UPLOAD_PHOTO_TEXT",submitBarLabel:"CS_COMMON_NEXT",skipText:"CORE_COMMON_SKIP_CONTINUE"},nextStep:"additional-details"},"additional-details":{component:e=>{let{t:t,config:a,onSelect:o,value:i}=e;const[s,c]=n.useState(()=>{const{details:e}=i;return e||""});return l.createElement(r.FormStep,{config:a,onChange:e=>{const{value:t}=e.target;c(t)},onSelect:()=>o({details:s}),value:s,t:t})},texts:{header:"CS_ADDCOMPLAINT_PROVIDE_ADDITIONAL_DETAILS",cardText:"CS_ADDCOMPLAINT_ADDITIONAL_DETAILS_TEXT",submitBarLabel:"CS_COMMON_NEXT"},inputs:[{label:"CS_ADDCOMPLAINT_ADDITIONAL_DETAILS",type:"textarea",name:"details"}],nextStep:null}},indexRoute:"complaint-type"},P=e=>{let{data:t,path:n}=e,{serviceCode:i,serviceRequestId:s,applicationStatus:c}=t;const u=a.useHistory(),{t:m}=o.useTranslation(),d=["RESOLVED","REJECTED","CLOSEDAFTERREJECTION","CLOSEDAFTERRESOLUTION"];return l.createElement(l.Fragment,null,l.createElement(r.Card,{onClick:()=>{u.push(n+"/"+s)}},l.createElement(r.CardSubHeader,null,m("SERVICEDEFS."+i.toUpperCase())),l.createElement(r.DateWrap,{date:Digit.DateUtils.ConvertTimestampToDate(t.auditDetails.createdTime)}),l.createElement(r.KeyNote,{keyValue:m("CS_COMMON_COMPLAINT_NO"),note:s}),l.createElement("div",{className:"status-highlight "+(d.includes(c)?"success":"")},l.createElement("p",null,(d.includes(c)?m("CS_COMMON_CLOSED"):m("CS_COMMON_OPEN")).toUpperCase())),m("CS_COMMON_"+c)))};"undefined"!=typeof Symbol&&(Symbol.iterator||(Symbol.iterator=Symbol("Symbol.iterator"))),"undefined"!=typeof Symbol&&(Symbol.asyncIterator||(Symbol.asyncIterator=Symbol("Symbol.asyncIterator")));const D=e=>{let{name:t,isCompleted:n,mobile:a,text:i,customChild:s}=e,{t:c}=o.useTranslation();return l.createElement(r.CheckPoint,{label:c("CS_COMMON_PENDINGATLME"),isCompleted:n,customChild:l.createElement("div",null,t&&a?l.createElement(r.TelePhone,{mobile:a,text:i+" "+t}):null,s)})},L=e=>{let{isCompleted:t,text:n,customChild:a}=e;return l.createElement(r.CheckPoint,{isCompleted:t,label:n,customChild:a})},b=e=>{let{text:t,rating:n}=e;return l.createElement(r.Rating,{text:t,withText:!0,currentRating:n,maxRating:5,onFeedback:()=>{}})},R=e=>{let{action:t,nextActions:n,complaintDetails:i,ComplainMaxIdleTime:s=36e5,serviceRequestId:c,reopenDate:u,isCompleted:m,customChild:d}=e;const{t:p}=o.useTranslation();if("RESOLVE"===t){let e=n&&n.map((e,t)=>{if(e&&"COMMENT"!==e)return l.createElement(a.Link,{key:t,to:"/digit-ui/citizen/pgr/"+e.toLowerCase()+"/"+c},l.createElement(r.ActionLinks,null,p("CS_COMMON_"+e)))});return l.createElement(r.CheckPoint,{isCompleted:m,label:p("CS_COMMON_COMPLAINT_RESOLVED"),customChild:l.createElement("div",null,e,d)})}if("RATE"===t)return l.createElement(r.CheckPoint,{isCompleted:m,label:p("CS_COMMON_COMPLAINT_RESOLVED"),customChild:l.createElement("div",null,d)});if("REOPEN"===t)return l.createElement(r.CheckPoint,{isCompleted:m,label:p("CS_COMMON_COMPLAINT_REOPENED"),info:u,customChild:d});{let e=n&&n.map((e,t)=>{var n,o;if(e&&"COMMENT"!==e&&("REOPEN"!==e||"REOPEN"===e&&(null===Date||void 0===Date?void 0:Date.now())-(null==i||null===(n=i.service)||void 0===n||null===(o=n.auditDetails)||void 0===o?void 0:o.lastModifiedTime)<s))return l.createElement(a.Link,{key:t,to:"/digit-ui/citizen/pgr/"+e.toLowerCase()+"/"+c},l.createElement(r.ActionLinks,null,p("CS_COMMON_"+e)))});return l.createElement(r.CheckPoint,{isCompleted:m,label:p("CS_COMMON_COMPLAINT_RESOLVED"),customChild:l.createElement("div",null,e,d)})}},k=e=>{let{action:t,nextActions:n,complaintDetails:i,ComplainMaxIdleTime:s=36e5,rating:c,serviceRequestId:u,reopenDate:m,isCompleted:d}=e;const{t:p}=o.useTranslation();if("REJECTED"===t){let e=n&&n.map((e,t)=>{if(e&&"COMMENT"!==e)return l.createElement(a.Link,{key:t,to:"/digit-ui/citizen/pgr/"+e.toLowerCase()+"/"+u},l.createElement(r.ActionLinks,null,p("CS_COMMON_"+e)))});return l.createElement(r.CheckPoint,{isCompleted:d,label:p("CS_COMMON_COMPLAINT_REJECTED"),customChild:l.createElement("div",null,e)})}if("RATE"===t&&c)return l.createElement(r.CheckPoint,{isCompleted:d,label:p("CS_COMMON_COMPLAINT_REJECTED"),customChild:l.createElement("div",null,c?l.createElement(b,{text:p("CS_ADDCOMPLAINT_YOU_RATED"),rating:c}):null,customChild)});if("REOPEN"===t)return l.createElement(r.CheckPoint,{isCompleted:d,label:p("CS_COMMON_COMPLAINT_REOPENED"),info:m});{let e=n&&n.map((e,t)=>{var n,o;if(e&&"COMMENT"!==e&&("REOPEN"!==e||"REOPEN"===e&&(null===Date||void 0===Date?void 0:Date.now())-(null==i||null===(n=i.service)||void 0===n||null===(o=n.auditDetails)||void 0===o?void 0:o.lastModifiedTime)<s))return l.createElement(a.Link,{key:t,to:"/digit-ui/citizen/pgr/"+e.toLowerCase()+"/"+u},l.createElement(r.ActionLinks,null,p("CS_COMMON_"+e)))});return l.createElement(r.CheckPoint,{isCompleted:d,label:p("CS_COMMON_COMPLAINT_REJECTED"),customChild:l.createElement("div",null,e)})}},x=e=>{let{data:t}=e;const{t:n}=o.useTranslation();return l.createElement("div",null,(null==t?void 0:t.date)&&l.createElement("p",null,null==t?void 0:t.date),l.createElement("p",null,null==t?void 0:t.name),l.createElement("p",null,null==t?void 0:t.mobileNumber),(null==t?void 0:t.source)&&l.createElement("p",null,n("ES_COMMON_FILED_VIA_"+(null==t?void 0:t.source.toUpperCase()))))},w=e=>{let{data:t,serviceRequestId:a,complaintWorkflow:i,rating:s,zoomImage:c,complaintDetails:u,ComplainMaxIdleTime:m}=e;const{t:d}=o.useTranslation();let{timeline:p}=t;const E=n.useMemo(()=>null==p?void 0:p.length,[p]);n.useEffect(()=>{null==p||p.filter((e,t,n)=>t===n.length-1&&"PENDINGFORASSIGNMENT"===e.status);const e=(null==p?void 0:p.filter(e=>"PENDINGFORASSIGNMENT"===(null==e?void 0:e.status))).at(-1);null==p||p.push({...e,performedAction:"FILED",status:"COMPLAINT_FILED"})},[p]);const C=e=>{var t;let{comment:a,thumbnailsToShow:o,auditDetails:i,assigner:s,status:m}=e;const p={date:null==i?void 0:i.lastModified,name:null==s?void 0:s.name,mobileNumber:null==s?void 0:s.mobileNumber,source:"COMPLAINT_FILED"==m?null==u?void 0:u.audit.source:""};return l.createElement(n.Fragment,null,a?l.createElement("div",null,null==a?void 0:a.map(e=>l.createElement("div",{className:"TLComments"},l.createElement("h3",null,d("WF_COMMON_COMMENTS")),l.createElement("p",null,e)))):null,(null==o||null===(t=o.thumbs)||void 0===t?void 0:t.length)>0?l.createElement("div",{className:"TLComments"},l.createElement("h3",null,d("CS_COMMON_ATTACHMENTS")),l.createElement(r.DisplayPhotos,{srcs:o.thumbs,onClick:(e,t)=>{!function(e,t,n){var l,a;let o=null===(l=n.thumbs)||void 0===l?void 0:l.findIndex(t=>t===e);c(o>-1&&(null==n||null===(a=n.fullImage)||void 0===a?void 0:a[o])||e)}(e,0,o)}})):null,null!=p&&p.date?l.createElement(x,{data:p,comments:a}):null)};return l.createElement(l.Fragment,null,l.createElement(r.CardSubHeader,null,d("CS_COMPLAINT_DETAILS_COMPLAINT_TIMELINE")),p&&E>0?l.createElement(r.ConnectingCheckPoints,null,p.map((e,t,n)=>{let{status:o,caption:c,auditDetails:p,timeLineActions:S,performedAction:_,wfComment:O,thumbnailsToShow:f,assigner:T}=e;return(e=>{let{status:t,caption:n,auditDetails:o,timeLineActions:c,index:p,comment:E,thumbnailsToShow:S,assigner:_,totalTimelineLength:O}=e;const f=0===p;switch(t){case"PENDINGFORREASSIGNMENT":return l.createElement(r.CheckPoint,{isCompleted:f,key:p,label:d("CS_COMMON_"+t),customChild:C({comment:E,thumbnailsToShow:S,auditDetails:o,assigner:_})});case"PENDINGFORASSIGNMENT":const e=O-(p+1)==0;return l.createElement(L,{key:p,isCompleted:f,text:d("CS_COMMON_"+t),customChild:C({comment:E,...e?{auditDetails:o}:{thumbnailsToShow:S,auditDetails:o}})});case"PENDINGFORASSIGNMENT_AFTERREOPEN":return l.createElement(L,{isCompleted:f,key:p,text:d("CS_COMMON_"+t),customChild:C({comment:E,thumbnailsToShow:S,auditDetails:o,assigner:_})});case"PENDINGATLME":let{name:T,mobileNumber:v}=n&&n.length>0?n[0]:{name:"",mobileNumber:""};const g=""+d("CS_COMMON_"+t);return l.createElement(D,{isCompleted:f,key:p,name:T,mobile:v,text:g,customChild:C({comment:E,thumbnailsToShow:S,auditDetails:o,assigner:_})});case"RESOLVED":return l.createElement(R,{key:p,isCompleted:f,action:i.action,nextActions:p<=1&&c,complaintDetails:u,ComplainMaxIdleTime:m,serviceRequestId:a,reopenDate:Digit.DateUtils.ConvertTimestampToDate(o.lastModifiedTime),customChild:C({comment:E,thumbnailsToShow:S,auditDetails:o,assigner:_})});case"REJECTED":return l.createElement(k,{key:p,isCompleted:f,action:i.action,nextActions:p<=1&&c,complaintDetails:u,ComplainMaxIdleTime:m,serviceRequestId:a,reopenDate:Digit.DateUtils.ConvertTimestampToDate(o.lastModifiedTime),customChild:C({comment:E,thumbnailsToShow:S,auditDetails:o,assigner:_})});case"CLOSEDAFTERRESOLUTION":return l.createElement(r.CheckPoint,{isCompleted:f,key:p,label:d("CS_COMMON_CS_COMMON_"+t),customChild:l.createElement("div",null,C({comment:E,thumbnailsToShow:S,auditDetails:o,assigner:_}),s?l.createElement(b,{text:d("CS_ADDCOMPLAINT_YOU_RATED"),rating:s}):null)});case"COMPLAINT_FILED":return l.createElement(r.CheckPoint,{isCompleted:f,key:p,label:d("CS_COMMON_COMPLAINT_FILED"),customChild:C({comment:E,auditDetails:o,assigner:_,status:t})});default:return l.createElement(r.CheckPoint,{isCompleted:f,key:p,label:d("CS_COMMON_"+t),customChild:C({comment:E,thumbnailsToShow:S,auditDetails:o,assigner:_,status:t})})}})({status:o,caption:c,auditDetails:p,timeLineActions:S,index:t,array:n,performedAction:_,comment:O,thumbnailsToShow:f,assigner:T,totalTimelineLength:E})})):l.createElement(r.Loader,null))},F=e=>{var t;let{complaintDetails:a,id:o,getWorkFlow:r,zoomImage:i}=e;const s=(null===(t=Digit.SessionStorage.get("CITIZEN.COMMON.HOME.CITY"))||void 0===t?void 0:t.code)||a.service.tenantId;let c=Digit.Hooks.useWorkflowDetails({tenantId:s,id:o,moduleCode:"PGR"});const{data:u}=Digit.Hooks.pgr.useMDMS.ComplainClosingTime(null==s?void 0:s.split(".")[0]);return n.useEffect(()=>{r(c.data)},[c.data]),n.useEffect(()=>{c.revalidate()},[]),!c.isLoading&&l.createElement(w,{data:c.data,serviceRequestId:o,complaintWorkflow:a.workflow,rating:a.audit.rating,zoomImage:i,complaintDetails:a,ComplainMaxIdleTime:u})},H=()=>{var e,t,n,i,s,c,u,m,d,p;const{t:E}=o.useTranslation(),{path:C,url:S,..._}=a.useRouteMatch(),O=a.useLocation(),f=null===(e=Digit)||void 0===e||null===(t=e.ComponentRegistryService)||void 0===t?void 0:t.getComponent("PGRCreateComplaintCitizen"),T=null===(n=Digit)||void 0===n||null===(i=n.ComponentRegistryService)||void 0===i?void 0:i.getComponent("PGRComplaintsList"),v=null===(s=Digit)||void 0===s||null===(c=s.ComponentRegistryService)||void 0===c?void 0:c.getComponent("PGRComplaintDetailsPage"),g=null===(u=Digit)||void 0===u||null===(m=u.ComponentRegistryService)||void 0===m?void 0:m.getComponent("PGRSelectRating"),y=null===(d=Digit)||void 0===d||null===(p=d.ComponentRegistryService)||void 0===p?void 0:p.getComponent("PGRResponseCitzen");return l.createElement(l.Fragment,null,l.createElement("div",{className:"pgr-citizen-wrapper"},!O.pathname.includes("/response")&&l.createElement(r.BackButton,null,E("CS_COMMON_BACK")),l.createElement(a.Switch,null,l.createElement(r.PrivateRoute,{path:C+"/create-complaint",component:f}),l.createElement(r.PrivateRoute,{path:C+"/complaints",exact:!0,component:T}),l.createElement(r.PrivateRoute,{path:C+"/complaints/:id*",component:v}),l.createElement(r.PrivateRoute,{path:C+"/reopen",component:()=>l.createElement(N,{match:{..._,url:S,path:C+"/reopen"},parentRoute:C})}),l.createElement(r.PrivateRoute,{path:C+"/rate/:id*",component:()=>l.createElement(g,{parentRoute:C})}),l.createElement(r.PrivateRoute,{path:C+"/response",component:()=>l.createElement(y,{match:{..._,url:S,path:C}})}))))},U=()=>{var e,t,i,s,c,u,m,d;const[p,E]=n.useState(!1),[C,S]=n.useState(!1),_=a.useRouteMatch(),{t:O}=o.useTranslation(),f={home:{content:O("CS_COMMON_HOME"),path:"/digit-ui/employee"},inbox:{content:O("CS_COMMON_INBOX"),path:_.url+"/inbox"},createComplaint:{content:O("CS_PGR_CREATE_COMPLAINT"),path:_.url+"/complaint/create"},complaintDetails:{content:O("CS_PGR_COMPLAINT_DETAILS"),path:_.url+"/complaint/details/:id"},response:{content:O("CS_PGR_RESPONSE"),path:_.url+"/response"}};let T=a.useLocation().pathname;const v=null===(e=Digit)||void 0===e||null===(t=e.ComponentRegistryService)||void 0===t?void 0:t.getComponent("PGRCreateComplaintEmp"),g=null===(i=Digit)||void 0===i||null===(s=i.ComponentRegistryService)||void 0===s?void 0:s.getComponent("PGRComplaintDetails"),N=null===(c=Digit)||void 0===c||null===(u=c.ComponentRegistryService)||void 0===u?void 0:u.getComponent("PGRInbox"),y=null===(m=Digit)||void 0===m||null===(d=m.ComponentRegistryService)||void 0===d?void 0:d.getComponent("PGRResponseEmp");return l.createElement(l.Fragment,null,l.createElement("div",{className:"ground-container"},!T.includes("/response")&&l.createElement(a.Switch,null,l.createElement(a.Route,{path:_.url+"/complaint/create",component:()=>l.createElement(r.BreadCrumb,{crumbs:[f.home,f.createComplaint]})}),l.createElement(a.Route,{path:_.url+"/complaint/details/:id",component:()=>l.createElement(r.BreadCrumb,{crumbs:[f.home,f.inbox,f.complaintDetails]})}),l.createElement(a.Route,{path:_.url+"/inbox",component:()=>l.createElement(r.BreadCrumb,{crumbs:[f.home,f.inbox]})}),l.createElement(a.Route,{path:_.url+"/response",component:l.createElement(r.BreadCrumb,{crumbs:[f.home,f.response]})})),l.createElement(a.Switch,null,l.createElement(a.Route,{path:_.url+"/complaint/create",component:()=>l.createElement(v,{parentUrl:_.url})}),l.createElement(a.Route,{path:_.url+"/complaint/details/:id*",component:()=>l.createElement(g,null)}),l.createElement(a.Route,{path:_.url+"/inbox",component:N}),l.createElement(a.Route,{path:_.url+"/response",component:y}))))},B=()=>l.createElement(r.EmployeeAppContainer,null,l.createElement(U,null)),G=()=>l.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"#FFFFFF"},l.createElement("path",{d:"M0 0h24v24H0V0z",fill:"none"}),l.createElement("path",{d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"})),j=e=>l.createElement("h1",{className:"heading-m"},e.label),$=e=>l.createElement("div",{className:"icon-bg-secondary",onClick:e.onClick},l.createElement(G,null)),V=e=>{let{data:t,comments:n}=e;const{t:a}=o.useTranslation();return l.createElement("div",null,(null==t?void 0:t.date)&&l.createElement("p",null,null==t?void 0:t.date),l.createElement("p",null,null==t?void 0:t.name),l.createElement("p",null,null==t?void 0:t.mobileNumber),(null==t?void 0:t.source)&&l.createElement("p",null,a("ES_COMMON_FILED_VIA_"+(null==t?void 0:t.source.toUpperCase()))),null==n?void 0:n.map(e=>l.createElement("div",{className:"TLComments"},l.createElement("h3",null,a("WF_COMMON_COMMENTS")),l.createElement("p",null,e))))},W=e=>{var t,a,o,i,s,c,u;let{workflowDetails:m,complaintDetails:d,close:p,popup:E,selectedAction:C,onAssign:S,tenantId:_,t:O}=e;const f=null==m||null===(t=m.data)||void 0===t||null===(a=t.initialActionState)||void 0===a||null===(o=a.nextActions)||void 0===o?void 0:o.filter(e=>(null==e?void 0:e.action)==C),T=Digit.Hooks.pgr.useEmployeeFilter(_,(null==f||null===(i=f[0])||void 0===i||null===(s=i.assigneeRoles)||void 0===s?void 0:s.length)>0?null==f||null===(c=f[0])||void 0===c||null===(u=c.assigneeRoles)||void 0===u?void 0:u.join(","):"",d),v=T?T.map(e=>({heading:e.department,options:e.employees})):null,[g,N]=n.useState(null),[y,h]=n.useState(""),[M,I]=n.useState(null),[A,P]=n.useState(null),[D,L]=n.useState(null),b=Digit.ULBService.getCurrentUlb(),[R,k]=n.useState(null);n.useEffect(()=>{!function(){try{L(null);const e=function(){if(M){const e=function(){if(M.size>=5242880)L(O("CS_MAXIMUM_UPLOAD_SIZE_EXCEEDED"));else{const e=function(e,t){try{var n=Promise.resolve(Digit.UploadServices.Filestorage("property-upload",M,b.code)).then(function(e){var t,n,l,a;(null==e||null===(t=e.data)||void 0===t||null===(n=t.files)||void 0===n?void 0:n.length)>0?P(null==e||null===(l=e.data)||void 0===l||null===(a=l.files[0])||void 0===a?void 0:a.fileStoreId):L(O("CS_FILE_UPLOAD_ERROR"))})}catch(e){return t()}return n&&n.then?n.then(void 0,t):n}(0,function(){L(O("CS_FILE_UPLOAD_ERROR"))});if(e&&e.then)return e.then(function(){})}}();if(e&&e.then)return e.then(function(){})}}();e&&e.then&&e.then(function(){})}catch(e){Promise.reject(e)}}()},[M]);const x=[O("CS_REOPEN_OPTION_ONE"),O("CS_REOPEN_OPTION_TWO"),O("CS_REOPEN_OPTION_THREE"),O("CS_REOPEN_OPTION_FOUR")];return l.createElement(r.Modal,{headerBarMain:l.createElement(j,{label:O("ASSIGN"===C||"REASSIGN"===C?"CS_ACTION_ASSIGN":"REJECT"===C?"CS_ACTION_REJECT":"REOPEN"===C?"CS_COMMON_REOPEN":"CS_COMMON_RESOLVE")}),headerBarEnd:l.createElement($,{onClick:()=>p(E)}),actionCancelLabel:O("CS_COMMON_CANCEL"),actionCancelOnSubmit:()=>p(E),actionSaveLabel:O("ASSIGN"===C||"REASSIGN"===C?"CS_COMMON_ASSIGN":"REJECT"===C?"CS_COMMON_REJECT":"REOPEN"===C?"CS_COMMON_REOPEN":"CS_COMMON_RESOLVE"),actionSaveOnSubmit:()=>{"REJECT"!==C||y?S(g,y,A):L(O("CS_MANDATORY_COMMENTS"))},error:D,setError:L},l.createElement(r.Card,null,"REJECT"===C||"RESOLVE"===C||"REOPEN"===C?null:l.createElement(l.Fragment,null,l.createElement(r.CardLabel,null,O("CS_COMMON_EMPLOYEE_NAME")),v&&l.createElement(r.SectionalDropdown,{selected:g,menuData:v,displayKey:"name",select:function(e){N(e)}})),"REOPEN"===C?l.createElement(l.Fragment,null,l.createElement(r.CardLabel,null,O("CS_REOPEN_COMPLAINT")),l.createElement(r.Dropdown,{selected:R,option:x,select:function(e){k(e)}})):null,l.createElement(r.CardLabel,null,O("CS_COMMON_EMPLOYEE_COMMENTS")),l.createElement(r.TextArea,{name:"comment",onChange:function(e){L(null),h(e.target.value)},value:y}),l.createElement(r.CardLabel,null,O("CS_ACTION_SUPPORTING_DOCUMENTS")),l.createElement(r.CardLabelDesc,null,O("CS_UPLOAD_RESTRICTIONS")),l.createElement(r.UploadFile,{id:"pgr-doc",accept:".jpg",onUpload:function(e){I(e.target.files[0])},onDelete:()=>{P(null)},message:A?"1 "+O("CS_ACTION_FILEUPLOADED"):O("CS_ACTION_NO_FILEUPLOADED")})))},z=e=>{const{register:t,handleSubmit:a,errors:i}=u.useForm(),{t:s}=o.useTranslation(),c=n.useMemo(()=>{var n;return null===(n=e.config)||void 0===n?void 0:n.map((e,n,a)=>l.createElement(l.Fragment,{key:n},l.createElement(r.CardSectionHeader,null,e.head),e.body.map((e,n)=>{var a;return l.createElement(l.Fragment,{key:n},i[e.populators.name]&&(null===(a=e.populators)||void 0===a||!a.validate||i[e.populators.validate])&&l.createElement(r.CardLabelError,null,e.populators.error),l.createElement(r.LabelFieldPair,null,l.createElement(r.CardLabel,null,e.label,e.isMandatory?" * ":null),l.createElement("div",{className:"field"},((e,n)=>{switch(e){case"text":return l.createElement("div",{className:"field-container"},n.componentInFront?n.componentInFront:null,l.createElement(r.TextInput,I({className:"field desktop-w-full"},n,{inputRef:t(n.validation)})));case"textarea":return l.createElement(r.TextArea,I({className:"field desktop-w-full",name:n.name||""},n,{inputRef:t(n.validation)}));default:return!1!==n.dependency?n:null}})(e.type,e.populators))))}),a.length-1===n?null:l.createElement(r.BreakLine,null)))},[e.config,i]),m=e.isDisabled||!1;return l.createElement("form",{onSubmit:a(function(t){e.onSubmit(t)})},l.createElement(r.Card,null,l.createElement(r.CardSubHeader,null,e.heading),c,e.children,l.createElement(r.ActionBar,null,l.createElement(r.SubmitBar,{disabled:m,label:s(e.label),submit:"submit"}))))},Y=e=>{const{t:t}=o.useTranslation(),i=[{text:"ES_PGR_NEW_COMPLAINT",link:"/digit-ui/employee/pgr/complaint/create",accessTo:["CSR"]}],[s,c]=n.useState([]);return n.useEffect(()=>{let e=[];i.forEach(t=>{t.accessTo?Digit.UserService.hasAccess(t.accessTo)&&e.push(t):e.push(t)}),c(e)},[]),l.createElement(r.Card,{className:"employeeCard filter inboxLinks"},l.createElement("div",{className:"complaint-links-container"},l.createElement("div",{className:"header"},l.createElement("span",{className:"logo"},l.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",height:"24",viewBox:"0 0 24 24",width:"24"},l.createElement("path",{d:"M0 0h24v24H0z",fill:"none"}),l.createElement("path",{d:"M20 2H4c-1.1 0-1.99.9-1.99 2L2 22l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm-7 9h-2V5h2v6zm0 4h-2v-2h2v2z",fill:"white"})))," ",l.createElement("span",{className:"text"},t("ES_PGR_HEADER_COMPLAINT"))),l.createElement("div",{className:"body"},s.map((e,n)=>{let{link:o,text:r}=e;return l.createElement("span",{className:"link",key:n},l.createElement(a.Link,{to:o},t(r)))}))))},K=e=>{let{t:t,columns:n,data:a,getCellProps:o,onNextPage:i,onPrevPage:s,currentPage:c,totalRecords:u,pageSizeLimit:m,onPageSizeChange:d}=e;return l.createElement(r.Table,{t:t,data:a,columns:n,getCellProps:o,onNextPage:i,onPrevPage:s,currentPage:c,totalRecords:u,onPageSizeChange:d,pageSizeLimit:m})},q=e=>{var t;let{complaints:n,onAssignmentChange:a,pgrfilters:i}=e;const{t:s}=o.useTranslation(),c=Digit.Hooks.pgr.useComplaintStatusCount(n);let u=null==i||null===(t=i.applicationStatus)||void 0===t?void 0:t.length;return l.createElement("div",{className:"status-container"},l.createElement("div",{className:"filter-label"},s("ES_PGR_FILTER_STATUS")),0===c.length&&l.createElement(r.Loader,null),c.map((e,t)=>l.createElement(r.CheckBox,{key:t,onChange:t=>a(t,e),checked:!!u&&0!==i.applicationStatus.filter(t=>t.code===e.code).length,label:e.name+" ("+(e.count||0)+")"})))};let X={},J={};const Z=e=>{var t,a,i,s,c,u,m;let{uuid:d}=Digit.UserService.getUser().info;const{searchParams:p}=e,{t:E}=o.useTranslation(),C=!(null==p||null===(t=p.filters)||void 0===t||null===(a=t.wfFilters)||void 0===a||!a.assignee||null==p||null===(i=p.filters)||void 0===i||null===(s=i.wfFilters)||void 0===s||null===(c=s.assignee[0])||void 0===c||!c.code),S=n.useMemo(()=>[{code:"ASSIGNED_TO_ME",name:E("ASSIGNED_TO_ME")},{code:"ASSIGNED_TO_ALL",name:E("ASSIGNED_TO_ALL")}],[E]),[_,O]=n.useState(C?S[0]:S[1]);n.useEffect(()=>O(C?S[0]:S[1]),[E]);const[f,T]=n.useState(null),[v,g]=n.useState(null),[N,y]=n.useState((null==p||null===(u=p.filters)||void 0===u?void 0:u.pgrfilters)||{serviceCode:[],locality:[],applicationStatus:[]}),[h,M]=n.useState((null==p||null===(m=p.filters)||void 0===m?void 0:m.wfFilters)||{assignee:[{code:d}]}),I=Digit.ULBService.getCurrentTenantId(),{data:A}=Digit.Hooks.useBoundaryLocalities(I,"admin",{},E);let P=Digit.Hooks.pgr.useServiceDefs(I,"PGR");n.useEffect(()=>{var t;let n=0;for(const e in N)if(Array.isArray(N[e])){n+=N[e].length;let t=N[e].map(e=>e.code).join();var l;t?X[e]=t:null===(l=X)||void 0===l||delete l[e]}for(const e in h)if(Array.isArray(h[e])){let t=h[e].map(e=>e.code).join();t?J[e]=t:J={}}n+=(null==h||null===(t=h.assignee)||void 0===t?void 0:t.length)||0,"mobile"!==e.type&&R(),Digit.inboxFilterCount=n},[N,h]);const D=(e,t)=>e.filter(e=>e.code===t.code).length;n.useEffect(()=>{T(N.serviceCode.length>1?{i18nKey:N.serviceCode.length+" selected"}:N.serviceCode[0])},[N.serviceCode]),n.useEffect(()=>{g(N.locality.length>1?{name:N.locality.length+" selected"}:N.locality[0])},[N.locality]);const L=(e,t)=>{let n=N[t].filter((t,n)=>n!==e);y({...N,[t]:n})};function b(){y({serviceCode:[],locality:[],applicationStatus:[]}),M({assigned:[{code:[]}]}),X={},J={},O(""),T(null),g(null)}const R=()=>{e.onFilterChange({pgrQuery:X,wfQuery:J,wfFilters:h,pgrfilters:N})},k=function(e,t,n,a,o,i,s){return void 0===n&&(n=null),n=n||{[o]:" ",code:""},l.createElement("div",null,l.createElement("div",{className:"filter-label"},e),l.createElement(r.Dropdown,{option:t,selected:n,select:e=>a(e,s),optionKey:o}),l.createElement("div",{className:"tag-container"},N[s].length>0&&N[s].map((e,t)=>l.createElement(r.RemoveableTag,{key:t,text:e[o].slice(0,22)+" ...",onClick:()=>i(t,s)}))))};return l.createElement(l.Fragment,null,l.createElement("div",{className:"filter"},l.createElement("div",{className:"filter-card"},l.createElement("div",{className:"heading"},l.createElement("div",{className:"filter-label"},E("ES_COMMON_FILTER_BY"),":"),l.createElement("div",{className:"clearAll",onClick:b},E("ES_COMMON_CLEAR_ALL")),"desktop"===e.type&&l.createElement("span",{className:"clear-search",onClick:b},E("ES_COMMON_CLEAR_ALL")),"mobile"===e.type&&l.createElement("span",{onClick:e.onClose},l.createElement(r.CloseSvg,null))),l.createElement("div",null,l.createElement(r.RadioButtons,{onSelect:e=>{O(e),d="ASSIGNED_TO_ME"===e.code?d:"",M({...h,assignee:[{code:d}]})},selectedOption:_,optionsKey:"name",options:S}),l.createElement("div",null,k(E("CS_COMPLAINT_DETAILS_COMPLAINT_SUBTYPE"),P,f,function(e){const t={i18nKey:E("SERVICEDEFS."+e.serviceCode.toUpperCase()),code:e.serviceCode};D(N.serviceCode,t)||y({...N,serviceCode:[...N.serviceCode,t]})},"i18nKey",L,"serviceCode")),l.createElement("div",null,k(E("CS_PGR_LOCALITY"),A,v,function(e,t){D(N.locality,e)||y({...N,locality:[...N.locality,e]})},"i18nkey",L,"locality")),l.createElement(q,{complaints:e.complaints,onAssignmentChange:(e,t)=>{if(e.target.checked)y({...N,applicationStatus:[...N.applicationStatus,{code:t.code}]});else{const e=N.applicationStatus.filter(e=>e.code!==t.code);y({...N,applicationStatus:e})}},pgrfilters:N})))),l.createElement(r.ActionBar,null,"mobile"===e.type&&l.createElement(r.ApplyFilterBar,{labelLink:E("ES_COMMON_CLEAR_ALL"),buttonLink:E("ES_COMMON_FILTER"),onClear:b,onSubmit:function(){R(),e.onClose()}})))},Q=e=>{var t,a;let{onSearch:i,type:s,onClose:c,searchParams:m}=e;const[d,p]=n.useState((null==m||null===(t=m.search)||void 0===t?void 0:t.serviceRequestId)||""),[E,C]=n.useState((null==m||null===(a=m.search)||void 0===a?void 0:a.mobileNumber)||""),{register:S,errors:_,handleSubmit:O,reset:f}=u.useForm(),{t:T}=o.useTranslation();return l.createElement("form",{onSubmit:O(e=>{Object.keys(_).filter(e=>_[e]).length||(i(""!==e.serviceRequestId?{serviceRequestId:e.serviceRequestId}:""!==e.mobileNumber?{mobileNumber:e.mobileNumber}:{}),"mobile"===s&&c())}),style:{marginLeft:"24px"}},l.createElement(l.Fragment,null,l.createElement("div",{className:"search-container",style:{width:"auto"}},l.createElement("div",{className:"search-complaint-container"},"mobile"===s&&l.createElement("div",{className:"complaint-header"},l.createElement("h2",null," ",T("CS_COMMON_SEARCH_BY"),":"),l.createElement("span",{onClick:c},l.createElement(r.CloseSvg,null))),l.createElement("div",{className:"complaint-input-container",style:{display:"grid"}},l.createElement("span",{className:"complaint-input"},l.createElement(r.Label,null,T("CS_COMMON_COMPLAINT_NO"),"."),l.createElement(r.TextInput,{name:"serviceRequestId",value:d,onChange:function(e){p(e.target.value)},inputRef:S({pattern:/(?!^$)([^\s])/}),style:{marginBottom:"8px"}})),l.createElement("span",{className:"mobile-input"},l.createElement(r.Label,null,T("CS_COMMON_MOBILE_NO"),"."),l.createElement(r.TextInput,{name:"mobileNumber",value:E,onChange:function(e){C(e.target.value)},inputRef:S({pattern:/^[6-9]\d{9}$/})})),"desktop"===s&&l.createElement(r.SubmitBar,{style:{marginTop:32,marginLeft:"16px",width:"calc( 100% - 16px )"},label:T("ES_COMMON_SEARCH"),submit:!0,disabled:Object.keys(_).filter(e=>_[e]).length})),"desktop"===s&&l.createElement("span",{className:"clear-search"},l.createElement(r.LinkLabel,{className:"clear-search-label",onClick:function(){f(),i({}),p(""),C("")}},T("ES_COMMON_CLEAR_SEARCH"))))),"mobile"===s&&l.createElement(r.ActionBar,null,l.createElement(r.SubmitBar,{label:"Search",submit:!0}))))},ee=e=>{let{data:t,onFilterChange:n,onSearch:i,isLoading:s,searchParams:c,onNextPage:u,onPrevPage:m,currentPage:d,pageSizeLimit:p,onPageSizeChange:E,totalRecords:C}=e;const{t:S}=o.useTranslation(),_=e=>l.createElement("span",{className:"cell-text"},e),O=l.useMemo(()=>[{Header:S("CS_COMMON_COMPLAINT_NO"),Cell:e=>{let{row:t}=e;return l.createElement("div",null,l.createElement("span",{className:"link"},l.createElement(a.Link,{to:"/digit-ui/employee/pgr/complaint/details/"+t.original.serviceRequestId},t.original.serviceRequestId)),l.createElement("br",null),l.createElement("span",{className:"complain-no-cell-text"},S("SERVICEDEFS."+t.original.complaintSubType.toUpperCase())))}},{Header:S("WF_INBOX_HEADER_LOCALITY"),Cell:e=>{let{row:t}=e;return _(S(Digit.Utils.locale.getLocalityCode(t.original.locality,t.original.tenantId)))}},{Header:S("CS_COMPLAINT_DETAILS_CURRENT_STATUS"),Cell:e=>{let{row:t}=e;return _(S("CS_COMMON_"+t.original.status))}},{Header:S("WF_INBOX_HEADER_CURRENT_OWNER"),Cell:e=>{let{row:t}=e;return _(t.original.taskOwner)}},{Header:S("WF_INBOX_HEADER_SLA_DAYS_REMAINING"),Cell:e=>{let{row:t}=e;return l.createElement("span",(n=t.original.sla)<0?{className:"sla-cell-error"}:{className:"sla-cell-success"},n||"");var n}}],[S]);let f;return f=s?l.createElement(r.Loader,null):t&&0===t.length?l.createElement(r.Card,{style:{marginTop:20}},S("CS_MYCOMPLAINTS_NO_COMPLAINTS_EMPLOYEE").split("\\n").map((e,t)=>l.createElement("p",{key:t,style:{textAlign:"center"}},e))):t.length>0?l.createElement(K,{t:S,data:t,columns:O,getCellProps:e=>({style:{minWidth:e.column.Header===S("CS_COMMON_COMPLAINT_NO")?"240px":"",padding:"20px 18px",fontSize:"16px"}}),onNextPage:u,onPrevPage:m,totalRecords:C,onPageSizeChagne:E,currentPage:d,pageSizeLimit:p}):l.createElement(r.Card,{style:{marginTop:20}},S("CS_COMMON_ERROR_LOADING_RESULTS").split("\\n").map((e,t)=>l.createElement("p",{key:t,style:{textAlign:"center"}},e))),l.createElement("div",{className:"inbox-container"},l.createElement("div",{className:"filters-container"},l.createElement(Y,null),l.createElement("div",null,l.createElement(Z,{complaints:t,onFilterChange:n,type:"desktop",searchParams:c}))),l.createElement("div",{style:{flex:1}},l.createElement(Q,{onSearch:i,type:"desktop"}),l.createElement("div",{style:{marginTop:"24px",marginTop:"24px",marginLeft:"24px",flex:1}},f)))},te=e=>{let{data:t,onFilterChange:a,onSearch:i,serviceRequestIdKey:s,searchParams:c}=e;const{t:u}=o.useTranslation(),[m,d]=n.useState(!1),[p,E]=n.useState(null),[C,S]=n.useState(Digit.inboxFilterCount||1),_=e=>{"SEARCH"===e?E(l.createElement(Q,{type:"mobile",onClose:O,onSearch:i,searchParams:c})):"FILTER"===e&&E(l.createElement(Z,{complaints:t,onFilterChange:a,onClose:O,type:"mobile",searchParams:c})),d(!0)},O=()=>{d(!1),E(null)};let f;return f=t&&0===(null==t?void 0:t.length)?l.createElement(r.Card,{style:{marginTop:20}},u("CS_MYCOMPLAINTS_NO_COMPLAINTS_EMPLOYEE").split("\\n").map((e,t)=>l.createElement("p",{key:t,style:{textAlign:"center"}},e))):t&&(null==t?void 0:t.length)>0?l.createElement(r.DetailsCard,{data:t,serviceRequestIdKey:s,linkPrefix:"/digit-ui/employee/pgr/complaint/details/"}):l.createElement(r.Card,{style:{marginTop:20}},u("CS_COMMON_ERROR_LOADING_RESULTS").split("\\n").map((e,t)=>l.createElement("p",{key:t,style:{textAlign:"center"}},e))),l.createElement(l.Fragment,null,l.createElement("div",{className:"searchBox"},l.createElement(r.SearchAction,{text:"SEARCH",handleActionClick:()=>_("SEARCH")}),l.createElement(r.FilterAction,{filterCount:C,text:"FILTER",handleActionClick:()=>_("FILTER")})),f,m&&l.createElement(r.PopUp,null,l.createElement("div",{className:"popup-module"},p)))};function ne(e,t){return e(t={exports:{}},t.exports),t.exports}var le="function"==typeof Symbol&&Symbol.for,ae=le?Symbol.for("react.element"):60103,oe=le?Symbol.for("react.portal"):60106,re=le?Symbol.for("react.fragment"):60107,ie=le?Symbol.for("react.strict_mode"):60108,se=le?Symbol.for("react.profiler"):60114,ce=le?Symbol.for("react.provider"):60109,ue=le?Symbol.for("react.context"):60110,me=le?Symbol.for("react.async_mode"):60111,de=le?Symbol.for("react.concurrent_mode"):60111,pe=le?Symbol.for("react.forward_ref"):60112,Ee=le?Symbol.for("react.suspense"):60113,Ce=le?Symbol.for("react.suspense_list"):60120,Se=le?Symbol.for("react.memo"):60115,_e=le?Symbol.for("react.lazy"):60116,Oe=le?Symbol.for("react.block"):60121,fe=le?Symbol.for("react.fundamental"):60117,Te=le?Symbol.for("react.responder"):60118,ve=le?Symbol.for("react.scope"):60119;function ge(e){if("object"==typeof e&&null!==e){var t=e.$$typeof;switch(t){case ae:switch(e=e.type){case me:case de:case re:case se:case ie:case Ee:return e;default:switch(e=e&&e.$$typeof){case ue:case pe:case _e:case Se:case ce:return e;default:return t}}case oe:return t}}}function Ne(e){return ge(e)===de}var ye={AsyncMode:me,ConcurrentMode:de,ContextConsumer:ue,ContextProvider:ce,Element:ae,ForwardRef:pe,Fragment:re,Lazy:_e,Memo:Se,Portal:oe,Profiler:se,StrictMode:ie,Suspense:Ee,isAsyncMode:function(e){return Ne(e)||ge(e)===me},isConcurrentMode:Ne,isContextConsumer:function(e){return ge(e)===ue},isContextProvider:function(e){return ge(e)===ce},isElement:function(e){return"object"==typeof e&&null!==e&&e.$$typeof===ae},isForwardRef:function(e){return ge(e)===pe},isFragment:function(e){return ge(e)===re},isLazy:function(e){return ge(e)===_e},isMemo:function(e){return ge(e)===Se},isPortal:function(e){return ge(e)===oe},isProfiler:function(e){return ge(e)===se},isStrictMode:function(e){return ge(e)===ie},isSuspense:function(e){return ge(e)===Ee},isValidElementType:function(e){return"string"==typeof e||"function"==typeof e||e===re||e===de||e===se||e===ie||e===Ee||e===Ce||"object"==typeof e&&null!==e&&(e.$$typeof===_e||e.$$typeof===Se||e.$$typeof===ce||e.$$typeof===ue||e.$$typeof===pe||e.$$typeof===fe||e.$$typeof===Te||e.$$typeof===ve||e.$$typeof===Oe)},typeOf:ge},he=ne(function(e,t){"production"!==process.env.NODE_ENV&&function(){var e="function"==typeof Symbol&&Symbol.for,n=e?Symbol.for("react.element"):60103,l=e?Symbol.for("react.portal"):60106,a=e?Symbol.for("react.fragment"):60107,o=e?Symbol.for("react.strict_mode"):60108,r=e?Symbol.for("react.profiler"):60114,i=e?Symbol.for("react.provider"):60109,s=e?Symbol.for("react.context"):60110,c=e?Symbol.for("react.async_mode"):60111,u=e?Symbol.for("react.concurrent_mode"):60111,m=e?Symbol.for("react.forward_ref"):60112,d=e?Symbol.for("react.suspense"):60113,p=e?Symbol.for("react.suspense_list"):60120,E=e?Symbol.for("react.memo"):60115,C=e?Symbol.for("react.lazy"):60116,S=e?Symbol.for("react.block"):60121,_=e?Symbol.for("react.fundamental"):60117,O=e?Symbol.for("react.responder"):60118,f=e?Symbol.for("react.scope"):60119;function T(e){if("object"==typeof e&&null!==e){var t=e.$$typeof;switch(t){case n:var p=e.type;switch(p){case c:case u:case a:case r:case o:case d:return p;default:var S=p&&p.$$typeof;switch(S){case s:case m:case C:case E:case i:return S;default:return t}}case l:return t}}}var v=u,g=s,N=i,y=n,h=m,M=a,I=C,A=E,P=l,D=r,L=o,b=d,R=!1;function k(e){return T(e)===u}t.AsyncMode=c,t.ConcurrentMode=v,t.ContextConsumer=g,t.ContextProvider=N,t.Element=y,t.ForwardRef=h,t.Fragment=M,t.Lazy=I,t.Memo=A,t.Portal=P,t.Profiler=D,t.StrictMode=L,t.Suspense=b,t.isAsyncMode=function(e){return R||(R=!0,console.warn("The ReactIs.isAsyncMode() alias has been deprecated, and will be removed in React 17+. Update your code to use ReactIs.isConcurrentMode() instead. It has the exact same API.")),k(e)||T(e)===c},t.isConcurrentMode=k,t.isContextConsumer=function(e){return T(e)===s},t.isContextProvider=function(e){return T(e)===i},t.isElement=function(e){return"object"==typeof e&&null!==e&&e.$$typeof===n},t.isForwardRef=function(e){return T(e)===m},t.isFragment=function(e){return T(e)===a},t.isLazy=function(e){return T(e)===C},t.isMemo=function(e){return T(e)===E},t.isPortal=function(e){return T(e)===l},t.isProfiler=function(e){return T(e)===r},t.isStrictMode=function(e){return T(e)===o},t.isSuspense=function(e){return T(e)===d},t.isValidElementType=function(e){return"string"==typeof e||"function"==typeof e||e===a||e===u||e===r||e===o||e===d||e===p||"object"==typeof e&&null!==e&&(e.$$typeof===C||e.$$typeof===E||e.$$typeof===i||e.$$typeof===s||e.$$typeof===m||e.$$typeof===_||e.$$typeof===O||e.$$typeof===f||e.$$typeof===S)},t.typeOf=T}()}),Me=ne(function(e){e.exports="production"===process.env.NODE_ENV?ye:he}),Ie=Object.getOwnPropertySymbols,Ae=Object.prototype.hasOwnProperty,Pe=Object.prototype.propertyIsEnumerable;function De(e){if(null==e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}var Le=function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},n=0;n<10;n++)t["_"+String.fromCharCode(n)]=n;if("0123456789"!==Object.getOwnPropertyNames(t).map(function(e){return t[e]}).join(""))return!1;var l={};return"abcdefghijklmnopqrst".split("").forEach(function(e){l[e]=e}),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},l)).join("")}catch(e){return!1}}()?Object.assign:function(e,t){for(var n,l,a=De(e),o=1;o<arguments.length;o++){for(var r in n=Object(arguments[o]))Ae.call(n,r)&&(a[r]=n[r]);if(Ie){l=Ie(n);for(var i=0;i<l.length;i++)Pe.call(n,l[i])&&(a[l[i]]=n[l[i]])}}return a},be="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",Re=Function.call.bind(Object.prototype.hasOwnProperty),ke=function(){};if("production"!==process.env.NODE_ENV){var xe=be,we={},Fe=Re;ke=function(e){var t="Warning: "+e;"undefined"!=typeof console&&console.error(t);try{throw new Error(t)}catch(e){}}}function He(e,t,n,l,a){if("production"!==process.env.NODE_ENV)for(var o in e)if(Fe(e,o)){var r;try{if("function"!=typeof e[o]){var i=Error((l||"React class")+": "+n+" type `"+o+"` is invalid; it must be a function, usually from the `prop-types` package, but received `"+typeof e[o]+"`.This often happens because of typos such as `PropTypes.function` instead of `PropTypes.func`.");throw i.name="Invariant Violation",i}r=e[o](t,o,l,n,null,xe)}catch(e){r=e}if(!r||r instanceof Error||ke((l||"React class")+": type specification of "+n+" `"+o+"` is invalid; the type checker function must return `null` or an `Error` but returned a "+typeof r+". You may have forgotten to pass an argument to the type checker creator (arrayOf, instanceOf, objectOf, oneOf, oneOfType, and shape all require an argument)."),r instanceof Error&&!(r.message in we)){we[r.message]=!0;var s=a?a():"";ke("Failed "+n+" type: "+r.message+(null!=s?s:""))}}}He.resetWarningCache=function(){"production"!==process.env.NODE_ENV&&(we={})};var Ue=He,Be=function(){};function Ge(){return null}function je(){}function $e(){}"production"!==process.env.NODE_ENV&&(Be=function(e){var t="Warning: "+e;"undefined"!=typeof console&&console.error(t);try{throw new Error(t)}catch(e){}}),$e.resetWarningCache=je;var Ve=ne(function(e){e.exports="production"!==process.env.NODE_ENV?function(e,t){var n="function"==typeof Symbol&&Symbol.iterator,l={array:i("array"),bigint:i("bigint"),bool:i("boolean"),func:i("function"),number:i("number"),object:i("object"),string:i("string"),symbol:i("symbol"),any:r(Ge),arrayOf:function(e){return r(function(t,n,l,a,r){if("function"!=typeof e)return new o("Property `"+r+"` of component `"+l+"` has invalid PropType notation inside arrayOf.");var i=t[n];if(!Array.isArray(i))return new o("Invalid "+a+" `"+r+"` of type `"+u(i)+"` supplied to `"+l+"`, expected an array.");for(var s=0;s<i.length;s++){var c=e(i,s,l,a,r+"["+s+"]",be);if(c instanceof Error)return c}return null})},element:r(function(t,n,l,a,r){var i=t[n];return e(i)?null:new o("Invalid "+a+" `"+r+"` of type `"+u(i)+"` supplied to `"+l+"`, expected a single ReactElement.")}),elementType:r(function(e,t,n,l,a){var r=e[t];return Me.isValidElementType(r)?null:new o("Invalid "+l+" `"+a+"` of type `"+u(r)+"` supplied to `"+n+"`, expected a single ReactElement type.")}),instanceOf:function(e){return r(function(t,n,l,a,r){var i;return t[n]instanceof e?null:new o("Invalid "+a+" `"+r+"` of type `"+((i=t[n]).constructor&&i.constructor.name?i.constructor.name:"<<anonymous>>")+"` supplied to `"+l+"`, expected instance of `"+(e.name||"<<anonymous>>")+"`.")})},node:r(function(e,t,n,l,a){return c(e[t])?null:new o("Invalid "+l+" `"+a+"` supplied to `"+n+"`, expected a ReactNode.")}),objectOf:function(e){return r(function(t,n,l,a,r){if("function"!=typeof e)return new o("Property `"+r+"` of component `"+l+"` has invalid PropType notation inside objectOf.");var i=t[n],s=u(i);if("object"!==s)return new o("Invalid "+a+" `"+r+"` of type `"+s+"` supplied to `"+l+"`, expected an object.");for(var c in i)if(Re(i,c)){var m=e(i,c,l,a,r+"."+c,be);if(m instanceof Error)return m}return null})},oneOf:function(e){if(!Array.isArray(e))return"production"!==process.env.NODE_ENV&&Be(arguments.length>1?"Invalid arguments supplied to oneOf, expected an array, got "+arguments.length+" arguments. A common mistake is to write oneOf(x, y, z) instead of oneOf([x, y, z]).":"Invalid argument supplied to oneOf, expected an array."),Ge;function t(t,n,l,r,i){for(var s=t[n],c=0;c<e.length;c++)if(a(s,e[c]))return null;var u=JSON.stringify(e,function(e,t){return"symbol"===m(t)?String(t):t});return new o("Invalid "+r+" `"+i+"` of value `"+String(s)+"` supplied to `"+l+"`, expected one of "+u+".")}return r(t)},oneOfType:function(e){if(!Array.isArray(e))return"production"!==process.env.NODE_ENV&&Be("Invalid argument supplied to oneOfType, expected an instance of array."),Ge;for(var t=0;t<e.length;t++){var n=e[t];if("function"!=typeof n)return Be("Invalid argument supplied to oneOfType. Expected an array of check functions, but received "+d(n)+" at index "+t+"."),Ge}return r(function(t,n,l,a,r){for(var i=[],s=0;s<e.length;s++){var c=(0,e[s])(t,n,l,a,r,be);if(null==c)return null;c.data&&Re(c.data,"expectedType")&&i.push(c.data.expectedType)}return new o("Invalid "+a+" `"+r+"` supplied to `"+l+"`"+(i.length>0?", expected one of type ["+i.join(", ")+"]":"")+".")})},shape:function(e){return r(function(t,n,l,a,r){var i=t[n],c=u(i);if("object"!==c)return new o("Invalid "+a+" `"+r+"` of type `"+c+"` supplied to `"+l+"`, expected `object`.");for(var d in e){var p=e[d];if("function"!=typeof p)return s(l,a,r,d,m(p));var E=p(i,d,l,a,r+"."+d,be);if(E)return E}return null})},exact:function(e){return r(function(t,n,l,a,r){var i=t[n],c=u(i);if("object"!==c)return new o("Invalid "+a+" `"+r+"` of type `"+c+"` supplied to `"+l+"`, expected `object`.");var d=Le({},t[n],e);for(var p in d){var E=e[p];if(Re(e,p)&&"function"!=typeof E)return s(l,a,r,p,m(E));if(!E)return new o("Invalid "+a+" `"+r+"` key `"+p+"` supplied to `"+l+"`.\nBad object: "+JSON.stringify(t[n],null,"  ")+"\nValid keys: "+JSON.stringify(Object.keys(e),null,"  "));var C=E(i,p,l,a,r+"."+p,be);if(C)return C}return null})}};function a(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}function o(e,t){this.message=e,this.data=t&&"object"==typeof t?t:{},this.stack=""}function r(e){function t(t,n,l,a,r,i,s){if(a=a||"<<anonymous>>",i=i||l,s!==be){var c=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use `PropTypes.checkPropTypes()` to call them. Read more at http://fb.me/use-check-prop-types");throw c.name="Invariant Violation",c}return null==n[l]?t?new o(null===n[l]?"The "+r+" `"+i+"` is marked as required in `"+a+"`, but its value is `null`.":"The "+r+" `"+i+"` is marked as required in `"+a+"`, but its value is `undefined`."):null:e(n,l,a,r,i)}process;var n=t.bind(null,!1);return n.isRequired=t.bind(null,!0),n}function i(e){return r(function(t,n,l,a,r,i){var s=t[n];return u(s)!==e?new o("Invalid "+a+" `"+r+"` of type `"+m(s)+"` supplied to `"+l+"`, expected `"+e+"`.",{expectedType:e}):null})}function s(e,t,n,l,a){return new o((e||"React class")+": "+t+" type `"+n+"."+l+"` is invalid; it must be a function, usually from the `prop-types` package, but received `"+a+"`.")}function c(t){switch(typeof t){case"number":case"string":case"undefined":return!0;case"boolean":return!t;case"object":if(Array.isArray(t))return t.every(c);if(null===t||e(t))return!0;var l=function(e){var t=e&&(n&&e[n]||e["@@iterator"]);if("function"==typeof t)return t}(t);if(!l)return!1;var a,o=l.call(t);if(l!==t.entries){for(;!(a=o.next()).done;)if(!c(a.value))return!1}else for(;!(a=o.next()).done;){var r=a.value;if(r&&!c(r[1]))return!1}return!0;default:return!1}}function u(e){var t=typeof e;return Array.isArray(e)?"array":e instanceof RegExp?"object":function(e,t){return"symbol"===e||!!t&&("Symbol"===t["@@toStringTag"]||"function"==typeof Symbol&&t instanceof Symbol)}(t,e)?"symbol":t}function m(e){if(null==e)return""+e;var t=u(e);if("object"===t){if(e instanceof Date)return"date";if(e instanceof RegExp)return"regexp"}return t}function d(e){var t=m(e);switch(t){case"array":case"object":return"an "+t;case"boolean":case"date":case"regexp":return"a "+t;default:return t}}return o.prototype=Error.prototype,l.checkPropTypes=Ue,l.resetWarningCache=Ue.resetWarningCache,l.PropTypes=l,l}(Me.isElement):function(){function e(e,t,n,l,a,o){if(o!==be){var r=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw r.name="Invariant Violation",r}}function t(){return e}e.isRequired=e;var n={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:$e,resetWarningCache:je};return n.PropTypes=n,n}()});const We=e=>{let{data:t,onFilterChange:n,onSearch:a,isLoading:i,searchParams:s}=e;const{t:c}=o.useTranslation(),u=null==t?void 0:t.map(e=>{let{locality:t,tenantId:n,serviceRequestId:a,complaintSubType:o,sla:r,status:i,taskOwner:s}=e;return{[c("CS_COMMON_COMPLAINT_NO")]:a,[c("CS_ADDCOMPLAINT_COMPLAINT_SUB_TYPE")]:c("SERVICEDEFS."+o.toUpperCase()),[c("WF_INBOX_HEADER_LOCALITY")]:c(Digit.Utils.locale.getLocalityCode(t,n)),[c("CS_COMPLAINT_DETAILS_CURRENT_STATUS")]:c("CS_COMMON_"+i),[c("WF_INBOX_HEADER_CURRENT_OWNER")]:s,[c("WF_INBOX_HEADER_SLA_DAYS_REMAINING")]:(u=r,l.createElement("span",u<0?{className:"sla-cell-error"}:{className:"sla-cell-success"},u))};var u});let m;return m=i?l.createElement(r.Loader,null):l.createElement(te,{data:u,onFilterChange:n,serviceRequestIdKey:c("CS_COMMON_COMPLAINT_NO"),onSearch:a,searchParams:s}),l.createElement("div",{style:{padding:0}},l.createElement("div",{className:"inbox-container"},l.createElement("div",{className:"filters-container"},l.createElement(Y,{isMobile:!0}),m)))};We.propTypes={data:Ve.any,onFilterChange:Ve.func,onSearch:Ve.func,isLoading:Ve.bool,searchParams:Ve.any},We.defaultProps={onFilterChange:()=>{},searchParams:{}};const ze=e=>{let{action:t}=e;const{t:n}=o.useTranslation();return n("REOPEN"===t?"CS_COMMON_COMPLAINT_REOPENED":"CS_COMMON_COMPLAINT_SUBMITTED")},Ye=e=>{let{response:n}=e;const{complaints:a}=n;return l.createElement(r.Banner,a&&a.response&&a.response.responseInfo?{message:ze(a.response.ServiceWrappers[0].workflow),complaintNumber:a.response.ServiceWrappers[0].service.serviceRequestId,successful:!0}:{message:t("CS_COMMON_COMPLAINT_NOT_SUBMITTED"),successful:!1})},Ke={PGRModule:e=>{let{stateCode:t,userType:n,tenants:a}=e;const o=Digit.StoreData.getCurrentLanguage(),{isLoading:i}=Digit.Services.useStore({stateCode:t,moduleCode:"PGR",language:o});return i?l.createElement(r.Loader,null):(Digit.SessionStorage.set("PGR_TENANTS",a),l.createElement("citizen"===n?H:B,null))},PGRLinks:e=>{let{matchPath:t}=e;const{t:a}=o.useTranslation(),[i,s,c]=Digit.Hooks.useSessionStorage("PGR_CITIZEN_CREATE_COMPLAINT",{});n.useEffect(()=>{c()},[]);const u=[{link:t+"/create-complaint/complaint-type",i18nKey:a("CS_COMMON_FILE_A_COMPLAINT")},{link:t+"/complaints",i18nKey:a("CS_HOME_MY_COMPLAINTS")}];return l.createElement(r.CitizenHomeCard,{header:a("CS_COMMON_HOME_COMPLAINTS"),links:u,Icon:r.ComplaintIcon})},PGRCard:()=>{const{t:e}=o.useTranslation();if(e("ES_PGR_INBOX"),e("ES_PGR_NEW_COMPLAINT"),!Digit.Utils.pgrAccess())return null;const t=()=>l.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",height:"24",viewBox:"0 0 24 24",width:"24"},l.createElement("path",{d:"M0 0h24v24H0z",fill:"none"}),l.createElement("path",{d:"M20 2H4c-1.1 0-1.99.9-1.99 2L2 22l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm-7 9h-2V5h2v6zm0 4h-2v-2h2v2z",fill:"white"}));let n=[{label:e("ES_PGR_NEW_COMPLAINT"),link:"/digit-ui/employee/pgr/complaint/create",role:"CSR"}];n=n.filter(e=>e.role&&Digit.Utils.didEmployeeHasRole(e.role));const a={Icon:l.createElement(t,null),moduleName:e("ES_PGR_HEADER_COMPLAINT"),kpis:[{label:e("TOTAL_PGR"),link:"/digit-ui/employee/pgr/inbox"},{label:e("TOTAL_NEARING_SLA"),link:"/digit-ui/employee/pgr/inbox"}],links:[{label:e("ES_PGR_INBOX"),link:"/digit-ui/employee/pgr/inbox"},...n]};return l.createElement(r.EmployeeModuleCard,a)},PGRComplaintDetails:e=>{var t,i,s,c,u,d,p,E,C,S,_;let{id:O}=a.useParams();const{t:f}=o.useTranslation(),[T,v]=n.useState(!1),[g,N]=n.useState(null),[y,h]=n.useState(!1),M=Digit.ULBService.getCurrentTenantId(),{isLoading:I,complaintDetails:A,revalidate:P}=Digit.Hooks.pgr.useComplaintDetails({tenantId:M,id:O}),D=Digit.Hooks.useWorkflowDetails({tenantId:M,id:O,moduleCode:"PGR",role:"EMPLOYEE"}),[L,R]=n.useState([]);var k,x;D&&null!=D&&D.data&&(D.data.initialActionState=(null==D||null===(k=D.data)||void 0===k?void 0:k.initialActionState)||{...null==D||null===(x=D.data)||void 0===x?void 0:x.actionState}||{},D.data.actionState={...D.data}),n.useEffect(()=>{if(D){const{data:{timeline:e}={}}=D;if(e){const t=null==e?void 0:e.find(e=>"APPLY"===(null==e?void 0:e.performedAction)),{thumbnailsToShow:n}=t;n&&R(n)}}},[D]);const[w,F]=n.useState(!1),[H,U]=n.useState(!1),[B,G]=n.useState(null),[z,Y]=n.useState(null),[K,q]=n.useState(!1),[X,J]=n.useState(1),Z=m.useQueryClient();n.useEffect(()=>{try{return Promise.resolve(null===(_Digit=Digit)||void 0===_Digit||null===(_Digit$WorkflowServic=_Digit.WorkflowService)||void 0===_Digit$WorkflowServic?void 0:_Digit$WorkflowServic.getByBusinessId(M,O)).then(function(){})}catch(e){Promise.reject(e)}},[A]);const Q=function(){try{return Promise.resolve(Z.refetchQueries(["fetchInboxData"])).then(function(){return Promise.resolve(D.revalidate()).then(function(){return Promise.resolve(P()).then(function(){})})})}catch(e){return Promise.reject(e)}};function ee(e){switch(e){case T:v(!T);break;case H:U(!H)}}function te(e,t){N(e)}if(n.useEffect(()=>{!function(){try{const e=function(){if(A)return q(!0),Promise.resolve(Q()).then(function(){q(!1)})}();e&&e.then&&e.then(function(){})}catch(e){Promise.reject(e)}}()},[]),I||D.isLoading||K)return l.createElement(r.Loader,null);if(D.isError)return l.createElement(l.Fragment,null,D.error);const ne=(e,t,a)=>{var o,i,s,c;const{wfComment:u,thumbnailsToShow:m}=e;function d(e,t,n){var l,a;let o=null===(l=n.thumbs)||void 0===l?void 0:l.findIndex(t=>t===e);te(o>-1&&(null==n||null===(a=n.fullImage)||void 0===a?void 0:a[o])||e)}const p={date:null==e||null===(o=e.auditDetails)||void 0===o?void 0:o.lastModified,name:null==e||null===(i=e.assigner)||void 0===i?void 0:i.name,mobileNumber:null==e||null===(s=e.assigner)||void 0===s?void 0:s.mobileNumber,..."COMPLAINT_FILED"===e.status&&null!=A&&A.audit?{source:A.audit.source}:{}};if("PENDINGFORASSIGNMENT"===e.status&&null!=A&&A.audit){if(a.length-(t+1)==1){const t={date:Digit.DateUtils.ConvertTimestampToDate(A.audit.details.createdTime)};return l.createElement(V,{data:t,comments:null==e?void 0:e.wfComment})}{var E,C;const t={date:Digit.DateUtils.ConvertTimestampToDate(A.audit.details.createdTime)};return l.createElement(n.Fragment,null,null!=e&&e.wfComment?l.createElement("div",null,null==e||null===(E=e.wfComment)||void 0===E?void 0:E.map(e=>l.createElement("div",{className:"TLComments"},l.createElement("h3",null,f("WF_COMMON_COMMENTS")),l.createElement("p",null,e)))):null,"COMPLAINT_FILED"!==e.status&&(null==m||null===(C=m.thumbs)||void 0===C?void 0:C.length)>0?l.createElement("div",{className:"TLComments"},l.createElement("h3",null,f("CS_COMMON_ATTACHMENTS")),l.createElement(r.DisplayPhotos,{srcs:m.thumbs,onClick:(e,t)=>d(e,0,m)})):null,null!=t&&t.date?l.createElement(V,{data:t}):null)}}return l.createElement(n.Fragment,null,u?l.createElement("div",null,null==u?void 0:u.map(e=>l.createElement("div",{className:"TLComments"},l.createElement("h3",null,f("WF_COMMON_COMMENTS")),l.createElement("p",null,e)))):null,"COMPLAINT_FILED"!==e.status&&(null==m||null===(c=m.thumbs)||void 0===c?void 0:c.length)>0?l.createElement("div",{className:"TLComments"},l.createElement("h3",null,f("CS_COMMON_ATTACHMENTS")),l.createElement(r.DisplayPhotos,{srcs:m.thumbs,onClick:(e,t)=>d(e,0,m)})):null,null!=p&&p.date?l.createElement(V,{data:p}):null,"CLOSEDAFTERRESOLUTION"==e.status&&"RATE"==A.workflow.action&&t<=1&&A.audit.rating?l.createElement(b,{text:f("CS_ADDCOMPLAINT_YOU_RATED"),rating:A.audit.rating}):null)};return l.createElement(l.Fragment,null,l.createElement(r.Card,null,l.createElement(r.CardSubHeader,null,f("CS_HEADER_COMPLAINT_SUMMARY")),l.createElement(r.CardLabel,{style:{fontWeight:"700"}},f("CS_COMPLAINT_DETAILS_COMPLAINT_DETAILS")),I?l.createElement(r.Loader,null):l.createElement(r.StatusTable,null,A&&Object.keys(null==A?void 0:A.details).map((e,t,n)=>l.createElement(r.Row,{key:e,label:f(e),text:Array.isArray(null==A?void 0:A.details[e])?null==A?void 0:A.details[e].map(e=>f("object"==typeof e?null==e?void 0:e.code:e)):f(null==A?void 0:A.details[e])||"N/A",last:n.length-1===t})),null),null!=L&&L.thumbs?l.createElement(r.DisplayPhotos,{srcs:null==L?void 0:L.thumbs,onClick:(e,t)=>function(e,t){te(null==L?void 0:L.fullImage[t])}(0,t)}):null,l.createElement(r.BreakLine,null),(null==D?void 0:D.isLoading)&&l.createElement(r.Loader,null),!(null!=D&&D.isLoading)&&l.createElement(l.Fragment,null,l.createElement(r.CardSubHeader,null,f("CS_COMPLAINT_DETAILS_COMPLAINT_TIMELINE")),null!=D&&null!==(t=D.data)&&void 0!==t&&t.timeline&&1===(null==D||null===(i=D.data)||void 0===i||null===(s=i.timeline)||void 0===s?void 0:s.length)?l.createElement(r.CheckPoint,{isCompleted:!0,label:f("CS_COMMON_"+(null==D||null===(c=D.data)||void 0===c||null===(u=c.timeline[0])||void 0===u?void 0:u.status))}):l.createElement(r.ConnectingCheckPoints,null,(null==D||null===(d=D.data)||void 0===d?void 0:d.timeline)&&(null==D||null===(p=D.data)||void 0===p?void 0:p.timeline.map((e,t,n)=>l.createElement(l.Fragment,{key:t},l.createElement(r.CheckPoint,{keyValue:t,isCompleted:0===t,label:f("CS_COMMON_"+e.status),customChild:ne(e,t,n)}))))))),T?l.createElement(r.PopUp,null,l.createElement("div",{className:"popup-module"},l.createElement(r.HeaderBar,{main:l.createElement(j,{label:"Complaint Geolocation"}),end:l.createElement($,{onClick:()=>ee(T)})}),l.createElement("div",{className:"popup-module-main"},l.createElement("img",{src:"https://via.placeholder.com/912x568"})))):null,g?l.createElement(r.ImageViewer,{imageSrc:g,onClose:function(){N(null)}}):null,H?l.createElement(W,{workflowDetails:D,complaintDetails:A,close:ee,popup:H,selectedAction:B,onAssign:function(e,t,n){try{return U(!1),Promise.resolve(Digit.Complaint.assign(A,B,e,t,n,M)).then(function(e){return Y(e),h(!0),q(!0),Promise.resolve(Q()).then(function(){q(!1),J(X+1),setTimeout(()=>h(!1),1e4)})})}catch(e){return Promise.reject(e)}},tenantId:M,t:f}):null,y&&l.createElement(r.Toast,{label:f(z?"CS_ACTION_"+B+"_TEXT":"CS_ACTION_ASSIGN_FAILED"),onClose:function(){h(!1)}}),!(null!=D&&D.isLoading)&&(null==D||null===(E=D.data)||void 0===E||null===(C=E.nextActions)||void 0===C?void 0:C.length)>0&&l.createElement(r.ActionBar,null,w&&null!=D&&null!==(S=D.data)&&void 0!==S&&S.nextActions?l.createElement(r.Menu,{options:null==D||null===(_=D.data)||void 0===_?void 0:_.nextActions.map(e=>e.action),t:f,onSelect:function(e){switch(G(e),e){case"ASSIGN":case"REASSIGN":case"RESOLVE":case"REJECT":case"REOPEN":U(!0),F(!1);break;default:F(!1)}}}):null,l.createElement(r.SubmitBar,{label:f("WF_TAKE_ACTION"),onSubmit:()=>F(!w)})))},PGRCreateComplaintEmp:e=>{var t;let{parentUrl:i}=e;const c=Digit.Hooks.pgr.useTenants(),{t:u}=o.useTranslation(),d=()=>(null==c?void 0:c.filter(e=>e.code===Digit.ULBService.getCurrentTenantId()))||[],[p,E]=n.useState({}),[C,_]=n.useState([]),[O,f]=n.useState({}),[T,v]=n.useState(""),[g,N]=n.useState(d()[0]?d()[0]:null),{data:y}=Digit.Hooks.useBoundaryLocalities(null===(t=d()[0])||void 0===t?void 0:t.code,"admin",{enabled:!!d()[0]},u),[h,M]=n.useState(y),[I,A]=n.useState(null),[P,D]=n.useState(!1),[L,b]=n.useState(!1),[R,k]=n.useState(!1),[x,w]=n.useState({}),F=window.Digit.SessionStorage.get("Employee.tenantId"),H=Digit.Hooks.pgr.useComplaintTypes({stateCode:F}),U=s.useDispatch(),B=(a.useRouteMatch(),a.useHistory()),G=Digit.GetServiceDefinitions,j=m.useQueryClient();n.useEffect(()=>{D(!!(null!=p&&p.key&&null!=O&&O.key&&null!=g&&g.code&&null!=I&&I.code))},[p,O,g,I]),n.useEffect(()=>{M(y)},[y]),n.useEffect(()=>{var e;const t=c.find(e=>{var t;return null===(t=e.pincode)||void 0===t?void 0:t.find(e=>e==T)});if((null==t?void 0:t.code)===(null===(e=d()[0])||void 0===e?void 0:e.code)){k(!1),N(t),A(null);const e=y.filter(e=>e.pincode==T);M(e)}else""===T||null===T?(k(!1),M(y)):k(!0)},[T]);const $=[{head:u("ES_CREATECOMPLAINT_PROVIDE_COMPLAINANT_DETAILS"),body:[{label:u("ES_CREATECOMPLAINT_MOBILE_NUMBER"),isMandatory:!0,type:"text",populators:{name:"mobileNumber",validation:{required:!0,pattern:/^[6-9]\d{9}$/},componentInFront:l.createElement("div",{className:"employee-card-input employee-card-input--front"},"+91"),error:u("CORE_COMMON_MOBILE_ERROR")}},{label:u("ES_CREATECOMPLAINT_COMPLAINT_NAME"),isMandatory:!0,type:"text",populators:{name:"name",validation:{required:!0,pattern:/^[A-Za-z]/},error:u("CS_ADDCOMPLAINT_NAME_ERROR")}}]},{head:u("CS_COMPLAINT_DETAILS_COMPLAINT_DETAILS"),body:[{label:u("CS_COMPLAINT_DETAILS_COMPLAINT_TYPE"),isMandatory:!0,type:"dropdown",populators:l.createElement(r.Dropdown,{option:H,optionKey:"name",id:"complaintType",selected:p,select:function(e){try{const t=function(){if(e.key!==p.key){const t=function(){if("Others"!==e.key)return f({name:""}),E(e),Promise.resolve(G.getSubMenu(F,e,u)).then(function(e){_(e)});f({name:""}),E(e),_([{key:"Others",name:u("SERVICEDEFS.OTHERS")}])}();if(t&&t.then)return t.then(function(){})}}();return Promise.resolve(t&&t.then?t.then(function(){}):void 0)}catch(e){return Promise.reject(e)}}})},{label:u("CS_COMPLAINT_DETAILS_COMPLAINT_SUBTYPE"),isMandatory:!0,type:"dropdown",menu:{...C},populators:l.createElement(r.Dropdown,{option:C,optionKey:"name",id:"complaintSubType",selected:O,select:function(e){f(e)}})}]},{head:u("CS_ADDCOMPLAINT_LOCATION"),body:[{label:u("CORE_COMMON_PINCODE"),type:"text",populators:{name:"pincode",validation:{pattern:/^[1-9][0-9]{5}$/,validate:()=>!R},error:u("CORE_COMMON_PINCODE_INVALID"),onChange:e=>{const{value:t}=e.target;v(t),t||k(!1)}}},{label:u("CS_COMPLAINT_DETAILS_CITY"),isMandatory:!0,type:"dropdown",populators:l.createElement(r.Dropdown,{isMandatory:!0,selected:g,freeze:!0,option:d(),id:"city",select:function(e){return Promise.resolve()},optionKey:"i18nKey",t:u})},{label:u("CS_CREATECOMPLAINT_MOHALLA"),type:"dropdown",isMandatory:!0,dependency:!(!g||!h),populators:l.createElement(r.Dropdown,{isMandatory:!0,selected:I,optionKey:"i18nkey",id:"locality",option:h,select:function(e){A(e)},t:u})},{label:u("CS_COMPLAINT_DETAILS_LANDMARK"),type:"textarea",populators:{name:"landmark"}}]},{head:u("CS_COMPLAINT_DETAILS_ADDITIONAL_DETAILS"),body:[{label:u("CS_COMPLAINT_DETAILS_ADDITIONAL_DETAILS"),type:"textarea",populators:{name:"description"}}]}];return l.createElement(z,{heading:u("ES_CREATECOMPLAINT_NEW_COMPLAINT"),config:$,onSubmit:e=>{P&&(b(!0),!L&&function(e){try{if(!P)return Promise.resolve();const t=g.code,n=g.city.name,l=g.city.name,a=g.city.name,o=I.code,r=I.name,s=e.landmark,{key:c}=O,u=c,m=e.mobileNumber,d=e.name,p={...e,cityCode:t,city:n,district:l,region:a,localityCode:o,localityName:r,landmark:s,complaintType:u,mobileNumber:m,name:d};Promise.resolve(U(S(p))).then(function(){return Promise.resolve(j.refetchQueries(["fetchInboxData"])).then(function(){B.push(i+"/response")})})}catch(e){return Promise.reject(e)}}(e))},isDisabled:!P&&!L,label:u("CS_ADDCOMPLAINT_ADDITIONAL_DETAILS_SUBMIT_COMPLAINT")})},PGRInbox:()=>{const{t:e}=o.useTranslation(),t=Digit.ULBService.getCurrentTenantId(),{uuid:a}=Digit.UserService.getUser().info,[i,s]=n.useState(0),[c,u]=n.useState(10),[m,d]=n.useState(0),[p,E]=n.useState({filters:{wfFilters:{assignee:[{code:a}]}},search:"",sort:{}});n.useEffect(()=>{try{const e=null==p||null===(_searchParams$filters=p.filters)||void 0===_searchParams$filters||null===(_searchParams$filters2=_searchParams$filters.pgrfilters)||void 0===_searchParams$filters2||null===(_searchParams$filters3=_searchParams$filters2.applicationStatus)||void 0===_searchParams$filters3?void 0:_searchParams$filters3.map(e=>e.code).join(",");return Promise.resolve(Digit.PGRService.count(t,(null==e?void 0:e.length)>0?{applicationStatus:e}:{})).then(function(e){null!=e&&e.count&&d(e.count)})}catch(e){Promise.reject(e)}},[p]);const C=e=>{E({...p,filters:e})},S=function(e){void 0===e&&(e=""),E({...p,search:e})};let{data:_,isLoading:O}=Digit.Hooks.pgr.useInboxData({...p,offset:i,limit:c}),f=Digit.Utils.browser.isMobile();return null!==(null==_?void 0:_.length)?f?l.createElement(We,{data:_,isLoading:O,onFilterChange:C,onSearch:S,searchParams:p}):l.createElement("div",null,l.createElement(r.Header,null,e("ES_COMMON_INBOX")),l.createElement(ee,{data:_,isLoading:O,onFilterChange:C,onSearch:S,searchParams:p,onNextPage:()=>{s(e=>e+10)},onPrevPage:()=>{s(e=>e-10)},onPageSizeChange:e=>{u(Number(e.target.value))},currentPage:Math.floor(i/c),totalRecords:m,pageSizeLimit:c})):l.createElement(r.Loader,null)},PGRResponseEmp:e=>{const{t:t}=o.useTranslation(),n=(a.useRouteMatch(),s.useSelector(e=>e).pgr);return l.createElement(r.Card,null,n.complaints.response&&l.createElement(Ye,{response:n}),l.createElement(r.CardText,null,t("ES_COMMON_TRACK_COMPLAINT_TEXT")),l.createElement(a.Link,{to:"/digit-ui/employee"},l.createElement(r.SubmitBar,{label:t("CORE_COMMON_GO_TO_HOME")})))},PGRCreateComplaintCitizen:()=>{const e=Digit.Contexts.ComponentProvider,{t:t}=o.useTranslation(),{pathname:r}=a.useLocation(),i=a.useRouteMatch(),u=a.useHistory(),d=(n.useContext(e),s.useDispatch()),{data:p,isLoading:E}=Digit.Hooks.useStore.getInitData(),{stateInfo:C}=p||{},[_,O,f]=Digit.Hooks.useSessionStorage("PGR_CITIZEN_CREATE_COMPLAINT",{}),T=n.useMemo(()=>c(A,Digit.Customizations.PGR.complaintConfig),[Digit.Customizations.PGR.complaintConfig]),[v,g]=n.useState(_),[N,y]=n.useState(""),[h,I]=n.useState(!1),[P,D]=n.useState(0),L=m.useQueryClient();n.useEffect(()=>{I(!1)},[]),n.useEffect(()=>{g(_),null===N?R():u.push(i.path+"/"+N)},[_,N]);const b=()=>{const e=r.split("/").pop();let{nextStep:n}=T.routes[e],l=Digit.SessionStorage.get("PGR_CITIZEN_CREATE_COMPLAINT");"sub-type"===n&&"Others"===l.complaintType.key&&(O({..._,complaintType:{key:"Others",name:t("SERVICEDEFS.OTHERS")},subType:{key:"Others",name:t("SERVICEDEFS.OTHERS")}}),n=T.routes[n].nextStep),y(n)},R=()=>{h||(I(!0),k())},k=function(){try{const e=function(){if(null!=v&&v.complaintType){const{city_complaint:e,locality_complaint:t,uploadedImages:n,subType:l,details:a,...o}=v,{code:r,name:s}=e,{code:c,name:m}=t,p=null==n?void 0:n.map(e=>({documentType:"PHOTO",fileStoreId:e,documentUid:"",additionalDetails:{}})),E={...o,complaintType:l.key,cityCode:r,city:s,description:a,district:s,region:s,localityCode:c,localityName:m,state:C.name,uploadedImages:p};return Promise.resolve(d(S(E))).then(function(){return Promise.resolve(L.refetchQueries(["complaintsList"])).then(function(){u.push(i.path+"/response")})})}}();return Promise.resolve(e&&e.then?e.then(function(){}):void 0)}catch(e){return Promise.reject(e)}},x=e=>{O({..._,...e}),b()},w=()=>{b()};return E?null:l.createElement(a.Switch,null,Object.keys(T.routes).map((e,n)=>{const{component:o,texts:r,inputs:s}=T.routes[e],c="string"==typeof o?Digit.ComponentRegistryService.getComponent(o):o;return l.createElement(a.Route,{path:i.path+"/"+e,key:n},l.createElement(c,{config:{texts:r,inputs:s},onSelect:x,onSkip:w,value:_,t:t}))}),l.createElement(a.Route,{path:i.path+"/response"},l.createElement(M,{match:i})),l.createElement(a.Route,null,l.createElement(a.Redirect,{to:i.path+"/"+T.indexRoute})))},PGRComplaintsList:e=>{var t,i,s,c;const u=Digit.UserService.getUser(),m=u.mobileNumber||(null==u||null===(t=u.info)||void 0===t?void 0:t.mobileNumber)||(null==u||null===(i=u.info)||void 0===i||null===(s=i.userInfo)||void 0===s?void 0:s.mobileNumber),d=(null===(c=Digit.SessionStorage.get("CITIZEN.COMMON.HOME.CITY"))||void 0===c?void 0:c.code)||Digit.ULBService.getCurrentTenantId(),{t:p}=o.useTranslation(),{path:E}=a.useRouteMatch();let{isLoading:C,error:S,data:_,revalidate:O}=Digit.Hooks.pgr.useComplaintsListByMobile(d,m);if(n.useEffect(()=>{O()},[]),C)return l.createElement(l.Fragment,null,l.createElement(r.Header,null,p("CS_HOME_MY_COMPLAINTS")),l.createElement(r.Loader,null));let f,T=null==_?void 0:_.ServiceWrappers;return f=S?l.createElement(r.Card,null,p("CS_COMMON_ERROR_LOADING_RESULTS").split("\\n").map((e,t)=>l.createElement("p",{key:t,style:{textAlign:"center"}},e))):0===T.length?l.createElement(r.Card,null,p("CS_MYCOMPLAINTS_NO_COMPLAINTS").split("\\n").map((e,t)=>l.createElement("p",{key:t,style:{textAlign:"center"}},e))):T.map((e,t)=>{let{service:n}=e;return l.createElement(P,{key:t,data:n,path:E})}),l.createElement(l.Fragment,null,l.createElement("div",{className:"applications-list-container"},l.createElement(r.Header,null,p("CS_HOME_MY_COMPLAINTS")),f))},PGRComplaintDetailsPage:e=>{var t;let{t:i}=o.useTranslation(),{id:s}=a.useParams(),c=(null===(t=Digit.SessionStorage.get("CITIZEN.COMMON.HOME.CITY"))||void 0===t?void 0:t.code)||Digit.ULBService.getCurrentTenantId();const{isLoading:u,isError:m,complaintDetails:d,revalidate:p}=Digit.Hooks.pgr.useComplaintDetails({tenantId:c,id:s}),[E,C]=n.useState({}),[S,_]=n.useState(null),[O,f]=n.useState(""),[T,v]=n.useState(!1),[g,N]=n.useState(null),[y,h]=n.useState(!0),[M,I]=n.useState(!1);function A(e,t){_(e)}return n.useEffect(()=>{!function(){try{const e=function(){if(d)return I(!0),Promise.resolve(p()).then(function(){I(!1)})}();e&&e.then&&e.then(function(){})}catch(e){Promise.reject(e)}}()},[]),u||M?l.createElement(r.Loader,null):m?l.createElement("h2",null,"Error"):l.createElement(l.Fragment,null,l.createElement("div",{className:"complaint-summary"},l.createElement(r.Header,null,i("CS_HEADER_COMPLAINT_SUMMARY")),Object.keys(d).length>0?l.createElement(l.Fragment,null,l.createElement(r.Card,null,l.createElement(r.CardSubHeader,null,i("SERVICEDEFS."+d.audit.serviceCode.toUpperCase())),l.createElement(r.StatusTable,null,Object.keys(d.details).map((e,t,n)=>l.createElement(r.Row,{key:t,label:i(e),text:Array.isArray(d.details[e])?d.details[e].map(e=>i("object"==typeof e?null==e?void 0:e.code:e)):i(d.details[e])||"N/A",last:t===n.length-1}))),null!=E&&E.thumbs?l.createElement(r.DisplayPhotos,{srcs:null==E?void 0:E.thumbs,onClick:(e,t)=>function(e,t){A(null==E?void 0:E.fullImage[t])}(0,t)}):null,S?l.createElement(r.ImageViewer,{imageSrc:S,onClose:function(){_(null)}}):null),l.createElement(r.Card,null,(null==d?void 0:d.service)&&l.createElement(F,{getWorkFlow:e=>{var t;let n=null==e?void 0:e.timeline;if(n&&null!==(t=n[0].timeLineActions)&&void 0!==t&&t.filter(e=>"COMMENT"===e).length?h(!1):h(!0),n){const e=n.find(e=>"APPLY"===(null==e?void 0:e.performedAction)),{thumbnailsToShow:t}=e;C(t)}},complaintDetails:d,id:s,zoomImage:A})),T&&l.createElement(r.Toast,{error:g,label:i(g?"CS_COMPLAINT_COMMENT_ERROR":"CS_COMPLAINT_COMMENT_SUCCESS"),onClose:()=>v(!1)})," "):l.createElement(r.Loader,null)))},PGRSelectRating:e=>{var t;let{parentRoute:i}=e;const{t:c}=o.useTranslation(),{id:u}=a.useParams(),m=s.useDispatch(),d=a.useHistory();let p=(null===(t=Digit.SessionStorage.get("CITIZEN.COMMON.HOME.CITY"))||void 0===t?void 0:t.code)||Digit.ULBService.getCurrentTenantId();const E=Digit.Hooks.pgr.useComplaintDetails({tenantId:p,id:u}).complaintDetails,C=n.useCallback(e=>m(_(e)),[m]),[S,O]=n.useState(!1),f={texts:{header:"CS_COMPLAINT_RATE_HELP_TEXT",submitBarLabel:"CS_COMMONS_NEXT"},inputs:[{type:"rate",maxRating:5,label:c("CS_COMPLAINT_RATE_TEXT"),error:S?l.createElement(r.CardLabelError,null,c("CS_FEEDBACK_ENTER_RATING_ERROR")):null},{type:"checkbox",label:"CS_FEEDBACK_WHAT_WAS_GOOD",checkLabels:[c("CS_FEEDBACK_SERVICES"),c("CS_FEEDBACK_RESOLUTION_TIME"),c("CS_FEEDBACK_QUALITY_OF_WORK"),c("CS_FEEDBACK_OTHERS")]},{type:"textarea",label:c("CS_COMMON_COMMENTS"),name:"comments"}]};return l.createElement(r.RatingCard,{config:f,t:c,onSelect:function(e){E&&e.rating>0?(E.service.rating=e.rating,E.service.additionalDetail=e.CS_FEEDBACK_WHAT_WAS_GOOD.join(","),E.workflow={action:"RATE",comments:e.comments,verificationDocuments:[]},C({service:E.service,workflow:E.workflow}),d.push(i+"/response")):O(!0)}})},PGRResponseCitzen:g};exports.PGRReducers=()=>i.combineReducers({complaints:d}),exports.initPGRComponents=()=>{Object.entries(Ke).forEach(e=>{let[t,n]=e;Digit.ComponentRegistryService.setComponent(t,n)})};
